var oa=r=>{throw TypeError(r)};var qs=(r,e,t)=>e.has(r)||oa("Cannot "+t);var m=(r,e,t)=>(qs(r,e,"read from private field"),t?t.call(r):e.get(r)),O=(r,e,t)=>e.has(r)?oa("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(r):e.set(r,t),E=(r,e,t,a)=>(qs(r,e,"write to private field"),a?a.call(r,t):e.set(r,t),t),M=(r,e,t)=>(qs(r,e,"access private method"),t);var fs=(r,e,t,a)=>({set _(i){E(r,e,i,t)},get _(){return m(r,e,a)}});import{j as s,S as Wn,P as Kt,T as mi,I as Gn,a as gi,b as fi,c as Kn,C as pi,V as Vn,L as xi,d as yi,e as Hn,f as Qn,g as bi,R as Jn,h as Yn,i as Zn,k as Xn,l as eo,m as to,n as vi,u as so,o as ro,p as ao,q as io,r as no}from"./ui-BIkWkz57.js";import{a as oo,r as b,g as lo,d as pe}from"./vendor-BgNOLPkv.js";import{c as wi,t as co,f as we,a as ji,i as rr,b as ar,d as la,s as uo,e as ho,g as mo}from"./utils-J9WKoK_r.js";(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))a(i);new MutationObserver(i=>{for(const n of i)if(n.type==="childList")for(const o of n.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&a(o)}).observe(document,{childList:!0,subtree:!0});function t(i){const n={};return i.integrity&&(n.integrity=i.integrity),i.referrerPolicy&&(n.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?n.credentials="include":i.crossOrigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function a(i){if(i.ep)return;i.ep=!0;const n=t(i);fetch(i.href,n)}})();var _i,ca=oo;_i=ca.createRoot,ca.hydrateRoot;var Vt=class{constructor(){this.listeners=new Set,this.subscribe=this.subscribe.bind(this)}subscribe(r){return this.listeners.add(r),this.onSubscribe(),()=>{this.listeners.delete(r),this.onUnsubscribe()}}hasListeners(){return this.listeners.size>0}onSubscribe(){}onUnsubscribe(){}},mt=typeof window>"u"||"Deno"in globalThis;function fe(){}function go(r,e){return typeof r=="function"?r(e):r}function ir(r){return typeof r=="number"&&r>=0&&r!==1/0}function Ni(r,e){return Math.max(r+(e||0)-Date.now(),0)}function Ct(r,e){return typeof r=="function"?r(e):r}function ve(r,e){return typeof r=="function"?r(e):r}function da(r,e){const{type:t="all",exact:a,fetchStatus:i,predicate:n,queryKey:o,stale:l}=r;if(o){if(a){if(e.queryHash!==Lr(o,e.options))return!1}else if(!is(e.queryKey,o))return!1}if(t!=="all"){const c=e.isActive();if(t==="active"&&!c||t==="inactive"&&c)return!1}return!(typeof l=="boolean"&&e.isStale()!==l||i&&i!==e.state.fetchStatus||n&&!n(e))}function ua(r,e){const{exact:t,status:a,predicate:i,mutationKey:n}=r;if(n){if(!e.options.mutationKey)return!1;if(t){if(gt(e.options.mutationKey)!==gt(n))return!1}else if(!is(e.options.mutationKey,n))return!1}return!(a&&e.state.status!==a||i&&!i(e))}function Lr(r,e){return((e==null?void 0:e.queryKeyHashFn)||gt)(r)}function gt(r){return JSON.stringify(r,(e,t)=>nr(t)?Object.keys(t).sort().reduce((a,i)=>(a[i]=t[i],a),{}):t)}function is(r,e){return r===e?!0:typeof r!=typeof e?!1:r&&e&&typeof r=="object"&&typeof e=="object"?!Object.keys(e).some(t=>!is(r[t],e[t])):!1}function ki(r,e){if(r===e)return r;const t=ha(r)&&ha(e);if(t||nr(r)&&nr(e)){const a=t?r:Object.keys(r),i=a.length,n=t?e:Object.keys(e),o=n.length,l=t?[]:{};let c=0;for(let d=0;d<o;d++){const u=t?d:n[d];(!t&&a.includes(u)||t)&&r[u]===void 0&&e[u]===void 0?(l[u]=void 0,c++):(l[u]=ki(r[u],e[u]),l[u]===r[u]&&r[u]!==void 0&&c++)}return i===o&&c===i?r:l}return e}function Ns(r,e){if(!e||Object.keys(r).length!==Object.keys(e).length)return!1;for(const t in r)if(r[t]!==e[t])return!1;return!0}function ha(r){return Array.isArray(r)&&r.length===Object.keys(r).length}function nr(r){if(!ma(r))return!1;const e=r.constructor;if(e===void 0)return!0;const t=e.prototype;return!(!ma(t)||!t.hasOwnProperty("isPrototypeOf")||Object.getPrototypeOf(r)!==Object.prototype)}function ma(r){return Object.prototype.toString.call(r)==="[object Object]"}function fo(r){return new Promise(e=>{setTimeout(e,r)})}function or(r,e,t){return typeof t.structuralSharing=="function"?t.structuralSharing(r,e):t.structuralSharing!==!1?ki(r,e):e}function po(r,e,t=0){const a=[...r,e];return t&&a.length>t?a.slice(1):a}function xo(r,e,t=0){const a=[e,...r];return t&&a.length>t?a.slice(0,-1):a}var Dr=Symbol();function Si(r,e){return!r.queryFn&&(e!=null&&e.initialPromise)?()=>e.initialPromise:!r.queryFn||r.queryFn===Dr?()=>Promise.reject(new Error(`Missing queryFn: '${r.queryHash}'`)):r.queryFn}var it,qe,Tt,ri,yo=(ri=class extends Vt{constructor(){super();O(this,it);O(this,qe);O(this,Tt);E(this,Tt,e=>{if(!mt&&window.addEventListener){const t=()=>e();return window.addEventListener("visibilitychange",t,!1),()=>{window.removeEventListener("visibilitychange",t)}}})}onSubscribe(){m(this,qe)||this.setEventListener(m(this,Tt))}onUnsubscribe(){var e;this.hasListeners()||((e=m(this,qe))==null||e.call(this),E(this,qe,void 0))}setEventListener(e){var t;E(this,Tt,e),(t=m(this,qe))==null||t.call(this),E(this,qe,e(a=>{typeof a=="boolean"?this.setFocused(a):this.onFocus()}))}setFocused(e){m(this,it)!==e&&(E(this,it,e),this.onFocus())}onFocus(){const e=this.isFocused();this.listeners.forEach(t=>{t(e)})}isFocused(){var e;return typeof m(this,it)=="boolean"?m(this,it):((e=globalThis.document)==null?void 0:e.visibilityState)!=="hidden"}},it=new WeakMap,qe=new WeakMap,Tt=new WeakMap,ri),Ur=new yo,Pt,We,It,ai,bo=(ai=class extends Vt{constructor(){super();O(this,Pt,!0);O(this,We);O(this,It);E(this,It,e=>{if(!mt&&window.addEventListener){const t=()=>e(!0),a=()=>e(!1);return window.addEventListener("online",t,!1),window.addEventListener("offline",a,!1),()=>{window.removeEventListener("online",t),window.removeEventListener("offline",a)}}})}onSubscribe(){m(this,We)||this.setEventListener(m(this,It))}onUnsubscribe(){var e;this.hasListeners()||((e=m(this,We))==null||e.call(this),E(this,We,void 0))}setEventListener(e){var t;E(this,It,e),(t=m(this,We))==null||t.call(this),E(this,We,e(this.setOnline.bind(this)))}setOnline(e){m(this,Pt)!==e&&(E(this,Pt,e),this.listeners.forEach(a=>{a(e)}))}isOnline(){return m(this,Pt)}},Pt=new WeakMap,We=new WeakMap,It=new WeakMap,ai),ks=new bo;function lr(){let r,e;const t=new Promise((i,n)=>{r=i,e=n});t.status="pending",t.catch(()=>{});function a(i){Object.assign(t,i),delete t.resolve,delete t.reject}return t.resolve=i=>{a({status:"fulfilled",value:i}),r(i)},t.reject=i=>{a({status:"rejected",reason:i}),e(i)},t}function vo(r){return Math.min(1e3*2**r,3e4)}function Ci(r){return(r??"online")==="online"?ks.isOnline():!0}var Ei=class extends Error{constructor(r){super("CancelledError"),this.revert=r==null?void 0:r.revert,this.silent=r==null?void 0:r.silent}};function Ws(r){return r instanceof Ei}function Ti(r){let e=!1,t=0,a=!1,i;const n=lr(),o=y=>{var p;a||(g(new Ei(y)),(p=r.abort)==null||p.call(r))},l=()=>{e=!0},c=()=>{e=!1},d=()=>Ur.isFocused()&&(r.networkMode==="always"||ks.isOnline())&&r.canRun(),u=()=>Ci(r.networkMode)&&r.canRun(),h=y=>{var p;a||(a=!0,(p=r.onSuccess)==null||p.call(r,y),i==null||i(),n.resolve(y))},g=y=>{var p;a||(a=!0,(p=r.onError)==null||p.call(r,y),i==null||i(),n.reject(y))},f=()=>new Promise(y=>{var p;i=w=>{(a||d())&&y(w)},(p=r.onPause)==null||p.call(r)}).then(()=>{var y;i=void 0,a||(y=r.onContinue)==null||y.call(r)}),x=()=>{if(a)return;let y;const p=t===0?r.initialPromise:void 0;try{y=p??r.fn()}catch(w){y=Promise.reject(w)}Promise.resolve(y).then(h).catch(w=>{var _;if(a)return;const T=r.retry??(mt?0:3),v=r.retryDelay??vo,C=typeof v=="function"?v(t,w):v,N=T===!0||typeof T=="number"&&t<T||typeof T=="function"&&T(t,w);if(e||!N){g(w);return}t++,(_=r.onFail)==null||_.call(r,t,w),fo(C).then(()=>d()?void 0:f()).then(()=>{e?g(w):x()})})};return{promise:n,cancel:o,continue:()=>(i==null||i(),n),cancelRetry:l,continueRetry:c,canStart:u,start:()=>(u()?x():f().then(x),n)}}function wo(){let r=[],e=0,t=l=>{l()},a=l=>{l()},i=l=>setTimeout(l,0);const n=l=>{e?r.push(l):i(()=>{t(l)})},o=()=>{const l=r;r=[],l.length&&i(()=>{a(()=>{l.forEach(c=>{t(c)})})})};return{batch:l=>{let c;e++;try{c=l()}finally{e--,e||o()}return c},batchCalls:l=>(...c)=>{n(()=>{l(...c)})},schedule:n,setNotifyFunction:l=>{t=l},setBatchNotifyFunction:l=>{a=l},setScheduler:l=>{i=l}}}var Q=wo(),nt,ii,Pi=(ii=class{constructor(){O(this,nt)}destroy(){this.clearGcTimeout()}scheduleGc(){this.clearGcTimeout(),ir(this.gcTime)&&E(this,nt,setTimeout(()=>{this.optionalRemove()},this.gcTime))}updateGcTime(r){this.gcTime=Math.max(this.gcTime||0,r??(mt?1/0:5*60*1e3))}clearGcTimeout(){m(this,nt)&&(clearTimeout(m(this,nt)),E(this,nt,void 0))}},nt=new WeakMap,ii),At,Ot,ge,X,ls,ot,ye,Ie,ni,jo=(ni=class extends Pi{constructor(e){super();O(this,ye);O(this,At);O(this,Ot);O(this,ge);O(this,X);O(this,ls);O(this,ot);E(this,ot,!1),E(this,ls,e.defaultOptions),this.setOptions(e.options),this.observers=[],E(this,ge,e.cache),this.queryKey=e.queryKey,this.queryHash=e.queryHash,E(this,At,_o(this.options)),this.state=e.state??m(this,At),this.scheduleGc()}get meta(){return this.options.meta}get promise(){var e;return(e=m(this,X))==null?void 0:e.promise}setOptions(e){this.options={...m(this,ls),...e},this.updateGcTime(this.options.gcTime)}optionalRemove(){!this.observers.length&&this.state.fetchStatus==="idle"&&m(this,ge).remove(this)}setData(e,t){const a=or(this.state.data,e,this.options);return M(this,ye,Ie).call(this,{data:a,type:"success",dataUpdatedAt:t==null?void 0:t.updatedAt,manual:t==null?void 0:t.manual}),a}setState(e,t){M(this,ye,Ie).call(this,{type:"setState",state:e,setStateOptions:t})}cancel(e){var a,i;const t=(a=m(this,X))==null?void 0:a.promise;return(i=m(this,X))==null||i.cancel(e),t?t.then(fe).catch(fe):Promise.resolve()}destroy(){super.destroy(),this.cancel({silent:!0})}reset(){this.destroy(),this.setState(m(this,At))}isActive(){return this.observers.some(e=>ve(e.options.enabled,this)!==!1)}isDisabled(){return this.getObserversCount()>0?!this.isActive():this.options.queryFn===Dr||this.state.dataUpdateCount+this.state.errorUpdateCount===0}isStale(){return this.state.isInvalidated?!0:this.getObserversCount()>0?this.observers.some(e=>e.getCurrentResult().isStale):this.state.data===void 0}isStaleByTime(e=0){return this.state.isInvalidated||this.state.data===void 0||!Ni(this.state.dataUpdatedAt,e)}onFocus(){var t;const e=this.observers.find(a=>a.shouldFetchOnWindowFocus());e==null||e.refetch({cancelRefetch:!1}),(t=m(this,X))==null||t.continue()}onOnline(){var t;const e=this.observers.find(a=>a.shouldFetchOnReconnect());e==null||e.refetch({cancelRefetch:!1}),(t=m(this,X))==null||t.continue()}addObserver(e){this.observers.includes(e)||(this.observers.push(e),this.clearGcTimeout(),m(this,ge).notify({type:"observerAdded",query:this,observer:e}))}removeObserver(e){this.observers.includes(e)&&(this.observers=this.observers.filter(t=>t!==e),this.observers.length||(m(this,X)&&(m(this,ot)?m(this,X).cancel({revert:!0}):m(this,X).cancelRetry()),this.scheduleGc()),m(this,ge).notify({type:"observerRemoved",query:this,observer:e}))}getObserversCount(){return this.observers.length}invalidate(){this.state.isInvalidated||M(this,ye,Ie).call(this,{type:"invalidate"})}fetch(e,t){var c,d,u;if(this.state.fetchStatus!=="idle"){if(this.state.data!==void 0&&(t!=null&&t.cancelRefetch))this.cancel({silent:!0});else if(m(this,X))return m(this,X).continueRetry(),m(this,X).promise}if(e&&this.setOptions(e),!this.options.queryFn){const h=this.observers.find(g=>g.options.queryFn);h&&this.setOptions(h.options)}const a=new AbortController,i=h=>{Object.defineProperty(h,"signal",{enumerable:!0,get:()=>(E(this,ot,!0),a.signal)})},n=()=>{const h=Si(this.options,t),g={queryKey:this.queryKey,meta:this.meta};return i(g),E(this,ot,!1),this.options.persister?this.options.persister(h,g,this):h(g)},o={fetchOptions:t,options:this.options,queryKey:this.queryKey,state:this.state,fetchFn:n};i(o),(c=this.options.behavior)==null||c.onFetch(o,this),E(this,Ot,this.state),(this.state.fetchStatus==="idle"||this.state.fetchMeta!==((d=o.fetchOptions)==null?void 0:d.meta))&&M(this,ye,Ie).call(this,{type:"fetch",meta:(u=o.fetchOptions)==null?void 0:u.meta});const l=h=>{var g,f,x,y;Ws(h)&&h.silent||M(this,ye,Ie).call(this,{type:"error",error:h}),Ws(h)||((f=(g=m(this,ge).config).onError)==null||f.call(g,h,this),(y=(x=m(this,ge).config).onSettled)==null||y.call(x,this.state.data,h,this)),this.scheduleGc()};return E(this,X,Ti({initialPromise:t==null?void 0:t.initialPromise,fn:o.fetchFn,abort:a.abort.bind(a),onSuccess:h=>{var g,f,x,y;if(h===void 0){l(new Error(`${this.queryHash} data is undefined`));return}try{this.setData(h)}catch(p){l(p);return}(f=(g=m(this,ge).config).onSuccess)==null||f.call(g,h,this),(y=(x=m(this,ge).config).onSettled)==null||y.call(x,h,this.state.error,this),this.scheduleGc()},onError:l,onFail:(h,g)=>{M(this,ye,Ie).call(this,{type:"failed",failureCount:h,error:g})},onPause:()=>{M(this,ye,Ie).call(this,{type:"pause"})},onContinue:()=>{M(this,ye,Ie).call(this,{type:"continue"})},retry:o.options.retry,retryDelay:o.options.retryDelay,networkMode:o.options.networkMode,canRun:()=>!0})),m(this,X).start()}},At=new WeakMap,Ot=new WeakMap,ge=new WeakMap,X=new WeakMap,ls=new WeakMap,ot=new WeakMap,ye=new WeakSet,Ie=function(e){const t=a=>{switch(e.type){case"failed":return{...a,fetchFailureCount:e.failureCount,fetchFailureReason:e.error};case"pause":return{...a,fetchStatus:"paused"};case"continue":return{...a,fetchStatus:"fetching"};case"fetch":return{...a,...Ii(a.data,this.options),fetchMeta:e.meta??null};case"success":return{...a,data:e.data,dataUpdateCount:a.dataUpdateCount+1,dataUpdatedAt:e.dataUpdatedAt??Date.now(),error:null,isInvalidated:!1,status:"success",...!e.manual&&{fetchStatus:"idle",fetchFailureCount:0,fetchFailureReason:null}};case"error":const i=e.error;return Ws(i)&&i.revert&&m(this,Ot)?{...m(this,Ot),fetchStatus:"idle"}:{...a,error:i,errorUpdateCount:a.errorUpdateCount+1,errorUpdatedAt:Date.now(),fetchFailureCount:a.fetchFailureCount+1,fetchFailureReason:i,fetchStatus:"idle",status:"error"};case"invalidate":return{...a,isInvalidated:!0};case"setState":return{...a,...e.state}}};this.state=t(this.state),Q.batch(()=>{this.observers.forEach(a=>{a.onQueryUpdate()}),m(this,ge).notify({query:this,type:"updated",action:e})})},ni);function Ii(r,e){return{fetchFailureCount:0,fetchFailureReason:null,fetchStatus:Ci(e.networkMode)?"fetching":"paused",...r===void 0&&{error:null,status:"pending"}}}function _o(r){const e=typeof r.initialData=="function"?r.initialData():r.initialData,t=e!==void 0,a=t?typeof r.initialDataUpdatedAt=="function"?r.initialDataUpdatedAt():r.initialDataUpdatedAt:0;return{data:e,dataUpdateCount:0,dataUpdatedAt:t?a??Date.now():0,error:null,errorUpdateCount:0,errorUpdatedAt:0,fetchFailureCount:0,fetchFailureReason:null,fetchMeta:null,isInvalidated:!1,status:t?"success":"pending",fetchStatus:"idle"}}var ke,oi,No=(oi=class extends Vt{constructor(e={}){super();O(this,ke);this.config=e,E(this,ke,new Map)}build(e,t,a){const i=t.queryKey,n=t.queryHash??Lr(i,t);let o=this.get(n);return o||(o=new jo({cache:this,queryKey:i,queryHash:n,options:e.defaultQueryOptions(t),state:a,defaultOptions:e.getQueryDefaults(i)}),this.add(o)),o}add(e){m(this,ke).has(e.queryHash)||(m(this,ke).set(e.queryHash,e),this.notify({type:"added",query:e}))}remove(e){const t=m(this,ke).get(e.queryHash);t&&(e.destroy(),t===e&&m(this,ke).delete(e.queryHash),this.notify({type:"removed",query:e}))}clear(){Q.batch(()=>{this.getAll().forEach(e=>{this.remove(e)})})}get(e){return m(this,ke).get(e)}getAll(){return[...m(this,ke).values()]}find(e){const t={exact:!0,...e};return this.getAll().find(a=>da(t,a))}findAll(e={}){const t=this.getAll();return Object.keys(e).length>0?t.filter(a=>da(e,a)):t}notify(e){Q.batch(()=>{this.listeners.forEach(t=>{t(e)})})}onFocus(){Q.batch(()=>{this.getAll().forEach(e=>{e.onFocus()})})}onOnline(){Q.batch(()=>{this.getAll().forEach(e=>{e.onOnline()})})}},ke=new WeakMap,oi),Se,se,lt,Ce,Ue,li,ko=(li=class extends Pi{constructor(e){super();O(this,Ce);O(this,Se);O(this,se);O(this,lt);this.mutationId=e.mutationId,E(this,se,e.mutationCache),E(this,Se,[]),this.state=e.state||Ai(),this.setOptions(e.options),this.scheduleGc()}setOptions(e){this.options=e,this.updateGcTime(this.options.gcTime)}get meta(){return this.options.meta}addObserver(e){m(this,Se).includes(e)||(m(this,Se).push(e),this.clearGcTimeout(),m(this,se).notify({type:"observerAdded",mutation:this,observer:e}))}removeObserver(e){E(this,Se,m(this,Se).filter(t=>t!==e)),this.scheduleGc(),m(this,se).notify({type:"observerRemoved",mutation:this,observer:e})}optionalRemove(){m(this,Se).length||(this.state.status==="pending"?this.scheduleGc():m(this,se).remove(this))}continue(){var e;return((e=m(this,lt))==null?void 0:e.continue())??this.execute(this.state.variables)}async execute(e){var i,n,o,l,c,d,u,h,g,f,x,y,p,w,T,v,C,N,_,k;E(this,lt,Ti({fn:()=>this.options.mutationFn?this.options.mutationFn(e):Promise.reject(new Error("No mutationFn found")),onFail:(S,L)=>{M(this,Ce,Ue).call(this,{type:"failed",failureCount:S,error:L})},onPause:()=>{M(this,Ce,Ue).call(this,{type:"pause"})},onContinue:()=>{M(this,Ce,Ue).call(this,{type:"continue"})},retry:this.options.retry??0,retryDelay:this.options.retryDelay,networkMode:this.options.networkMode,canRun:()=>m(this,se).canRun(this)}));const t=this.state.status==="pending",a=!m(this,lt).canStart();try{if(!t){M(this,Ce,Ue).call(this,{type:"pending",variables:e,isPaused:a}),await((n=(i=m(this,se).config).onMutate)==null?void 0:n.call(i,e,this));const L=await((l=(o=this.options).onMutate)==null?void 0:l.call(o,e));L!==this.state.context&&M(this,Ce,Ue).call(this,{type:"pending",context:L,variables:e,isPaused:a})}const S=await m(this,lt).start();return await((d=(c=m(this,se).config).onSuccess)==null?void 0:d.call(c,S,e,this.state.context,this)),await((h=(u=this.options).onSuccess)==null?void 0:h.call(u,S,e,this.state.context)),await((f=(g=m(this,se).config).onSettled)==null?void 0:f.call(g,S,null,this.state.variables,this.state.context,this)),await((y=(x=this.options).onSettled)==null?void 0:y.call(x,S,null,e,this.state.context)),M(this,Ce,Ue).call(this,{type:"success",data:S}),S}catch(S){try{throw await((w=(p=m(this,se).config).onError)==null?void 0:w.call(p,S,e,this.state.context,this)),await((v=(T=this.options).onError)==null?void 0:v.call(T,S,e,this.state.context)),await((N=(C=m(this,se).config).onSettled)==null?void 0:N.call(C,void 0,S,this.state.variables,this.state.context,this)),await((k=(_=this.options).onSettled)==null?void 0:k.call(_,void 0,S,e,this.state.context)),S}finally{M(this,Ce,Ue).call(this,{type:"error",error:S})}}finally{m(this,se).runNext(this)}}},Se=new WeakMap,se=new WeakMap,lt=new WeakMap,Ce=new WeakSet,Ue=function(e){const t=a=>{switch(e.type){case"failed":return{...a,failureCount:e.failureCount,failureReason:e.error};case"pause":return{...a,isPaused:!0};case"continue":return{...a,isPaused:!1};case"pending":return{...a,context:e.context,data:void 0,failureCount:0,failureReason:null,error:null,isPaused:e.isPaused,status:"pending",variables:e.variables,submittedAt:Date.now()};case"success":return{...a,data:e.data,failureCount:0,failureReason:null,error:null,status:"success",isPaused:!1};case"error":return{...a,data:void 0,error:e.error,failureCount:a.failureCount+1,failureReason:e.error,isPaused:!1,status:"error"}}};this.state=t(this.state),Q.batch(()=>{m(this,Se).forEach(a=>{a.onMutationUpdate(e)}),m(this,se).notify({mutation:this,type:"updated",action:e})})},li);function Ai(){return{context:void 0,data:void 0,error:null,failureCount:0,failureReason:null,isPaused:!1,status:"idle",variables:void 0,submittedAt:0}}var de,cs,ci,So=(ci=class extends Vt{constructor(e={}){super();O(this,de);O(this,cs);this.config=e,E(this,de,new Map),E(this,cs,Date.now())}build(e,t,a){const i=new ko({mutationCache:this,mutationId:++fs(this,cs)._,options:e.defaultMutationOptions(t),state:a});return this.add(i),i}add(e){const t=ps(e),a=m(this,de).get(t)??[];a.push(e),m(this,de).set(t,a),this.notify({type:"added",mutation:e})}remove(e){var a;const t=ps(e);if(m(this,de).has(t)){const i=(a=m(this,de).get(t))==null?void 0:a.filter(n=>n!==e);i&&(i.length===0?m(this,de).delete(t):m(this,de).set(t,i))}this.notify({type:"removed",mutation:e})}canRun(e){var a;const t=(a=m(this,de).get(ps(e)))==null?void 0:a.find(i=>i.state.status==="pending");return!t||t===e}runNext(e){var a;const t=(a=m(this,de).get(ps(e)))==null?void 0:a.find(i=>i!==e&&i.state.isPaused);return(t==null?void 0:t.continue())??Promise.resolve()}clear(){Q.batch(()=>{this.getAll().forEach(e=>{this.remove(e)})})}getAll(){return[...m(this,de).values()].flat()}find(e){const t={exact:!0,...e};return this.getAll().find(a=>ua(t,a))}findAll(e={}){return this.getAll().filter(t=>ua(e,t))}notify(e){Q.batch(()=>{this.listeners.forEach(t=>{t(e)})})}resumePausedMutations(){const e=this.getAll().filter(t=>t.state.isPaused);return Q.batch(()=>Promise.all(e.map(t=>t.continue().catch(fe))))}},de=new WeakMap,cs=new WeakMap,ci);function ps(r){var e;return((e=r.options.scope)==null?void 0:e.id)??String(r.mutationId)}function ga(r){return{onFetch:(e,t)=>{var u,h,g,f,x;const a=e.options,i=(g=(h=(u=e.fetchOptions)==null?void 0:u.meta)==null?void 0:h.fetchMore)==null?void 0:g.direction,n=((f=e.state.data)==null?void 0:f.pages)||[],o=((x=e.state.data)==null?void 0:x.pageParams)||[];let l={pages:[],pageParams:[]},c=0;const d=async()=>{let y=!1;const p=v=>{Object.defineProperty(v,"signal",{enumerable:!0,get:()=>(e.signal.aborted?y=!0:e.signal.addEventListener("abort",()=>{y=!0}),e.signal)})},w=Si(e.options,e.fetchOptions),T=async(v,C,N)=>{if(y)return Promise.reject();if(C==null&&v.pages.length)return Promise.resolve(v);const _={queryKey:e.queryKey,pageParam:C,direction:N?"backward":"forward",meta:e.options.meta};p(_);const k=await w(_),{maxPages:S}=e.options,L=N?xo:po;return{pages:L(v.pages,k,S),pageParams:L(v.pageParams,C,S)}};if(i&&n.length){const v=i==="backward",C=v?Co:fa,N={pages:n,pageParams:o},_=C(a,N);l=await T(N,_,v)}else{const v=r??n.length;do{const C=c===0?o[0]??a.initialPageParam:fa(a,l);if(c>0&&C==null)break;l=await T(l,C),c++}while(c<v)}return l};e.options.persister?e.fetchFn=()=>{var y,p;return(p=(y=e.options).persister)==null?void 0:p.call(y,d,{queryKey:e.queryKey,meta:e.options.meta,signal:e.signal},t)}:e.fetchFn=d}}}function fa(r,{pages:e,pageParams:t}){const a=e.length-1;return e.length>0?r.getNextPageParam(e[a],e,t[a],t):void 0}function Co(r,{pages:e,pageParams:t}){var a;return e.length>0?(a=r.getPreviousPageParam)==null?void 0:a.call(r,e[0],e,t[0],t):void 0}var K,Ge,Ke,Rt,Mt,Ve,$t,Lt,di,Eo=(di=class{constructor(r={}){O(this,K);O(this,Ge);O(this,Ke);O(this,Rt);O(this,Mt);O(this,Ve);O(this,$t);O(this,Lt);E(this,K,r.queryCache||new No),E(this,Ge,r.mutationCache||new So),E(this,Ke,r.defaultOptions||{}),E(this,Rt,new Map),E(this,Mt,new Map),E(this,Ve,0)}mount(){fs(this,Ve)._++,m(this,Ve)===1&&(E(this,$t,Ur.subscribe(async r=>{r&&(await this.resumePausedMutations(),m(this,K).onFocus())})),E(this,Lt,ks.subscribe(async r=>{r&&(await this.resumePausedMutations(),m(this,K).onOnline())})))}unmount(){var r,e;fs(this,Ve)._--,m(this,Ve)===0&&((r=m(this,$t))==null||r.call(this),E(this,$t,void 0),(e=m(this,Lt))==null||e.call(this),E(this,Lt,void 0))}isFetching(r){return m(this,K).findAll({...r,fetchStatus:"fetching"}).length}isMutating(r){return m(this,Ge).findAll({...r,status:"pending"}).length}getQueryData(r){var t;const e=this.defaultQueryOptions({queryKey:r});return(t=m(this,K).get(e.queryHash))==null?void 0:t.state.data}ensureQueryData(r){const e=this.getQueryData(r.queryKey);if(e===void 0)return this.fetchQuery(r);{const t=this.defaultQueryOptions(r),a=m(this,K).build(this,t);return r.revalidateIfStale&&a.isStaleByTime(Ct(t.staleTime,a))&&this.prefetchQuery(t),Promise.resolve(e)}}getQueriesData(r){return m(this,K).findAll(r).map(({queryKey:e,state:t})=>{const a=t.data;return[e,a]})}setQueryData(r,e,t){const a=this.defaultQueryOptions({queryKey:r}),i=m(this,K).get(a.queryHash),n=i==null?void 0:i.state.data,o=go(e,n);if(o!==void 0)return m(this,K).build(this,a).setData(o,{...t,manual:!0})}setQueriesData(r,e,t){return Q.batch(()=>m(this,K).findAll(r).map(({queryKey:a})=>[a,this.setQueryData(a,e,t)]))}getQueryState(r){var t;const e=this.defaultQueryOptions({queryKey:r});return(t=m(this,K).get(e.queryHash))==null?void 0:t.state}removeQueries(r){const e=m(this,K);Q.batch(()=>{e.findAll(r).forEach(t=>{e.remove(t)})})}resetQueries(r,e){const t=m(this,K),a={type:"active",...r};return Q.batch(()=>(t.findAll(r).forEach(i=>{i.reset()}),this.refetchQueries(a,e)))}cancelQueries(r={},e={}){const t={revert:!0,...e},a=Q.batch(()=>m(this,K).findAll(r).map(i=>i.cancel(t)));return Promise.all(a).then(fe).catch(fe)}invalidateQueries(r={},e={}){return Q.batch(()=>{if(m(this,K).findAll(r).forEach(a=>{a.invalidate()}),r.refetchType==="none")return Promise.resolve();const t={...r,type:r.refetchType??r.type??"active"};return this.refetchQueries(t,e)})}refetchQueries(r={},e){const t={...e,cancelRefetch:(e==null?void 0:e.cancelRefetch)??!0},a=Q.batch(()=>m(this,K).findAll(r).filter(i=>!i.isDisabled()).map(i=>{let n=i.fetch(void 0,t);return t.throwOnError||(n=n.catch(fe)),i.state.fetchStatus==="paused"?Promise.resolve():n}));return Promise.all(a).then(fe)}fetchQuery(r){const e=this.defaultQueryOptions(r);e.retry===void 0&&(e.retry=!1);const t=m(this,K).build(this,e);return t.isStaleByTime(Ct(e.staleTime,t))?t.fetch(e):Promise.resolve(t.state.data)}prefetchQuery(r){return this.fetchQuery(r).then(fe).catch(fe)}fetchInfiniteQuery(r){return r.behavior=ga(r.pages),this.fetchQuery(r)}prefetchInfiniteQuery(r){return this.fetchInfiniteQuery(r).then(fe).catch(fe)}ensureInfiniteQueryData(r){return r.behavior=ga(r.pages),this.ensureQueryData(r)}resumePausedMutations(){return ks.isOnline()?m(this,Ge).resumePausedMutations():Promise.resolve()}getQueryCache(){return m(this,K)}getMutationCache(){return m(this,Ge)}getDefaultOptions(){return m(this,Ke)}setDefaultOptions(r){E(this,Ke,r)}setQueryDefaults(r,e){m(this,Rt).set(gt(r),{queryKey:r,defaultOptions:e})}getQueryDefaults(r){const e=[...m(this,Rt).values()];let t={};return e.forEach(a=>{is(r,a.queryKey)&&(t={...t,...a.defaultOptions})}),t}setMutationDefaults(r,e){m(this,Mt).set(gt(r),{mutationKey:r,defaultOptions:e})}getMutationDefaults(r){const e=[...m(this,Mt).values()];let t={};return e.forEach(a=>{is(r,a.mutationKey)&&(t={...t,...a.defaultOptions})}),t}defaultQueryOptions(r){if(r._defaulted)return r;const e={...m(this,Ke).queries,...this.getQueryDefaults(r.queryKey),...r,_defaulted:!0};return e.queryHash||(e.queryHash=Lr(e.queryKey,e)),e.refetchOnReconnect===void 0&&(e.refetchOnReconnect=e.networkMode!=="always"),e.throwOnError===void 0&&(e.throwOnError=!!e.suspense),!e.networkMode&&e.persister&&(e.networkMode="offlineFirst"),e.enabled!==!0&&e.queryFn===Dr&&(e.enabled=!1),e}defaultMutationOptions(r){return r!=null&&r._defaulted?r:{...m(this,Ke).mutations,...(r==null?void 0:r.mutationKey)&&this.getMutationDefaults(r.mutationKey),...r,_defaulted:!0}}clear(){m(this,K).clear(),m(this,Ge).clear()}},K=new WeakMap,Ge=new WeakMap,Ke=new WeakMap,Rt=new WeakMap,Mt=new WeakMap,Ve=new WeakMap,$t=new WeakMap,Lt=new WeakMap,di),ie,D,ds,re,ct,Dt,He,Ee,us,Ut,Ft,dt,ut,Qe,zt,z,Zt,cr,dr,ur,hr,mr,gr,fr,Oi,ui,To=(ui=class extends Vt{constructor(e,t){super();O(this,z);O(this,ie);O(this,D);O(this,ds);O(this,re);O(this,ct);O(this,Dt);O(this,He);O(this,Ee);O(this,us);O(this,Ut);O(this,Ft);O(this,dt);O(this,ut);O(this,Qe);O(this,zt,new Set);this.options=t,E(this,ie,e),E(this,Ee,null),E(this,He,lr()),this.options.experimental_prefetchInRender||m(this,He).reject(new Error("experimental_prefetchInRender feature flag is not enabled")),this.bindMethods(),this.setOptions(t)}bindMethods(){this.refetch=this.refetch.bind(this)}onSubscribe(){this.listeners.size===1&&(m(this,D).addObserver(this),pa(m(this,D),this.options)?M(this,z,Zt).call(this):this.updateResult(),M(this,z,hr).call(this))}onUnsubscribe(){this.hasListeners()||this.destroy()}shouldFetchOnReconnect(){return pr(m(this,D),this.options,this.options.refetchOnReconnect)}shouldFetchOnWindowFocus(){return pr(m(this,D),this.options,this.options.refetchOnWindowFocus)}destroy(){this.listeners=new Set,M(this,z,mr).call(this),M(this,z,gr).call(this),m(this,D).removeObserver(this)}setOptions(e,t){const a=this.options,i=m(this,D);if(this.options=m(this,ie).defaultQueryOptions(e),this.options.enabled!==void 0&&typeof this.options.enabled!="boolean"&&typeof this.options.enabled!="function"&&typeof ve(this.options.enabled,m(this,D))!="boolean")throw new Error("Expected enabled to be a boolean or a callback that returns a boolean");M(this,z,fr).call(this),m(this,D).setOptions(this.options),a._defaulted&&!Ns(this.options,a)&&m(this,ie).getQueryCache().notify({type:"observerOptionsUpdated",query:m(this,D),observer:this});const n=this.hasListeners();n&&xa(m(this,D),i,this.options,a)&&M(this,z,Zt).call(this),this.updateResult(t),n&&(m(this,D)!==i||ve(this.options.enabled,m(this,D))!==ve(a.enabled,m(this,D))||Ct(this.options.staleTime,m(this,D))!==Ct(a.staleTime,m(this,D)))&&M(this,z,cr).call(this);const o=M(this,z,dr).call(this);n&&(m(this,D)!==i||ve(this.options.enabled,m(this,D))!==ve(a.enabled,m(this,D))||o!==m(this,Qe))&&M(this,z,ur).call(this,o)}getOptimisticResult(e){const t=m(this,ie).getQueryCache().build(m(this,ie),e),a=this.createResult(t,e);return Io(this,a)&&(E(this,re,a),E(this,Dt,this.options),E(this,ct,m(this,D).state)),a}getCurrentResult(){return m(this,re)}trackResult(e,t){const a={};return Object.keys(e).forEach(i=>{Object.defineProperty(a,i,{configurable:!1,enumerable:!0,get:()=>(this.trackProp(i),t==null||t(i),e[i])})}),a}trackProp(e){m(this,zt).add(e)}getCurrentQuery(){return m(this,D)}refetch({...e}={}){return this.fetch({...e})}fetchOptimistic(e){const t=m(this,ie).defaultQueryOptions(e),a=m(this,ie).getQueryCache().build(m(this,ie),t);return a.fetch().then(()=>this.createResult(a,t))}fetch(e){return M(this,z,Zt).call(this,{...e,cancelRefetch:e.cancelRefetch??!0}).then(()=>(this.updateResult(),m(this,re)))}createResult(e,t){var S;const a=m(this,D),i=this.options,n=m(this,re),o=m(this,ct),l=m(this,Dt),d=e!==a?e.state:m(this,ds),{state:u}=e;let h={...u},g=!1,f;if(t._optimisticResults){const L=this.hasListeners(),P=!L&&pa(e,t),q=L&&xa(e,a,t,i);(P||q)&&(h={...h,...Ii(u.data,e.options)}),t._optimisticResults==="isRestoring"&&(h.fetchStatus="idle")}let{error:x,errorUpdatedAt:y,status:p}=h;if(t.select&&h.data!==void 0)if(n&&h.data===(o==null?void 0:o.data)&&t.select===m(this,us))f=m(this,Ut);else try{E(this,us,t.select),f=t.select(h.data),f=or(n==null?void 0:n.data,f,t),E(this,Ut,f),E(this,Ee,null)}catch(L){E(this,Ee,L)}else f=h.data;if(t.placeholderData!==void 0&&f===void 0&&p==="pending"){let L;if(n!=null&&n.isPlaceholderData&&t.placeholderData===(l==null?void 0:l.placeholderData))L=n.data;else if(L=typeof t.placeholderData=="function"?t.placeholderData((S=m(this,Ft))==null?void 0:S.state.data,m(this,Ft)):t.placeholderData,t.select&&L!==void 0)try{L=t.select(L),E(this,Ee,null)}catch(P){E(this,Ee,P)}L!==void 0&&(p="success",f=or(n==null?void 0:n.data,L,t),g=!0)}m(this,Ee)&&(x=m(this,Ee),f=m(this,Ut),y=Date.now(),p="error");const w=h.fetchStatus==="fetching",T=p==="pending",v=p==="error",C=T&&w,N=f!==void 0,k={status:p,fetchStatus:h.fetchStatus,isPending:T,isSuccess:p==="success",isError:v,isInitialLoading:C,isLoading:C,data:f,dataUpdatedAt:h.dataUpdatedAt,error:x,errorUpdatedAt:y,failureCount:h.fetchFailureCount,failureReason:h.fetchFailureReason,errorUpdateCount:h.errorUpdateCount,isFetched:h.dataUpdateCount>0||h.errorUpdateCount>0,isFetchedAfterMount:h.dataUpdateCount>d.dataUpdateCount||h.errorUpdateCount>d.errorUpdateCount,isFetching:w,isRefetching:w&&!T,isLoadingError:v&&!N,isPaused:h.fetchStatus==="paused",isPlaceholderData:g,isRefetchError:v&&N,isStale:Fr(e,t),refetch:this.refetch,promise:m(this,He)};if(this.options.experimental_prefetchInRender){const L=ce=>{k.status==="error"?ce.reject(k.error):k.data!==void 0&&ce.resolve(k.data)},P=()=>{const ce=E(this,He,k.promise=lr());L(ce)},q=m(this,He);switch(q.status){case"pending":e.queryHash===a.queryHash&&L(q);break;case"fulfilled":(k.status==="error"||k.data!==q.value)&&P();break;case"rejected":(k.status!=="error"||k.error!==q.reason)&&P();break}}return k}updateResult(e){const t=m(this,re),a=this.createResult(m(this,D),this.options);if(E(this,ct,m(this,D).state),E(this,Dt,this.options),m(this,ct).data!==void 0&&E(this,Ft,m(this,D)),Ns(a,t))return;E(this,re,a);const i={},n=()=>{if(!t)return!0;const{notifyOnChangeProps:o}=this.options,l=typeof o=="function"?o():o;if(l==="all"||!l&&!m(this,zt).size)return!0;const c=new Set(l??m(this,zt));return this.options.throwOnError&&c.add("error"),Object.keys(m(this,re)).some(d=>{const u=d;return m(this,re)[u]!==t[u]&&c.has(u)})};(e==null?void 0:e.listeners)!==!1&&n()&&(i.listeners=!0),M(this,z,Oi).call(this,{...i,...e})}onQueryUpdate(){this.updateResult(),this.hasListeners()&&M(this,z,hr).call(this)}},ie=new WeakMap,D=new WeakMap,ds=new WeakMap,re=new WeakMap,ct=new WeakMap,Dt=new WeakMap,He=new WeakMap,Ee=new WeakMap,us=new WeakMap,Ut=new WeakMap,Ft=new WeakMap,dt=new WeakMap,ut=new WeakMap,Qe=new WeakMap,zt=new WeakMap,z=new WeakSet,Zt=function(e){M(this,z,fr).call(this);let t=m(this,D).fetch(this.options,e);return e!=null&&e.throwOnError||(t=t.catch(fe)),t},cr=function(){M(this,z,mr).call(this);const e=Ct(this.options.staleTime,m(this,D));if(mt||m(this,re).isStale||!ir(e))return;const a=Ni(m(this,re).dataUpdatedAt,e)+1;E(this,dt,setTimeout(()=>{m(this,re).isStale||this.updateResult()},a))},dr=function(){return(typeof this.options.refetchInterval=="function"?this.options.refetchInterval(m(this,D)):this.options.refetchInterval)??!1},ur=function(e){M(this,z,gr).call(this),E(this,Qe,e),!(mt||ve(this.options.enabled,m(this,D))===!1||!ir(m(this,Qe))||m(this,Qe)===0)&&E(this,ut,setInterval(()=>{(this.options.refetchIntervalInBackground||Ur.isFocused())&&M(this,z,Zt).call(this)},m(this,Qe)))},hr=function(){M(this,z,cr).call(this),M(this,z,ur).call(this,M(this,z,dr).call(this))},mr=function(){m(this,dt)&&(clearTimeout(m(this,dt)),E(this,dt,void 0))},gr=function(){m(this,ut)&&(clearInterval(m(this,ut)),E(this,ut,void 0))},fr=function(){const e=m(this,ie).getQueryCache().build(m(this,ie),this.options);if(e===m(this,D))return;const t=m(this,D);E(this,D,e),E(this,ds,e.state),this.hasListeners()&&(t==null||t.removeObserver(this),e.addObserver(this))},Oi=function(e){Q.batch(()=>{e.listeners&&this.listeners.forEach(t=>{t(m(this,re))}),m(this,ie).getQueryCache().notify({query:m(this,D),type:"observerResultsUpdated"})})},ui);function Po(r,e){return ve(e.enabled,r)!==!1&&r.state.data===void 0&&!(r.state.status==="error"&&e.retryOnMount===!1)}function pa(r,e){return Po(r,e)||r.state.data!==void 0&&pr(r,e,e.refetchOnMount)}function pr(r,e,t){if(ve(e.enabled,r)!==!1){const a=typeof t=="function"?t(r):t;return a==="always"||a!==!1&&Fr(r,e)}return!1}function xa(r,e,t,a){return(r!==e||ve(a.enabled,r)===!1)&&(!t.suspense||r.state.status!=="error")&&Fr(r,t)}function Fr(r,e){return ve(e.enabled,r)!==!1&&r.isStaleByTime(Ct(e.staleTime,r))}function Io(r,e){return!Ns(r.getCurrentResult(),e)}var Je,Ye,ne,$e,Le,_s,xr,hi,Ao=(hi=class extends Vt{constructor(t,a){super();O(this,Le);O(this,Je);O(this,Ye);O(this,ne);O(this,$e);E(this,Je,t),this.setOptions(a),this.bindMethods(),M(this,Le,_s).call(this)}bindMethods(){this.mutate=this.mutate.bind(this),this.reset=this.reset.bind(this)}setOptions(t){var i;const a=this.options;this.options=m(this,Je).defaultMutationOptions(t),Ns(this.options,a)||m(this,Je).getMutationCache().notify({type:"observerOptionsUpdated",mutation:m(this,ne),observer:this}),a!=null&&a.mutationKey&&this.options.mutationKey&&gt(a.mutationKey)!==gt(this.options.mutationKey)?this.reset():((i=m(this,ne))==null?void 0:i.state.status)==="pending"&&m(this,ne).setOptions(this.options)}onUnsubscribe(){var t;this.hasListeners()||(t=m(this,ne))==null||t.removeObserver(this)}onMutationUpdate(t){M(this,Le,_s).call(this),M(this,Le,xr).call(this,t)}getCurrentResult(){return m(this,Ye)}reset(){var t;(t=m(this,ne))==null||t.removeObserver(this),E(this,ne,void 0),M(this,Le,_s).call(this),M(this,Le,xr).call(this)}mutate(t,a){var i;return E(this,$e,a),(i=m(this,ne))==null||i.removeObserver(this),E(this,ne,m(this,Je).getMutationCache().build(m(this,Je),this.options)),m(this,ne).addObserver(this),m(this,ne).execute(t)}},Je=new WeakMap,Ye=new WeakMap,ne=new WeakMap,$e=new WeakMap,Le=new WeakSet,_s=function(){var a;const t=((a=m(this,ne))==null?void 0:a.state)??Ai();E(this,Ye,{...t,isPending:t.status==="pending",isSuccess:t.status==="success",isError:t.status==="error",isIdle:t.status==="idle",mutate:this.mutate,reset:this.reset})},xr=function(t){Q.batch(()=>{var a,i,n,o,l,c,d,u;if(m(this,$e)&&this.hasListeners()){const h=m(this,Ye).variables,g=m(this,Ye).context;(t==null?void 0:t.type)==="success"?((i=(a=m(this,$e)).onSuccess)==null||i.call(a,t.data,h,g),(o=(n=m(this,$e)).onSettled)==null||o.call(n,t.data,null,h,g)):(t==null?void 0:t.type)==="error"&&((c=(l=m(this,$e)).onError)==null||c.call(l,t.error,h,g),(u=(d=m(this,$e)).onSettled)==null||u.call(d,void 0,t.error,h,g))}this.listeners.forEach(h=>{h(m(this,Ye))})})},hi),Ri=b.createContext(void 0),pt=r=>{const e=b.useContext(Ri);if(!e)throw new Error("No QueryClient set, use QueryClientProvider to set one");return e},Oo=({client:r,children:e})=>(b.useEffect(()=>(r.mount(),()=>{r.unmount()}),[r]),s.jsx(Ri.Provider,{value:r,children:e})),Mi=b.createContext(!1),Ro=()=>b.useContext(Mi);Mi.Provider;function Mo(){let r=!1;return{clearReset:()=>{r=!1},reset:()=>{r=!0},isReset:()=>r}}var $o=b.createContext(Mo()),Lo=()=>b.useContext($o);function $i(r,e){return typeof r=="function"?r(...e):!!r}function yr(){}var Do=(r,e)=>{(r.suspense||r.throwOnError||r.experimental_prefetchInRender)&&(e.isReset()||(r.retryOnMount=!1))},Uo=r=>{b.useEffect(()=>{r.clearReset()},[r])},Fo=({result:r,errorResetBoundary:e,throwOnError:t,query:a})=>r.isError&&!e.isReset()&&!r.isFetching&&a&&$i(t,[r.error,a]),zo=r=>{r.suspense&&(r.staleTime===void 0&&(r.staleTime=1e3),typeof r.gcTime=="number"&&(r.gcTime=Math.max(r.gcTime,1e3)))},Bo=(r,e)=>r.isLoading&&r.isFetching&&!e,qo=(r,e)=>(r==null?void 0:r.suspense)&&e.isPending,ya=(r,e,t)=>e.fetchOptimistic(r).catch(()=>{t.clearReset()});function Wo(r,e,t){var u,h,g,f,x;const a=pt(),i=Ro(),n=Lo(),o=a.defaultQueryOptions(r);(h=(u=a.getDefaultOptions().queries)==null?void 0:u._experimental_beforeQuery)==null||h.call(u,o),o._optimisticResults=i?"isRestoring":"optimistic",zo(o),Do(o,n),Uo(n);const l=!a.getQueryCache().get(o.queryHash),[c]=b.useState(()=>new e(a,o)),d=c.getOptimisticResult(o);if(b.useSyncExternalStore(b.useCallback(y=>{const p=i?yr:c.subscribe(Q.batchCalls(y));return c.updateResult(),p},[c,i]),()=>c.getCurrentResult(),()=>c.getCurrentResult()),b.useEffect(()=>{c.setOptions(o,{listeners:!1})},[o,c]),qo(o,d))throw ya(o,c,n);if(Fo({result:d,errorResetBoundary:n,throwOnError:o.throwOnError,query:a.getQueryCache().get(o.queryHash)}))throw d.error;if((f=(g=a.getDefaultOptions().queries)==null?void 0:g._experimental_afterQuery)==null||f.call(g,o,d),o.experimental_prefetchInRender&&!mt&&Bo(d,i)){const y=l?ya(o,c,n):(x=a.getQueryCache().get(o.queryHash))==null?void 0:x.promise;y==null||y.catch(yr).finally(()=>{c.updateResult()})}return o.notifyOnChangeProps?d:c.trackResult(d)}function Et(r,e){return Wo(r,To)}function Li(r,e){const t=pt(),[a]=b.useState(()=>new Ao(t,r));b.useEffect(()=>{a.setOptions(r)},[a,r]);const i=b.useSyncExternalStore(b.useCallback(o=>a.subscribe(Q.batchCalls(o)),[a]),()=>a.getCurrentResult(),()=>a.getCurrentResult()),n=b.useCallback((o,l)=>{a.mutate(o,l).catch(yr)},[a]);if(i.error&&$i(a.options.throwOnError,[i.error]))throw i.error;return{...i,mutate:n,mutateAsync:i.mutate}}async function Go(r){if(!r.ok){const e=await r.text()||r.statusText;throw new Error(`${r.status}: ${e}`)}}const Ko=({on401:r})=>async({queryKey:e})=>{const t=await fetch(e.join("/"),{credentials:"include"});return r==="returnNull"&&t.status===401?null:(await Go(t),await t.json())},Vo=new Eo({defaultOptions:{queries:{queryFn:Ko({on401:"throw"}),refetchInterval:!1,refetchOnWindowFocus:!0,staleTime:1e3*60*2,gcTime:1e3*60*15,retry:3,retryDelay:r=>Math.min(1e3*2**r,1e4)},mutations:{retry:2,retryDelay:1e3}}}),Ho="modulepreload",Qo=function(r,e){return new URL(r,e).href},ba={},Ht=function(e,t,a){let i=Promise.resolve();if(t&&t.length>0){const o=document.getElementsByTagName("link"),l=document.querySelector("meta[property=csp-nonce]"),c=(l==null?void 0:l.nonce)||(l==null?void 0:l.getAttribute("nonce"));i=Promise.allSettled(t.map(d=>{if(d=Qo(d,a),d in ba)return;ba[d]=!0;const u=d.endsWith(".css"),h=u?'[rel="stylesheet"]':"";if(!!a)for(let x=o.length-1;x>=0;x--){const y=o[x];if(y.href===d&&(!u||y.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${d}"]${h}`))return;const f=document.createElement("link");if(f.rel=u?"stylesheet":Ho,u||(f.as="script"),f.crossOrigin="",f.href=d,c&&f.setAttribute("nonce",c),document.head.appendChild(f),u)return new Promise((x,y)=>{f.addEventListener("load",x),f.addEventListener("error",()=>y(new Error(`Unable to preload CSS for ${d}`)))})}))}function n(o){const l=new Event("vite:preloadError",{cancelable:!0});if(l.payload=o,window.dispatchEvent(l),!l.defaultPrevented)throw o}return i.then(o=>{for(const l of o||[])l.status==="rejected"&&n(l.reason);return e().catch(n)})},Jo=r=>{let e;return r?e=r:typeof fetch>"u"?e=(...t)=>Ht(async()=>{const{default:a}=await Promise.resolve().then(()=>Qt);return{default:a}},void 0,import.meta.url).then(({default:a})=>a(...t)):e=fetch,(...t)=>e(...t)};class zr extends Error{constructor(e,t="FunctionsError",a){super(e),this.name=t,this.context=a}}class Yo extends zr{constructor(e){super("Failed to send a request to the Edge Function","FunctionsFetchError",e)}}class va extends zr{constructor(e){super("Relay Error invoking the Edge Function","FunctionsRelayError",e)}}class wa extends zr{constructor(e){super("Edge Function returned a non-2xx status code","FunctionsHttpError",e)}}var br;(function(r){r.Any="any",r.ApNortheast1="ap-northeast-1",r.ApNortheast2="ap-northeast-2",r.ApSouth1="ap-south-1",r.ApSoutheast1="ap-southeast-1",r.ApSoutheast2="ap-southeast-2",r.CaCentral1="ca-central-1",r.EuCentral1="eu-central-1",r.EuWest1="eu-west-1",r.EuWest2="eu-west-2",r.EuWest3="eu-west-3",r.SaEast1="sa-east-1",r.UsEast1="us-east-1",r.UsWest1="us-west-1",r.UsWest2="us-west-2"})(br||(br={}));var Zo=function(r,e,t,a){function i(n){return n instanceof t?n:new t(function(o){o(n)})}return new(t||(t=Promise))(function(n,o){function l(u){try{d(a.next(u))}catch(h){o(h)}}function c(u){try{d(a.throw(u))}catch(h){o(h)}}function d(u){u.done?n(u.value):i(u.value).then(l,c)}d((a=a.apply(r,e||[])).next())})};class Xo{constructor(e,{headers:t={},customFetch:a,region:i=br.Any}={}){this.url=e,this.headers=t,this.region=i,this.fetch=Jo(a)}setAuth(e){this.headers.Authorization=`Bearer ${e}`}invoke(e,t={}){var a;return Zo(this,void 0,void 0,function*(){try{const{headers:i,method:n,body:o}=t;let l={},{region:c}=t;c||(c=this.region);const d=new URL(`${this.url}/${e}`);c&&c!=="any"&&(l["x-region"]=c,d.searchParams.set("forceFunctionRegion",c));let u;o&&(i&&!Object.prototype.hasOwnProperty.call(i,"Content-Type")||!i)&&(typeof Blob<"u"&&o instanceof Blob||o instanceof ArrayBuffer?(l["Content-Type"]="application/octet-stream",u=o):typeof o=="string"?(l["Content-Type"]="text/plain",u=o):typeof FormData<"u"&&o instanceof FormData?u=o:(l["Content-Type"]="application/json",u=JSON.stringify(o)));const h=yield this.fetch(d.toString(),{method:n||"POST",headers:Object.assign(Object.assign(Object.assign({},l),this.headers),i),body:u}).catch(y=>{throw new Yo(y)}),g=h.headers.get("x-relay-error");if(g&&g==="true")throw new va(h);if(!h.ok)throw new wa(h);let f=((a=h.headers.get("Content-Type"))!==null&&a!==void 0?a:"text/plain").split(";")[0].trim(),x;return f==="application/json"?x=yield h.json():f==="application/octet-stream"?x=yield h.blob():f==="text/event-stream"?x=h:f==="multipart/form-data"?x=yield h.formData():x=yield h.text(),{data:x,error:null,response:h}}catch(i){return{data:null,error:i,response:i instanceof wa||i instanceof va?i.context:void 0}}})}}var le={},Br={},As={},hs={},Os={},Rs={},el=function(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("unable to locate global object")},Bt=el();const tl=Bt.fetch,Di=Bt.fetch.bind(Bt),Ui=Bt.Headers,sl=Bt.Request,rl=Bt.Response,Qt=Object.freeze(Object.defineProperty({__proto__:null,Headers:Ui,Request:sl,Response:rl,default:Di,fetch:tl},Symbol.toStringTag,{value:"Module"})),al=lo(Qt);var Ms={};Object.defineProperty(Ms,"__esModule",{value:!0});let il=class extends Error{constructor(e){super(e.message),this.name="PostgrestError",this.details=e.details,this.hint=e.hint,this.code=e.code}};Ms.default=il;var Fi=pe&&pe.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(Rs,"__esModule",{value:!0});const nl=Fi(al),ol=Fi(Ms);let ll=class{constructor(e){this.shouldThrowOnError=!1,this.method=e.method,this.url=e.url,this.headers=e.headers,this.schema=e.schema,this.body=e.body,this.shouldThrowOnError=e.shouldThrowOnError,this.signal=e.signal,this.isMaybeSingle=e.isMaybeSingle,e.fetch?this.fetch=e.fetch:typeof fetch>"u"?this.fetch=nl.default:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(e,t){return this.headers=Object.assign({},this.headers),this.headers[e]=t,this}then(e,t){this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers["Accept-Profile"]=this.schema:this.headers["Content-Profile"]=this.schema),this.method!=="GET"&&this.method!=="HEAD"&&(this.headers["Content-Type"]="application/json");const a=this.fetch;let i=a(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async n=>{var o,l,c;let d=null,u=null,h=null,g=n.status,f=n.statusText;if(n.ok){if(this.method!=="HEAD"){const w=await n.text();w===""||(this.headers.Accept==="text/csv"||this.headers.Accept&&this.headers.Accept.includes("application/vnd.pgrst.plan+text")?u=w:u=JSON.parse(w))}const y=(o=this.headers.Prefer)===null||o===void 0?void 0:o.match(/count=(exact|planned|estimated)/),p=(l=n.headers.get("content-range"))===null||l===void 0?void 0:l.split("/");y&&p&&p.length>1&&(h=parseInt(p[1])),this.isMaybeSingle&&this.method==="GET"&&Array.isArray(u)&&(u.length>1?(d={code:"PGRST116",details:`Results contain ${u.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},u=null,h=null,g=406,f="Not Acceptable"):u.length===1?u=u[0]:u=null)}else{const y=await n.text();try{d=JSON.parse(y),Array.isArray(d)&&n.status===404&&(u=[],d=null,g=200,f="OK")}catch{n.status===404&&y===""?(g=204,f="No Content"):d={message:y}}if(d&&this.isMaybeSingle&&(!((c=d==null?void 0:d.details)===null||c===void 0)&&c.includes("0 rows"))&&(d=null,g=200,f="OK"),d&&this.shouldThrowOnError)throw new ol.default(d)}return{error:d,data:u,count:h,status:g,statusText:f}});return this.shouldThrowOnError||(i=i.catch(n=>{var o,l,c;return{error:{message:`${(o=n==null?void 0:n.name)!==null&&o!==void 0?o:"FetchError"}: ${n==null?void 0:n.message}`,details:`${(l=n==null?void 0:n.stack)!==null&&l!==void 0?l:""}`,hint:"",code:`${(c=n==null?void 0:n.code)!==null&&c!==void 0?c:""}`},data:null,count:null,status:0,statusText:""}})),i.then(e,t)}returns(){return this}overrideTypes(){return this}};Rs.default=ll;var cl=pe&&pe.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(Os,"__esModule",{value:!0});const dl=cl(Rs);let ul=class extends dl.default{select(e){let t=!1;const a=(e??"*").split("").map(i=>/\s/.test(i)&&!t?"":(i==='"'&&(t=!t),i)).join("");return this.url.searchParams.set("select",a),this.headers.Prefer&&(this.headers.Prefer+=","),this.headers.Prefer+="return=representation",this}order(e,{ascending:t=!0,nullsFirst:a,foreignTable:i,referencedTable:n=i}={}){const o=n?`${n}.order`:"order",l=this.url.searchParams.get(o);return this.url.searchParams.set(o,`${l?`${l},`:""}${e}.${t?"asc":"desc"}${a===void 0?"":a?".nullsfirst":".nullslast"}`),this}limit(e,{foreignTable:t,referencedTable:a=t}={}){const i=typeof a>"u"?"limit":`${a}.limit`;return this.url.searchParams.set(i,`${e}`),this}range(e,t,{foreignTable:a,referencedTable:i=a}={}){const n=typeof i>"u"?"offset":`${i}.offset`,o=typeof i>"u"?"limit":`${i}.limit`;return this.url.searchParams.set(n,`${e}`),this.url.searchParams.set(o,`${t-e+1}`),this}abortSignal(e){return this.signal=e,this}single(){return this.headers.Accept="application/vnd.pgrst.object+json",this}maybeSingle(){return this.method==="GET"?this.headers.Accept="application/json":this.headers.Accept="application/vnd.pgrst.object+json",this.isMaybeSingle=!0,this}csv(){return this.headers.Accept="text/csv",this}geojson(){return this.headers.Accept="application/geo+json",this}explain({analyze:e=!1,verbose:t=!1,settings:a=!1,buffers:i=!1,wal:n=!1,format:o="text"}={}){var l;const c=[e?"analyze":null,t?"verbose":null,a?"settings":null,i?"buffers":null,n?"wal":null].filter(Boolean).join("|"),d=(l=this.headers.Accept)!==null&&l!==void 0?l:"application/json";return this.headers.Accept=`application/vnd.pgrst.plan+${o}; for="${d}"; options=${c};`,o==="json"?this:this}rollback(){var e;return((e=this.headers.Prefer)!==null&&e!==void 0?e:"").trim().length>0?this.headers.Prefer+=",tx=rollback":this.headers.Prefer="tx=rollback",this}returns(){return this}};Os.default=ul;var hl=pe&&pe.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(hs,"__esModule",{value:!0});const ml=hl(Os);let gl=class extends ml.default{eq(e,t){return this.url.searchParams.append(e,`eq.${t}`),this}neq(e,t){return this.url.searchParams.append(e,`neq.${t}`),this}gt(e,t){return this.url.searchParams.append(e,`gt.${t}`),this}gte(e,t){return this.url.searchParams.append(e,`gte.${t}`),this}lt(e,t){return this.url.searchParams.append(e,`lt.${t}`),this}lte(e,t){return this.url.searchParams.append(e,`lte.${t}`),this}like(e,t){return this.url.searchParams.append(e,`like.${t}`),this}likeAllOf(e,t){return this.url.searchParams.append(e,`like(all).{${t.join(",")}}`),this}likeAnyOf(e,t){return this.url.searchParams.append(e,`like(any).{${t.join(",")}}`),this}ilike(e,t){return this.url.searchParams.append(e,`ilike.${t}`),this}ilikeAllOf(e,t){return this.url.searchParams.append(e,`ilike(all).{${t.join(",")}}`),this}ilikeAnyOf(e,t){return this.url.searchParams.append(e,`ilike(any).{${t.join(",")}}`),this}is(e,t){return this.url.searchParams.append(e,`is.${t}`),this}in(e,t){const a=Array.from(new Set(t)).map(i=>typeof i=="string"&&new RegExp("[,()]").test(i)?`"${i}"`:`${i}`).join(",");return this.url.searchParams.append(e,`in.(${a})`),this}contains(e,t){return typeof t=="string"?this.url.searchParams.append(e,`cs.${t}`):Array.isArray(t)?this.url.searchParams.append(e,`cs.{${t.join(",")}}`):this.url.searchParams.append(e,`cs.${JSON.stringify(t)}`),this}containedBy(e,t){return typeof t=="string"?this.url.searchParams.append(e,`cd.${t}`):Array.isArray(t)?this.url.searchParams.append(e,`cd.{${t.join(",")}}`):this.url.searchParams.append(e,`cd.${JSON.stringify(t)}`),this}rangeGt(e,t){return this.url.searchParams.append(e,`sr.${t}`),this}rangeGte(e,t){return this.url.searchParams.append(e,`nxl.${t}`),this}rangeLt(e,t){return this.url.searchParams.append(e,`sl.${t}`),this}rangeLte(e,t){return this.url.searchParams.append(e,`nxr.${t}`),this}rangeAdjacent(e,t){return this.url.searchParams.append(e,`adj.${t}`),this}overlaps(e,t){return typeof t=="string"?this.url.searchParams.append(e,`ov.${t}`):this.url.searchParams.append(e,`ov.{${t.join(",")}}`),this}textSearch(e,t,{config:a,type:i}={}){let n="";i==="plain"?n="pl":i==="phrase"?n="ph":i==="websearch"&&(n="w");const o=a===void 0?"":`(${a})`;return this.url.searchParams.append(e,`${n}fts${o}.${t}`),this}match(e){return Object.entries(e).forEach(([t,a])=>{this.url.searchParams.append(t,`eq.${a}`)}),this}not(e,t,a){return this.url.searchParams.append(e,`not.${t}.${a}`),this}or(e,{foreignTable:t,referencedTable:a=t}={}){const i=a?`${a}.or`:"or";return this.url.searchParams.append(i,`(${e})`),this}filter(e,t,a){return this.url.searchParams.append(e,`${t}.${a}`),this}};hs.default=gl;var fl=pe&&pe.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(As,"__esModule",{value:!0});const Yt=fl(hs);let pl=class{constructor(e,{headers:t={},schema:a,fetch:i}){this.url=e,this.headers=t,this.schema=a,this.fetch=i}select(e,{head:t=!1,count:a}={}){const i=t?"HEAD":"GET";let n=!1;const o=(e??"*").split("").map(l=>/\s/.test(l)&&!n?"":(l==='"'&&(n=!n),l)).join("");return this.url.searchParams.set("select",o),a&&(this.headers.Prefer=`count=${a}`),new Yt.default({method:i,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}insert(e,{count:t,defaultToNull:a=!0}={}){const i="POST",n=[];if(this.headers.Prefer&&n.push(this.headers.Prefer),t&&n.push(`count=${t}`),a||n.push("missing=default"),this.headers.Prefer=n.join(","),Array.isArray(e)){const o=e.reduce((l,c)=>l.concat(Object.keys(c)),[]);if(o.length>0){const l=[...new Set(o)].map(c=>`"${c}"`);this.url.searchParams.set("columns",l.join(","))}}return new Yt.default({method:i,url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:this.fetch,allowEmpty:!1})}upsert(e,{onConflict:t,ignoreDuplicates:a=!1,count:i,defaultToNull:n=!0}={}){const o="POST",l=[`resolution=${a?"ignore":"merge"}-duplicates`];if(t!==void 0&&this.url.searchParams.set("on_conflict",t),this.headers.Prefer&&l.push(this.headers.Prefer),i&&l.push(`count=${i}`),n||l.push("missing=default"),this.headers.Prefer=l.join(","),Array.isArray(e)){const c=e.reduce((d,u)=>d.concat(Object.keys(u)),[]);if(c.length>0){const d=[...new Set(c)].map(u=>`"${u}"`);this.url.searchParams.set("columns",d.join(","))}}return new Yt.default({method:o,url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:this.fetch,allowEmpty:!1})}update(e,{count:t}={}){const a="PATCH",i=[];return this.headers.Prefer&&i.push(this.headers.Prefer),t&&i.push(`count=${t}`),this.headers.Prefer=i.join(","),new Yt.default({method:a,url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:this.fetch,allowEmpty:!1})}delete({count:e}={}){const t="DELETE",a=[];return e&&a.push(`count=${e}`),this.headers.Prefer&&a.unshift(this.headers.Prefer),this.headers.Prefer=a.join(","),new Yt.default({method:t,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}};As.default=pl;var $s={},Ls={};Object.defineProperty(Ls,"__esModule",{value:!0});Ls.version=void 0;Ls.version="0.0.0-automated";Object.defineProperty($s,"__esModule",{value:!0});$s.DEFAULT_HEADERS=void 0;const xl=Ls;$s.DEFAULT_HEADERS={"X-Client-Info":`postgrest-js/${xl.version}`};var zi=pe&&pe.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(Br,"__esModule",{value:!0});const yl=zi(As),bl=zi(hs),vl=$s;let wl=class Bi{constructor(e,{headers:t={},schema:a,fetch:i}={}){this.url=e,this.headers=Object.assign(Object.assign({},vl.DEFAULT_HEADERS),t),this.schemaName=a,this.fetch=i}from(e){const t=new URL(`${this.url}/${e}`);return new yl.default(t,{headers:Object.assign({},this.headers),schema:this.schemaName,fetch:this.fetch})}schema(e){return new Bi(this.url,{headers:this.headers,schema:e,fetch:this.fetch})}rpc(e,t={},{head:a=!1,get:i=!1,count:n}={}){let o;const l=new URL(`${this.url}/rpc/${e}`);let c;a||i?(o=a?"HEAD":"GET",Object.entries(t).filter(([u,h])=>h!==void 0).map(([u,h])=>[u,Array.isArray(h)?`{${h.join(",")}}`:`${h}`]).forEach(([u,h])=>{l.searchParams.append(u,h)})):(o="POST",c=t);const d=Object.assign({},this.headers);return n&&(d.Prefer=`count=${n}`),new bl.default({method:o,url:l,headers:d,schema:this.schemaName,body:c,fetch:this.fetch,allowEmpty:!1})}};Br.default=wl;var Jt=pe&&pe.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(le,"__esModule",{value:!0});le.PostgrestError=le.PostgrestBuilder=le.PostgrestTransformBuilder=le.PostgrestFilterBuilder=le.PostgrestQueryBuilder=le.PostgrestClient=void 0;const qi=Jt(Br);le.PostgrestClient=qi.default;const Wi=Jt(As);le.PostgrestQueryBuilder=Wi.default;const Gi=Jt(hs);le.PostgrestFilterBuilder=Gi.default;const Ki=Jt(Os);le.PostgrestTransformBuilder=Ki.default;const Vi=Jt(Rs);le.PostgrestBuilder=Vi.default;const Hi=Jt(Ms);le.PostgrestError=Hi.default;var jl=le.default={PostgrestClient:qi.default,PostgrestQueryBuilder:Wi.default,PostgrestFilterBuilder:Gi.default,PostgrestTransformBuilder:Ki.default,PostgrestBuilder:Vi.default,PostgrestError:Hi.default};const{PostgrestClient:_l,PostgrestQueryBuilder:xh,PostgrestFilterBuilder:yh,PostgrestTransformBuilder:bh,PostgrestBuilder:vh,PostgrestError:wh}=jl;function Nl(){if(typeof WebSocket<"u")return WebSocket;if(typeof global.WebSocket<"u")return global.WebSocket;if(typeof window.WebSocket<"u")return window.WebSocket;if(typeof self.WebSocket<"u")return self.WebSocket;throw new Error("`WebSocket` is not supported in this environment")}const kl=Nl(),Sl="2.11.15",Cl=`realtime-js/${Sl}`,El="1.0.0",Qi=1e4,Tl=1e3;var ts;(function(r){r[r.connecting=0]="connecting",r[r.open=1]="open",r[r.closing=2]="closing",r[r.closed=3]="closed"})(ts||(ts={}));var Z;(function(r){r.closed="closed",r.errored="errored",r.joined="joined",r.joining="joining",r.leaving="leaving"})(Z||(Z={}));var be;(function(r){r.close="phx_close",r.error="phx_error",r.join="phx_join",r.reply="phx_reply",r.leave="phx_leave",r.access_token="access_token"})(be||(be={}));var vr;(function(r){r.websocket="websocket"})(vr||(vr={}));var rt;(function(r){r.Connecting="connecting",r.Open="open",r.Closing="closing",r.Closed="closed"})(rt||(rt={}));class Pl{constructor(){this.HEADER_LENGTH=1}decode(e,t){return e.constructor===ArrayBuffer?t(this._binaryDecode(e)):t(typeof e=="string"?JSON.parse(e):{})}_binaryDecode(e){const t=new DataView(e),a=new TextDecoder;return this._decodeBroadcast(e,t,a)}_decodeBroadcast(e,t,a){const i=t.getUint8(1),n=t.getUint8(2);let o=this.HEADER_LENGTH+2;const l=a.decode(e.slice(o,o+i));o=o+i;const c=a.decode(e.slice(o,o+n));o=o+n;const d=JSON.parse(a.decode(e.slice(o,e.byteLength)));return{ref:null,topic:l,event:c,payload:d}}}class Ji{constructor(e,t){this.callback=e,this.timerCalc=t,this.timer=void 0,this.tries=0,this.callback=e,this.timerCalc=t}reset(){this.tries=0,clearTimeout(this.timer)}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}var B;(function(r){r.abstime="abstime",r.bool="bool",r.date="date",r.daterange="daterange",r.float4="float4",r.float8="float8",r.int2="int2",r.int4="int4",r.int4range="int4range",r.int8="int8",r.int8range="int8range",r.json="json",r.jsonb="jsonb",r.money="money",r.numeric="numeric",r.oid="oid",r.reltime="reltime",r.text="text",r.time="time",r.timestamp="timestamp",r.timestamptz="timestamptz",r.timetz="timetz",r.tsrange="tsrange",r.tstzrange="tstzrange"})(B||(B={}));const ja=(r,e,t={})=>{var a;const i=(a=t.skipTypes)!==null&&a!==void 0?a:[];return Object.keys(e).reduce((n,o)=>(n[o]=Il(o,r,e,i),n),{})},Il=(r,e,t,a)=>{const i=e.find(l=>l.name===r),n=i==null?void 0:i.type,o=t[r];return n&&!a.includes(n)?Yi(n,o):wr(o)},Yi=(r,e)=>{if(r.charAt(0)==="_"){const t=r.slice(1,r.length);return Ml(e,t)}switch(r){case B.bool:return Al(e);case B.float4:case B.float8:case B.int2:case B.int4:case B.int8:case B.numeric:case B.oid:return Ol(e);case B.json:case B.jsonb:return Rl(e);case B.timestamp:return $l(e);case B.abstime:case B.date:case B.daterange:case B.int4range:case B.int8range:case B.money:case B.reltime:case B.text:case B.time:case B.timestamptz:case B.timetz:case B.tsrange:case B.tstzrange:return wr(e);default:return wr(e)}},wr=r=>r,Al=r=>{switch(r){case"t":return!0;case"f":return!1;default:return r}},Ol=r=>{if(typeof r=="string"){const e=parseFloat(r);if(!Number.isNaN(e))return e}return r},Rl=r=>{if(typeof r=="string")try{return JSON.parse(r)}catch(e){return console.log(`JSON parse error: ${e}`),r}return r},Ml=(r,e)=>{if(typeof r!="string")return r;const t=r.length-1,a=r[t];if(r[0]==="{"&&a==="}"){let n;const o=r.slice(1,t);try{n=JSON.parse("["+o+"]")}catch{n=o?o.split(","):[]}return n.map(l=>Yi(e,l))}return r},$l=r=>typeof r=="string"?r.replace(" ","T"):r,Zi=r=>{let e=r;return e=e.replace(/^ws/i,"http"),e=e.replace(/(\/socket\/websocket|\/socket|\/websocket)\/?$/i,""),e.replace(/\/+$/,"")};class Gs{constructor(e,t,a={},i=Qi){this.channel=e,this.event=t,this.payload=a,this.timeout=i,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(e){this.timeout=e,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(e){this.payload=Object.assign(Object.assign({},this.payload),e)}receive(e,t){var a;return this._hasReceived(e)&&t((a=this.receivedResp)===null||a===void 0?void 0:a.response),this.recHooks.push({status:e,callback:t}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const e=t=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=t,this._matchReceive(t)};this.channel._on(this.refEvent,{},e),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(e,t){this.refEvent&&this.channel._trigger(this.refEvent,{status:e,response:t})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:e,response:t}){this.recHooks.filter(a=>a.status===e).forEach(a=>a.callback(t))}_hasReceived(e){return this.receivedResp&&this.receivedResp.status===e}}var _a;(function(r){r.SYNC="sync",r.JOIN="join",r.LEAVE="leave"})(_a||(_a={}));class ss{constructor(e,t){this.channel=e,this.state={},this.pendingDiffs=[],this.joinRef=null,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const a=(t==null?void 0:t.events)||{state:"presence_state",diff:"presence_diff"};this.channel._on(a.state,{},i=>{const{onJoin:n,onLeave:o,onSync:l}=this.caller;this.joinRef=this.channel._joinRef(),this.state=ss.syncState(this.state,i,n,o),this.pendingDiffs.forEach(c=>{this.state=ss.syncDiff(this.state,c,n,o)}),this.pendingDiffs=[],l()}),this.channel._on(a.diff,{},i=>{const{onJoin:n,onLeave:o,onSync:l}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(i):(this.state=ss.syncDiff(this.state,i,n,o),l())}),this.onJoin((i,n,o)=>{this.channel._trigger("presence",{event:"join",key:i,currentPresences:n,newPresences:o})}),this.onLeave((i,n,o)=>{this.channel._trigger("presence",{event:"leave",key:i,currentPresences:n,leftPresences:o})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(e,t,a,i){const n=this.cloneDeep(e),o=this.transformState(t),l={},c={};return this.map(n,(d,u)=>{o[d]||(c[d]=u)}),this.map(o,(d,u)=>{const h=n[d];if(h){const g=u.map(p=>p.presence_ref),f=h.map(p=>p.presence_ref),x=u.filter(p=>f.indexOf(p.presence_ref)<0),y=h.filter(p=>g.indexOf(p.presence_ref)<0);x.length>0&&(l[d]=x),y.length>0&&(c[d]=y)}else l[d]=u}),this.syncDiff(n,{joins:l,leaves:c},a,i)}static syncDiff(e,t,a,i){const{joins:n,leaves:o}={joins:this.transformState(t.joins),leaves:this.transformState(t.leaves)};return a||(a=()=>{}),i||(i=()=>{}),this.map(n,(l,c)=>{var d;const u=(d=e[l])!==null&&d!==void 0?d:[];if(e[l]=this.cloneDeep(c),u.length>0){const h=e[l].map(f=>f.presence_ref),g=u.filter(f=>h.indexOf(f.presence_ref)<0);e[l].unshift(...g)}a(l,u,c)}),this.map(o,(l,c)=>{let d=e[l];if(!d)return;const u=c.map(h=>h.presence_ref);d=d.filter(h=>u.indexOf(h.presence_ref)<0),e[l]=d,i(l,d,c),d.length===0&&delete e[l]}),e}static map(e,t){return Object.getOwnPropertyNames(e).map(a=>t(a,e[a]))}static transformState(e){return e=this.cloneDeep(e),Object.getOwnPropertyNames(e).reduce((t,a)=>{const i=e[a];return"metas"in i?t[a]=i.metas.map(n=>(n.presence_ref=n.phx_ref,delete n.phx_ref,delete n.phx_ref_prev,n)):t[a]=i,t},{})}static cloneDeep(e){return JSON.parse(JSON.stringify(e))}onJoin(e){this.caller.onJoin=e}onLeave(e){this.caller.onLeave=e}onSync(e){this.caller.onSync=e}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var Na;(function(r){r.ALL="*",r.INSERT="INSERT",r.UPDATE="UPDATE",r.DELETE="DELETE"})(Na||(Na={}));var ka;(function(r){r.BROADCAST="broadcast",r.PRESENCE="presence",r.POSTGRES_CHANGES="postgres_changes",r.SYSTEM="system"})(ka||(ka={}));var Oe;(function(r){r.SUBSCRIBED="SUBSCRIBED",r.TIMED_OUT="TIMED_OUT",r.CLOSED="CLOSED",r.CHANNEL_ERROR="CHANNEL_ERROR"})(Oe||(Oe={}));class qr{constructor(e,t={config:{}},a){this.topic=e,this.params=t,this.socket=a,this.bindings={},this.state=Z.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=e.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:""},private:!1},t.config),this.timeout=this.socket.timeout,this.joinPush=new Gs(this,be.join,this.params,this.timeout),this.rejoinTimer=new Ji(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=Z.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(i=>i.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=Z.closed,this.socket._remove(this)}),this._onError(i=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,i),this.state=Z.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=Z.errored,this.rejoinTimer.scheduleTimeout())}),this._on(be.reply,{},(i,n)=>{this._trigger(this._replyEventName(n),i)}),this.presence=new ss(this),this.broadcastEndpointURL=Zi(this.socket.endPoint)+"/api/broadcast",this.private=this.params.config.private||!1}subscribe(e,t=this.timeout){var a,i;if(this.socket.isConnected()||this.socket.connect(),this.state==Z.closed){const{config:{broadcast:n,presence:o,private:l}}=this.params;this._onError(u=>e==null?void 0:e(Oe.CHANNEL_ERROR,u)),this._onClose(()=>e==null?void 0:e(Oe.CLOSED));const c={},d={broadcast:n,presence:o,postgres_changes:(i=(a=this.bindings.postgres_changes)===null||a===void 0?void 0:a.map(u=>u.filter))!==null&&i!==void 0?i:[],private:l};this.socket.accessTokenValue&&(c.access_token=this.socket.accessTokenValue),this.updateJoinPayload(Object.assign({config:d},c)),this.joinedOnce=!0,this._rejoin(t),this.joinPush.receive("ok",async({postgres_changes:u})=>{var h;if(this.socket.setAuth(),u===void 0){e==null||e(Oe.SUBSCRIBED);return}else{const g=this.bindings.postgres_changes,f=(h=g==null?void 0:g.length)!==null&&h!==void 0?h:0,x=[];for(let y=0;y<f;y++){const p=g[y],{filter:{event:w,schema:T,table:v,filter:C}}=p,N=u&&u[y];if(N&&N.event===w&&N.schema===T&&N.table===v&&N.filter===C)x.push(Object.assign(Object.assign({},p),{id:N.id}));else{this.unsubscribe(),this.state=Z.errored,e==null||e(Oe.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=x,e&&e(Oe.SUBSCRIBED);return}}).receive("error",u=>{this.state=Z.errored,e==null||e(Oe.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(u).join(", ")||"error")))}).receive("timeout",()=>{e==null||e(Oe.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(e,t={}){return await this.send({type:"presence",event:"track",payload:e},t.timeout||this.timeout)}async untrack(e={}){return await this.send({type:"presence",event:"untrack"},e)}on(e,t,a){return this._on(e,t,a)}async send(e,t={}){var a,i;if(!this._canPush()&&e.type==="broadcast"){const{event:n,payload:o}=e,c={method:"POST",headers:{Authorization:this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"",apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:n,payload:o,private:this.private}]})};try{const d=await this._fetchWithTimeout(this.broadcastEndpointURL,c,(a=t.timeout)!==null&&a!==void 0?a:this.timeout);return await((i=d.body)===null||i===void 0?void 0:i.cancel()),d.ok?"ok":"error"}catch(d){return d.name==="AbortError"?"timed out":"error"}}else return new Promise(n=>{var o,l,c;const d=this._push(e.type,e,t.timeout||this.timeout);e.type==="broadcast"&&!(!((c=(l=(o=this.params)===null||o===void 0?void 0:o.config)===null||l===void 0?void 0:l.broadcast)===null||c===void 0)&&c.ack)&&n("ok"),d.receive("ok",()=>n("ok")),d.receive("error",()=>n("error")),d.receive("timeout",()=>n("timed out"))})}updateJoinPayload(e){this.joinPush.updatePayload(e)}unsubscribe(e=this.timeout){this.state=Z.leaving;const t=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(be.close,"leave",this._joinRef())};this.joinPush.destroy();let a=null;return new Promise(i=>{a=new Gs(this,be.leave,{},e),a.receive("ok",()=>{t(),i("ok")}).receive("timeout",()=>{t(),i("timed out")}).receive("error",()=>{i("error")}),a.send(),this._canPush()||a.trigger("ok",{})}).finally(()=>{a==null||a.destroy()})}teardown(){this.pushBuffer.forEach(e=>e.destroy()),this.rejoinTimer&&clearTimeout(this.rejoinTimer.timer),this.joinPush.destroy()}async _fetchWithTimeout(e,t,a){const i=new AbortController,n=setTimeout(()=>i.abort(),a),o=await this.socket.fetch(e,Object.assign(Object.assign({},t),{signal:i.signal}));return clearTimeout(n),o}_push(e,t,a=this.timeout){if(!this.joinedOnce)throw`tried to push '${e}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let i=new Gs(this,e,t,a);return this._canPush()?i.send():(i.startTimeout(),this.pushBuffer.push(i)),i}_onMessage(e,t,a){return t}_isMember(e){return this.topic===e}_joinRef(){return this.joinPush.ref}_trigger(e,t,a){var i,n;const o=e.toLocaleLowerCase(),{close:l,error:c,leave:d,join:u}=be;if(a&&[l,c,d,u].indexOf(o)>=0&&a!==this._joinRef())return;let g=this._onMessage(o,t,a);if(t&&!g)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(o)?(i=this.bindings.postgres_changes)===null||i===void 0||i.filter(f=>{var x,y,p;return((x=f.filter)===null||x===void 0?void 0:x.event)==="*"||((p=(y=f.filter)===null||y===void 0?void 0:y.event)===null||p===void 0?void 0:p.toLocaleLowerCase())===o}).map(f=>f.callback(g,a)):(n=this.bindings[o])===null||n===void 0||n.filter(f=>{var x,y,p,w,T,v;if(["broadcast","presence","postgres_changes"].includes(o))if("id"in f){const C=f.id,N=(x=f.filter)===null||x===void 0?void 0:x.event;return C&&((y=t.ids)===null||y===void 0?void 0:y.includes(C))&&(N==="*"||(N==null?void 0:N.toLocaleLowerCase())===((p=t.data)===null||p===void 0?void 0:p.type.toLocaleLowerCase()))}else{const C=(T=(w=f==null?void 0:f.filter)===null||w===void 0?void 0:w.event)===null||T===void 0?void 0:T.toLocaleLowerCase();return C==="*"||C===((v=t==null?void 0:t.event)===null||v===void 0?void 0:v.toLocaleLowerCase())}else return f.type.toLocaleLowerCase()===o}).map(f=>{if(typeof g=="object"&&"ids"in g){const x=g.data,{schema:y,table:p,commit_timestamp:w,type:T,errors:v}=x;g=Object.assign(Object.assign({},{schema:y,table:p,commit_timestamp:w,eventType:T,new:{},old:{},errors:v}),this._getPayloadRecords(x))}f.callback(g,a)})}_isClosed(){return this.state===Z.closed}_isJoined(){return this.state===Z.joined}_isJoining(){return this.state===Z.joining}_isLeaving(){return this.state===Z.leaving}_replyEventName(e){return`chan_reply_${e}`}_on(e,t,a){const i=e.toLocaleLowerCase(),n={type:i,filter:t,callback:a};return this.bindings[i]?this.bindings[i].push(n):this.bindings[i]=[n],this}_off(e,t){const a=e.toLocaleLowerCase();return this.bindings[a]=this.bindings[a].filter(i=>{var n;return!(((n=i.type)===null||n===void 0?void 0:n.toLocaleLowerCase())===a&&qr.isEqual(i.filter,t))}),this}static isEqual(e,t){if(Object.keys(e).length!==Object.keys(t).length)return!1;for(const a in e)if(e[a]!==t[a])return!1;return!0}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(e){this._on(be.close,{},e)}_onError(e){this._on(be.error,{},t=>e(t))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(e=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=Z.joining,this.joinPush.resend(e))}_getPayloadRecords(e){const t={new:{},old:{}};return(e.type==="INSERT"||e.type==="UPDATE")&&(t.new=ja(e.columns,e.record)),(e.type==="UPDATE"||e.type==="DELETE")&&(t.old=ja(e.columns,e.old_record)),t}}const Sa=()=>{},Ll=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class Dl{constructor(e,t){var a;this.accessTokenValue=null,this.apiKey=null,this.channels=new Array,this.endPoint="",this.httpEndpoint="",this.headers={},this.params={},this.timeout=Qi,this.heartbeatIntervalMs=25e3,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.heartbeatCallback=Sa,this.ref=0,this.logger=Sa,this.conn=null,this.sendBuffer=[],this.serializer=new Pl,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._resolveFetch=n=>{let o;return n?o=n:typeof fetch>"u"?o=(...l)=>Ht(async()=>{const{default:c}=await Promise.resolve().then(()=>Qt);return{default:c}},void 0,import.meta.url).then(({default:c})=>c(...l)):o=fetch,(...l)=>o(...l)},this.endPoint=`${e}/${vr.websocket}`,this.httpEndpoint=Zi(e),t!=null&&t.transport?this.transport=t.transport:this.transport=null,t!=null&&t.params&&(this.params=t.params),t!=null&&t.timeout&&(this.timeout=t.timeout),t!=null&&t.logger&&(this.logger=t.logger),(t!=null&&t.logLevel||t!=null&&t.log_level)&&(this.logLevel=t.logLevel||t.log_level,this.params=Object.assign(Object.assign({},this.params),{log_level:this.logLevel})),t!=null&&t.heartbeatIntervalMs&&(this.heartbeatIntervalMs=t.heartbeatIntervalMs);const i=(a=t==null?void 0:t.params)===null||a===void 0?void 0:a.apikey;if(i&&(this.accessTokenValue=i,this.apiKey=i),this.reconnectAfterMs=t!=null&&t.reconnectAfterMs?t.reconnectAfterMs:n=>[1e3,2e3,5e3,1e4][n-1]||1e4,this.encode=t!=null&&t.encode?t.encode:(n,o)=>o(JSON.stringify(n)),this.decode=t!=null&&t.decode?t.decode:this.serializer.decode.bind(this.serializer),this.reconnectTimer=new Ji(async()=>{this.disconnect(),this.connect()},this.reconnectAfterMs),this.fetch=this._resolveFetch(t==null?void 0:t.fetch),t!=null&&t.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.worker=(t==null?void 0:t.worker)||!1,this.workerUrl=t==null?void 0:t.workerUrl}this.accessToken=(t==null?void 0:t.accessToken)||null}connect(){if(!this.conn){if(this.transport||(this.transport=kl),!this.transport)throw new Error("No transport provided");this.conn=new this.transport(this.endpointURL()),this.setupConnection()}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:El}))}disconnect(e,t){this.conn&&(this.conn.onclose=function(){},e?this.conn.close(e,t??""):this.conn.close(),this.conn=null,this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.reconnectTimer.reset(),this.channels.forEach(a=>a.teardown()))}getChannels(){return this.channels}async removeChannel(e){const t=await e.unsubscribe();return this.channels.length===0&&this.disconnect(),t}async removeAllChannels(){const e=await Promise.all(this.channels.map(t=>t.unsubscribe()));return this.channels=[],this.disconnect(),e}log(e,t,a){this.logger(e,t,a)}connectionState(){switch(this.conn&&this.conn.readyState){case ts.connecting:return rt.Connecting;case ts.open:return rt.Open;case ts.closing:return rt.Closing;default:return rt.Closed}}isConnected(){return this.connectionState()===rt.Open}channel(e,t={config:{}}){const a=`realtime:${e}`,i=this.getChannels().find(n=>n.topic===a);if(i)return i;{const n=new qr(`realtime:${e}`,t,this);return this.channels.push(n),n}}push(e){const{topic:t,event:a,payload:i,ref:n}=e,o=()=>{this.encode(e,l=>{var c;(c=this.conn)===null||c===void 0||c.send(l)})};this.log("push",`${t} ${a} (${n})`,i),this.isConnected()?o():this.sendBuffer.push(o)}async setAuth(e=null){let t=e||this.accessToken&&await this.accessToken()||this.accessTokenValue;this.accessTokenValue!=t&&(this.accessTokenValue=t,this.channels.forEach(a=>{const i={access_token:t,version:Cl};t&&a.updateJoinPayload(i),a.joinedOnce&&a._isJoined()&&a._push(be.access_token,{access_token:t})}))}async sendHeartbeat(){var e;if(!this.isConnected()){this.heartbeatCallback("disconnected");return}if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection"),this.heartbeatCallback("timeout"),(e=this.conn)===null||e===void 0||e.close(Tl,"hearbeat timeout");return}this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef}),this.heartbeatCallback("sent"),await this.setAuth()}onHeartbeat(e){this.heartbeatCallback=e}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(e=>e()),this.sendBuffer=[])}_makeRef(){let e=this.ref+1;return e===this.ref?this.ref=0:this.ref=e,this.ref.toString()}_leaveOpenTopic(e){let t=this.channels.find(a=>a.topic===e&&(a._isJoined()||a._isJoining()));t&&(this.log("transport",`leaving duplicate topic "${e}"`),t.unsubscribe())}_remove(e){this.channels=this.channels.filter(t=>t.topic!==e.topic)}setupConnection(){this.conn&&(this.conn.binaryType="arraybuffer",this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=e=>this._onConnError(e),this.conn.onmessage=e=>this._onConnMessage(e),this.conn.onclose=e=>this._onConnClose(e))}_onConnMessage(e){this.decode(e.data,t=>{let{topic:a,event:i,payload:n,ref:o}=t;a==="phoenix"&&i==="phx_reply"&&this.heartbeatCallback(t.payload.status=="ok"?"ok":"error"),o&&o===this.pendingHeartbeatRef&&(this.pendingHeartbeatRef=null),this.log("receive",`${n.status||""} ${a} ${i} ${o&&"("+o+")"||""}`,n),Array.from(this.channels).filter(l=>l._isMember(a)).forEach(l=>l._trigger(i,n,o)),this.stateChangeCallbacks.message.forEach(l=>l(t))})}_onConnOpen(){this.log("transport",`connected to ${this.endpointURL()}`),this.flushSendBuffer(),this.reconnectTimer.reset(),this.worker?this.workerRef||this._startWorkerHeartbeat():this._startHeartbeat(),this.stateChangeCallbacks.open.forEach(e=>e())}_startHeartbeat(){this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs)}_startWorkerHeartbeat(){this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const e=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(e),this.workerRef.onerror=t=>{this.log("worker","worker error",t.message),this.workerRef.terminate()},this.workerRef.onmessage=t=>{t.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}_onConnClose(e){this.log("transport","close",e),this._triggerChanError(),this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.reconnectTimer.scheduleTimeout(),this.stateChangeCallbacks.close.forEach(t=>t(e))}_onConnError(e){this.log("transport",`${e}`),this._triggerChanError(),this.stateChangeCallbacks.error.forEach(t=>t(e))}_triggerChanError(){this.channels.forEach(e=>e._trigger(be.error))}_appendParams(e,t){if(Object.keys(t).length===0)return e;const a=e.match(/\?/)?"&":"?",i=new URLSearchParams(t);return`${e}${a}${i}`}_workerObjectUrl(e){let t;if(e)t=e;else{const a=new Blob([Ll],{type:"application/javascript"});t=URL.createObjectURL(a)}return t}}class Wr extends Error{constructor(e){super(e),this.__isStorageError=!0,this.name="StorageError"}}function J(r){return typeof r=="object"&&r!==null&&"__isStorageError"in r}class Ul extends Wr{constructor(e,t,a){super(e),this.name="StorageApiError",this.status=t,this.statusCode=a}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}}class jr extends Wr{constructor(e,t){super(e),this.name="StorageUnknownError",this.originalError=t}}var Fl=function(r,e,t,a){function i(n){return n instanceof t?n:new t(function(o){o(n)})}return new(t||(t=Promise))(function(n,o){function l(u){try{d(a.next(u))}catch(h){o(h)}}function c(u){try{d(a.throw(u))}catch(h){o(h)}}function d(u){u.done?n(u.value):i(u.value).then(l,c)}d((a=a.apply(r,e||[])).next())})};const Xi=r=>{let e;return r?e=r:typeof fetch>"u"?e=(...t)=>Ht(async()=>{const{default:a}=await Promise.resolve().then(()=>Qt);return{default:a}},void 0,import.meta.url).then(({default:a})=>a(...t)):e=fetch,(...t)=>e(...t)},zl=()=>Fl(void 0,void 0,void 0,function*(){return typeof Response>"u"?(yield Ht(()=>Promise.resolve().then(()=>Qt),void 0,import.meta.url)).Response:Response}),_r=r=>{if(Array.isArray(r))return r.map(t=>_r(t));if(typeof r=="function"||r!==Object(r))return r;const e={};return Object.entries(r).forEach(([t,a])=>{const i=t.replace(/([-_][a-z])/gi,n=>n.toUpperCase().replace(/[-_]/g,""));e[i]=_r(a)}),e},Bl=r=>{if(typeof r!="object"||r===null)return!1;const e=Object.getPrototypeOf(r);return(e===null||e===Object.prototype||Object.getPrototypeOf(e)===null)&&!(Symbol.toStringTag in r)&&!(Symbol.iterator in r)};var xt=function(r,e,t,a){function i(n){return n instanceof t?n:new t(function(o){o(n)})}return new(t||(t=Promise))(function(n,o){function l(u){try{d(a.next(u))}catch(h){o(h)}}function c(u){try{d(a.throw(u))}catch(h){o(h)}}function d(u){u.done?n(u.value):i(u.value).then(l,c)}d((a=a.apply(r,e||[])).next())})};const Ks=r=>r.msg||r.message||r.error_description||r.error||JSON.stringify(r),ql=(r,e,t)=>xt(void 0,void 0,void 0,function*(){const a=yield zl();r instanceof a&&!(t!=null&&t.noResolveJson)?r.json().then(i=>{const n=r.status||500,o=(i==null?void 0:i.statusCode)||n+"";e(new Ul(Ks(i),n,o))}).catch(i=>{e(new jr(Ks(i),i))}):e(new jr(Ks(r),r))}),Wl=(r,e,t,a)=>{const i={method:r,headers:(e==null?void 0:e.headers)||{}};return r==="GET"||!a?i:(Bl(a)?(i.headers=Object.assign({"Content-Type":"application/json"},e==null?void 0:e.headers),i.body=JSON.stringify(a)):i.body=a,Object.assign(Object.assign({},i),t))};function ms(r,e,t,a,i,n){return xt(this,void 0,void 0,function*(){return new Promise((o,l)=>{r(t,Wl(e,a,i,n)).then(c=>{if(!c.ok)throw c;return a!=null&&a.noResolveJson?c:c.json()}).then(c=>o(c)).catch(c=>ql(c,l,a))})})}function Ss(r,e,t,a){return xt(this,void 0,void 0,function*(){return ms(r,"GET",e,t,a)})}function Re(r,e,t,a,i){return xt(this,void 0,void 0,function*(){return ms(r,"POST",e,a,i,t)})}function Nr(r,e,t,a,i){return xt(this,void 0,void 0,function*(){return ms(r,"PUT",e,a,i,t)})}function Gl(r,e,t,a){return xt(this,void 0,void 0,function*(){return ms(r,"HEAD",e,Object.assign(Object.assign({},t),{noResolveJson:!0}),a)})}function en(r,e,t,a,i){return xt(this,void 0,void 0,function*(){return ms(r,"DELETE",e,a,i,t)})}var ae=function(r,e,t,a){function i(n){return n instanceof t?n:new t(function(o){o(n)})}return new(t||(t=Promise))(function(n,o){function l(u){try{d(a.next(u))}catch(h){o(h)}}function c(u){try{d(a.throw(u))}catch(h){o(h)}}function d(u){u.done?n(u.value):i(u.value).then(l,c)}d((a=a.apply(r,e||[])).next())})};const Kl={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},Ca={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};class Vl{constructor(e,t={},a,i){this.url=e,this.headers=t,this.bucketId=a,this.fetch=Xi(i)}uploadOrUpdate(e,t,a,i){return ae(this,void 0,void 0,function*(){try{let n;const o=Object.assign(Object.assign({},Ca),i);let l=Object.assign(Object.assign({},this.headers),e==="POST"&&{"x-upsert":String(o.upsert)});const c=o.metadata;typeof Blob<"u"&&a instanceof Blob?(n=new FormData,n.append("cacheControl",o.cacheControl),c&&n.append("metadata",this.encodeMetadata(c)),n.append("",a)):typeof FormData<"u"&&a instanceof FormData?(n=a,n.append("cacheControl",o.cacheControl),c&&n.append("metadata",this.encodeMetadata(c))):(n=a,l["cache-control"]=`max-age=${o.cacheControl}`,l["content-type"]=o.contentType,c&&(l["x-metadata"]=this.toBase64(this.encodeMetadata(c)))),i!=null&&i.headers&&(l=Object.assign(Object.assign({},l),i.headers));const d=this._removeEmptyFolders(t),u=this._getFinalPath(d),h=yield(e=="PUT"?Nr:Re)(this.fetch,`${this.url}/object/${u}`,n,Object.assign({headers:l},o!=null&&o.duplex?{duplex:o.duplex}:{}));return{data:{path:d,id:h.Id,fullPath:h.Key},error:null}}catch(n){if(J(n))return{data:null,error:n};throw n}})}upload(e,t,a){return ae(this,void 0,void 0,function*(){return this.uploadOrUpdate("POST",e,t,a)})}uploadToSignedUrl(e,t,a,i){return ae(this,void 0,void 0,function*(){const n=this._removeEmptyFolders(e),o=this._getFinalPath(n),l=new URL(this.url+`/object/upload/sign/${o}`);l.searchParams.set("token",t);try{let c;const d=Object.assign({upsert:Ca.upsert},i),u=Object.assign(Object.assign({},this.headers),{"x-upsert":String(d.upsert)});typeof Blob<"u"&&a instanceof Blob?(c=new FormData,c.append("cacheControl",d.cacheControl),c.append("",a)):typeof FormData<"u"&&a instanceof FormData?(c=a,c.append("cacheControl",d.cacheControl)):(c=a,u["cache-control"]=`max-age=${d.cacheControl}`,u["content-type"]=d.contentType);const h=yield Nr(this.fetch,l.toString(),c,{headers:u});return{data:{path:n,fullPath:h.Key},error:null}}catch(c){if(J(c))return{data:null,error:c};throw c}})}createSignedUploadUrl(e,t){return ae(this,void 0,void 0,function*(){try{let a=this._getFinalPath(e);const i=Object.assign({},this.headers);t!=null&&t.upsert&&(i["x-upsert"]="true");const n=yield Re(this.fetch,`${this.url}/object/upload/sign/${a}`,{},{headers:i}),o=new URL(this.url+n.url),l=o.searchParams.get("token");if(!l)throw new Wr("No token returned by API");return{data:{signedUrl:o.toString(),path:e,token:l},error:null}}catch(a){if(J(a))return{data:null,error:a};throw a}})}update(e,t,a){return ae(this,void 0,void 0,function*(){return this.uploadOrUpdate("PUT",e,t,a)})}move(e,t,a){return ae(this,void 0,void 0,function*(){try{return{data:yield Re(this.fetch,`${this.url}/object/move`,{bucketId:this.bucketId,sourceKey:e,destinationKey:t,destinationBucket:a==null?void 0:a.destinationBucket},{headers:this.headers}),error:null}}catch(i){if(J(i))return{data:null,error:i};throw i}})}copy(e,t,a){return ae(this,void 0,void 0,function*(){try{return{data:{path:(yield Re(this.fetch,`${this.url}/object/copy`,{bucketId:this.bucketId,sourceKey:e,destinationKey:t,destinationBucket:a==null?void 0:a.destinationBucket},{headers:this.headers})).Key},error:null}}catch(i){if(J(i))return{data:null,error:i};throw i}})}createSignedUrl(e,t,a){return ae(this,void 0,void 0,function*(){try{let i=this._getFinalPath(e),n=yield Re(this.fetch,`${this.url}/object/sign/${i}`,Object.assign({expiresIn:t},a!=null&&a.transform?{transform:a.transform}:{}),{headers:this.headers});const o=a!=null&&a.download?`&download=${a.download===!0?"":a.download}`:"";return n={signedUrl:encodeURI(`${this.url}${n.signedURL}${o}`)},{data:n,error:null}}catch(i){if(J(i))return{data:null,error:i};throw i}})}createSignedUrls(e,t,a){return ae(this,void 0,void 0,function*(){try{const i=yield Re(this.fetch,`${this.url}/object/sign/${this.bucketId}`,{expiresIn:t,paths:e},{headers:this.headers}),n=a!=null&&a.download?`&download=${a.download===!0?"":a.download}`:"";return{data:i.map(o=>Object.assign(Object.assign({},o),{signedUrl:o.signedURL?encodeURI(`${this.url}${o.signedURL}${n}`):null})),error:null}}catch(i){if(J(i))return{data:null,error:i};throw i}})}download(e,t){return ae(this,void 0,void 0,function*(){const i=typeof(t==null?void 0:t.transform)<"u"?"render/image/authenticated":"object",n=this.transformOptsToQueryString((t==null?void 0:t.transform)||{}),o=n?`?${n}`:"";try{const l=this._getFinalPath(e);return{data:yield(yield Ss(this.fetch,`${this.url}/${i}/${l}${o}`,{headers:this.headers,noResolveJson:!0})).blob(),error:null}}catch(l){if(J(l))return{data:null,error:l};throw l}})}info(e){return ae(this,void 0,void 0,function*(){const t=this._getFinalPath(e);try{const a=yield Ss(this.fetch,`${this.url}/object/info/${t}`,{headers:this.headers});return{data:_r(a),error:null}}catch(a){if(J(a))return{data:null,error:a};throw a}})}exists(e){return ae(this,void 0,void 0,function*(){const t=this._getFinalPath(e);try{return yield Gl(this.fetch,`${this.url}/object/${t}`,{headers:this.headers}),{data:!0,error:null}}catch(a){if(J(a)&&a instanceof jr){const i=a.originalError;if([400,404].includes(i==null?void 0:i.status))return{data:!1,error:a}}throw a}})}getPublicUrl(e,t){const a=this._getFinalPath(e),i=[],n=t!=null&&t.download?`download=${t.download===!0?"":t.download}`:"";n!==""&&i.push(n);const l=typeof(t==null?void 0:t.transform)<"u"?"render/image":"object",c=this.transformOptsToQueryString((t==null?void 0:t.transform)||{});c!==""&&i.push(c);let d=i.join("&");return d!==""&&(d=`?${d}`),{data:{publicUrl:encodeURI(`${this.url}/${l}/public/${a}${d}`)}}}remove(e){return ae(this,void 0,void 0,function*(){try{return{data:yield en(this.fetch,`${this.url}/object/${this.bucketId}`,{prefixes:e},{headers:this.headers}),error:null}}catch(t){if(J(t))return{data:null,error:t};throw t}})}list(e,t,a){return ae(this,void 0,void 0,function*(){try{const i=Object.assign(Object.assign(Object.assign({},Kl),t),{prefix:e||""});return{data:yield Re(this.fetch,`${this.url}/object/list/${this.bucketId}`,i,{headers:this.headers},a),error:null}}catch(i){if(J(i))return{data:null,error:i};throw i}})}encodeMetadata(e){return JSON.stringify(e)}toBase64(e){return typeof Buffer<"u"?Buffer.from(e).toString("base64"):btoa(e)}_getFinalPath(e){return`${this.bucketId}/${e.replace(/^\/+/,"")}`}_removeEmptyFolders(e){return e.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(e){const t=[];return e.width&&t.push(`width=${e.width}`),e.height&&t.push(`height=${e.height}`),e.resize&&t.push(`resize=${e.resize}`),e.format&&t.push(`format=${e.format}`),e.quality&&t.push(`quality=${e.quality}`),t.join("&")}}const Hl="2.10.4",Ql={"X-Client-Info":`storage-js/${Hl}`};var yt=function(r,e,t,a){function i(n){return n instanceof t?n:new t(function(o){o(n)})}return new(t||(t=Promise))(function(n,o){function l(u){try{d(a.next(u))}catch(h){o(h)}}function c(u){try{d(a.throw(u))}catch(h){o(h)}}function d(u){u.done?n(u.value):i(u.value).then(l,c)}d((a=a.apply(r,e||[])).next())})};class Jl{constructor(e,t={},a,i){const n=new URL(e);i!=null&&i.useNewHostname&&/supabase\.(co|in|red)$/.test(n.hostname)&&!n.hostname.includes("storage.supabase.")&&(n.hostname=n.hostname.replace("supabase.","storage.supabase.")),this.url=n.href,this.headers=Object.assign(Object.assign({},Ql),t),this.fetch=Xi(a)}listBuckets(){return yt(this,void 0,void 0,function*(){try{return{data:yield Ss(this.fetch,`${this.url}/bucket`,{headers:this.headers}),error:null}}catch(e){if(J(e))return{data:null,error:e};throw e}})}getBucket(e){return yt(this,void 0,void 0,function*(){try{return{data:yield Ss(this.fetch,`${this.url}/bucket/${e}`,{headers:this.headers}),error:null}}catch(t){if(J(t))return{data:null,error:t};throw t}})}createBucket(e,t={public:!1}){return yt(this,void 0,void 0,function*(){try{return{data:yield Re(this.fetch,`${this.url}/bucket`,{id:e,name:e,type:t.type,public:t.public,file_size_limit:t.fileSizeLimit,allowed_mime_types:t.allowedMimeTypes},{headers:this.headers}),error:null}}catch(a){if(J(a))return{data:null,error:a};throw a}})}updateBucket(e,t){return yt(this,void 0,void 0,function*(){try{return{data:yield Nr(this.fetch,`${this.url}/bucket/${e}`,{id:e,name:e,public:t.public,file_size_limit:t.fileSizeLimit,allowed_mime_types:t.allowedMimeTypes},{headers:this.headers}),error:null}}catch(a){if(J(a))return{data:null,error:a};throw a}})}emptyBucket(e){return yt(this,void 0,void 0,function*(){try{return{data:yield Re(this.fetch,`${this.url}/bucket/${e}/empty`,{},{headers:this.headers}),error:null}}catch(t){if(J(t))return{data:null,error:t};throw t}})}deleteBucket(e){return yt(this,void 0,void 0,function*(){try{return{data:yield en(this.fetch,`${this.url}/bucket/${e}`,{},{headers:this.headers}),error:null}}catch(t){if(J(t))return{data:null,error:t};throw t}})}}class Yl extends Jl{constructor(e,t={},a,i){super(e,t,a,i)}from(e){return new Vl(this.url,this.headers,e,this.fetch)}}const Zl="2.53.0";let Xt="";typeof Deno<"u"?Xt="deno":typeof document<"u"?Xt="web":typeof navigator<"u"&&navigator.product==="ReactNative"?Xt="react-native":Xt="node";const Xl={"X-Client-Info":`supabase-js-${Xt}/${Zl}`},ec={headers:Xl},tc={schema:"public"},sc={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},rc={};var ac=function(r,e,t,a){function i(n){return n instanceof t?n:new t(function(o){o(n)})}return new(t||(t=Promise))(function(n,o){function l(u){try{d(a.next(u))}catch(h){o(h)}}function c(u){try{d(a.throw(u))}catch(h){o(h)}}function d(u){u.done?n(u.value):i(u.value).then(l,c)}d((a=a.apply(r,e||[])).next())})};const ic=r=>{let e;return r?e=r:typeof fetch>"u"?e=Di:e=fetch,(...t)=>e(...t)},nc=()=>typeof Headers>"u"?Ui:Headers,oc=(r,e,t)=>{const a=ic(t),i=nc();return(n,o)=>ac(void 0,void 0,void 0,function*(){var l;const c=(l=yield e())!==null&&l!==void 0?l:r;let d=new i(o==null?void 0:o.headers);return d.has("apikey")||d.set("apikey",r),d.has("Authorization")||d.set("Authorization",`Bearer ${c}`),a(n,Object.assign(Object.assign({},o),{headers:d}))})};var lc=function(r,e,t,a){function i(n){return n instanceof t?n:new t(function(o){o(n)})}return new(t||(t=Promise))(function(n,o){function l(u){try{d(a.next(u))}catch(h){o(h)}}function c(u){try{d(a.throw(u))}catch(h){o(h)}}function d(u){u.done?n(u.value):i(u.value).then(l,c)}d((a=a.apply(r,e||[])).next())})};function cc(r){return r.endsWith("/")?r:r+"/"}function dc(r,e){var t,a;const{db:i,auth:n,realtime:o,global:l}=r,{db:c,auth:d,realtime:u,global:h}=e,g={db:Object.assign(Object.assign({},c),i),auth:Object.assign(Object.assign({},d),n),realtime:Object.assign(Object.assign({},u),o),storage:{},global:Object.assign(Object.assign(Object.assign({},h),l),{headers:Object.assign(Object.assign({},(t=h==null?void 0:h.headers)!==null&&t!==void 0?t:{}),(a=l==null?void 0:l.headers)!==null&&a!==void 0?a:{})}),accessToken:()=>lc(this,void 0,void 0,function*(){return""})};return r.accessToken?g.accessToken=r.accessToken:delete g.accessToken,g}const tn="2.71.1",Nt=30*1e3,kr=3,Vs=kr*Nt,uc="http://localhost:9999",hc="supabase.auth.token",mc={"X-Client-Info":`gotrue-js/${tn}`},Sr="X-Supabase-Api-Version",sn={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}},gc=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i,fc=10*60*1e3;class Gr extends Error{constructor(e,t,a){super(e),this.__isAuthError=!0,this.name="AuthError",this.status=t,this.code=a}}function R(r){return typeof r=="object"&&r!==null&&"__isAuthError"in r}class pc extends Gr{constructor(e,t,a){super(e,t,a),this.name="AuthApiError",this.status=t,this.code=a}}function xc(r){return R(r)&&r.name==="AuthApiError"}class rn extends Gr{constructor(e,t){super(e),this.name="AuthUnknownError",this.originalError=t}}class Xe extends Gr{constructor(e,t,a,i){super(e,a,i),this.name=t,this.status=a}}class Fe extends Xe{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function yc(r){return R(r)&&r.name==="AuthSessionMissingError"}class xs extends Xe{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class ys extends Xe{constructor(e){super(e,"AuthInvalidCredentialsError",400,void 0)}}class bs extends Xe{constructor(e,t=null){super(e,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=t}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}function bc(r){return R(r)&&r.name==="AuthImplicitGrantRedirectError"}class Ea extends Xe{constructor(e,t=null){super(e,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=t}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class Cr extends Xe{constructor(e,t){super(e,"AuthRetryableFetchError",t,void 0)}}function Hs(r){return R(r)&&r.name==="AuthRetryableFetchError"}class Ta extends Xe{constructor(e,t,a){super(e,"AuthWeakPasswordError",t,"weak_password"),this.reasons=a}}class Er extends Xe{constructor(e){super(e,"AuthInvalidJwtError",400,"invalid_jwt")}}const Cs="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),Pa=` 	
\r=`.split(""),vc=(()=>{const r=new Array(128);for(let e=0;e<r.length;e+=1)r[e]=-1;for(let e=0;e<Pa.length;e+=1)r[Pa[e].charCodeAt(0)]=-2;for(let e=0;e<Cs.length;e+=1)r[Cs[e].charCodeAt(0)]=e;return r})();function Ia(r,e,t){if(r!==null)for(e.queue=e.queue<<8|r,e.queuedBits+=8;e.queuedBits>=6;){const a=e.queue>>e.queuedBits-6&63;t(Cs[a]),e.queuedBits-=6}else if(e.queuedBits>0)for(e.queue=e.queue<<6-e.queuedBits,e.queuedBits=6;e.queuedBits>=6;){const a=e.queue>>e.queuedBits-6&63;t(Cs[a]),e.queuedBits-=6}}function an(r,e,t){const a=vc[r];if(a>-1)for(e.queue=e.queue<<6|a,e.queuedBits+=6;e.queuedBits>=8;)t(e.queue>>e.queuedBits-8&255),e.queuedBits-=8;else{if(a===-2)return;throw new Error(`Invalid Base64-URL character "${String.fromCharCode(r)}"`)}}function Aa(r){const e=[],t=o=>{e.push(String.fromCodePoint(o))},a={utf8seq:0,codepoint:0},i={queue:0,queuedBits:0},n=o=>{_c(o,a,t)};for(let o=0;o<r.length;o+=1)an(r.charCodeAt(o),i,n);return e.join("")}function wc(r,e){if(r<=127){e(r);return}else if(r<=2047){e(192|r>>6),e(128|r&63);return}else if(r<=65535){e(224|r>>12),e(128|r>>6&63),e(128|r&63);return}else if(r<=1114111){e(240|r>>18),e(128|r>>12&63),e(128|r>>6&63),e(128|r&63);return}throw new Error(`Unrecognized Unicode codepoint: ${r.toString(16)}`)}function jc(r,e){for(let t=0;t<r.length;t+=1){let a=r.charCodeAt(t);if(a>55295&&a<=56319){const i=(a-55296)*1024&65535;a=(r.charCodeAt(t+1)-56320&65535|i)+65536,t+=1}wc(a,e)}}function _c(r,e,t){if(e.utf8seq===0){if(r<=127){t(r);return}for(let a=1;a<6;a+=1)if(!(r>>7-a&1)){e.utf8seq=a;break}if(e.utf8seq===2)e.codepoint=r&31;else if(e.utf8seq===3)e.codepoint=r&15;else if(e.utf8seq===4)e.codepoint=r&7;else throw new Error("Invalid UTF-8 sequence");e.utf8seq-=1}else if(e.utf8seq>0){if(r<=127)throw new Error("Invalid UTF-8 sequence");e.codepoint=e.codepoint<<6|r&63,e.utf8seq-=1,e.utf8seq===0&&t(e.codepoint)}}function Nc(r){const e=[],t={queue:0,queuedBits:0},a=i=>{e.push(i)};for(let i=0;i<r.length;i+=1)an(r.charCodeAt(i),t,a);return new Uint8Array(e)}function kc(r){const e=[];return jc(r,t=>e.push(t)),new Uint8Array(e)}function Sc(r){const e=[],t={queue:0,queuedBits:0},a=i=>{e.push(i)};return r.forEach(i=>Ia(i,t,a)),Ia(null,t,a),e.join("")}function Cc(r){return Math.round(Date.now()/1e3)+r}function Ec(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(r){const e=Math.random()*16|0;return(r=="x"?e:e&3|8).toString(16)})}const xe=()=>typeof window<"u"&&typeof document<"u",et={tested:!1,writable:!1},nn=()=>{if(!xe())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(et.tested)return et.writable;const r=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(r,r),globalThis.localStorage.removeItem(r),et.tested=!0,et.writable=!0}catch{et.tested=!0,et.writable=!1}return et.writable};function Tc(r){const e={},t=new URL(r);if(t.hash&&t.hash[0]==="#")try{new URLSearchParams(t.hash.substring(1)).forEach((i,n)=>{e[n]=i})}catch{}return t.searchParams.forEach((a,i)=>{e[i]=a}),e}const on=r=>{let e;return r?e=r:typeof fetch>"u"?e=(...t)=>Ht(async()=>{const{default:a}=await Promise.resolve().then(()=>Qt);return{default:a}},void 0,import.meta.url).then(({default:a})=>a(...t)):e=fetch,(...t)=>e(...t)},Pc=r=>typeof r=="object"&&r!==null&&"status"in r&&"ok"in r&&"json"in r&&typeof r.json=="function",kt=async(r,e,t)=>{await r.setItem(e,JSON.stringify(t))},tt=async(r,e)=>{const t=await r.getItem(e);if(!t)return null;try{return JSON.parse(t)}catch{return t}},De=async(r,e)=>{await r.removeItem(e)};class Ds{constructor(){this.promise=new Ds.promiseConstructor((e,t)=>{this.resolve=e,this.reject=t})}}Ds.promiseConstructor=Promise;function Qs(r){const e=r.split(".");if(e.length!==3)throw new Er("Invalid JWT structure");for(let a=0;a<e.length;a++)if(!gc.test(e[a]))throw new Er("JWT not in base64url format");return{header:JSON.parse(Aa(e[0])),payload:JSON.parse(Aa(e[1])),signature:Nc(e[2]),raw:{header:e[0],payload:e[1]}}}async function Ic(r){return await new Promise(e=>{setTimeout(()=>e(null),r)})}function Ac(r,e){return new Promise((a,i)=>{(async()=>{for(let n=0;n<1/0;n++)try{const o=await r(n);if(!e(n,null,o)){a(o);return}}catch(o){if(!e(n,o)){i(o);return}}})()})}function Oc(r){return("0"+r.toString(16)).substr(-2)}function Rc(){const e=new Uint32Array(56);if(typeof crypto>"u"){const t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",a=t.length;let i="";for(let n=0;n<56;n++)i+=t.charAt(Math.floor(Math.random()*a));return i}return crypto.getRandomValues(e),Array.from(e,Oc).join("")}async function Mc(r){const t=new TextEncoder().encode(r),a=await crypto.subtle.digest("SHA-256",t),i=new Uint8Array(a);return Array.from(i).map(n=>String.fromCharCode(n)).join("")}async function $c(r){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),r;const t=await Mc(r);return btoa(t).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function bt(r,e,t=!1){const a=Rc();let i=a;t&&(i+="/PASSWORD_RECOVERY"),await kt(r,`${e}-code-verifier`,i);const n=await $c(a);return[n,a===n?"plain":"s256"]}const Lc=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function Dc(r){const e=r.headers.get(Sr);if(!e||!e.match(Lc))return null;try{return new Date(`${e}T00:00:00.0Z`)}catch{return null}}function Uc(r){if(!r)throw new Error("Missing exp claim");const e=Math.floor(Date.now()/1e3);if(r<=e)throw new Error("JWT has expired")}function Fc(r){switch(r){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}const zc=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/;function vt(r){if(!zc.test(r))throw new Error("@supabase/auth-js: Expected parameter to be UUID but is not")}function Js(){const r={};return new Proxy(r,{get:(e,t)=>{if(t==="__isUserNotAvailableProxy")return!0;if(typeof t=="symbol"){const a=t.toString();if(a==="Symbol(Symbol.toPrimitive)"||a==="Symbol(Symbol.toStringTag)"||a==="Symbol(util.inspect.custom)")return}throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Accessing the "${t}" property of the session object is not supported. Please use getUser() instead.`)},set:(e,t)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Setting the "${t}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)},deleteProperty:(e,t)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Deleting the "${t}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)}})}function Oa(r){return JSON.parse(JSON.stringify(r))}var Bc=function(r,e){var t={};for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&e.indexOf(a)<0&&(t[a]=r[a]);if(r!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,a=Object.getOwnPropertySymbols(r);i<a.length;i++)e.indexOf(a[i])<0&&Object.prototype.propertyIsEnumerable.call(r,a[i])&&(t[a[i]]=r[a[i]]);return t};const st=r=>r.msg||r.message||r.error_description||r.error||JSON.stringify(r),qc=[502,503,504];async function Ra(r){var e;if(!Pc(r))throw new Cr(st(r),0);if(qc.includes(r.status))throw new Cr(st(r),r.status);let t;try{t=await r.json()}catch(n){throw new rn(st(n),n)}let a;const i=Dc(r);if(i&&i.getTime()>=sn["2024-01-01"].timestamp&&typeof t=="object"&&t&&typeof t.code=="string"?a=t.code:typeof t=="object"&&t&&typeof t.error_code=="string"&&(a=t.error_code),a){if(a==="weak_password")throw new Ta(st(t),r.status,((e=t.weak_password)===null||e===void 0?void 0:e.reasons)||[]);if(a==="session_not_found")throw new Fe}else if(typeof t=="object"&&t&&typeof t.weak_password=="object"&&t.weak_password&&Array.isArray(t.weak_password.reasons)&&t.weak_password.reasons.length&&t.weak_password.reasons.reduce((n,o)=>n&&typeof o=="string",!0))throw new Ta(st(t),r.status,t.weak_password.reasons);throw new pc(st(t),r.status||500,a)}const Wc=(r,e,t,a)=>{const i={method:r,headers:(e==null?void 0:e.headers)||{}};return r==="GET"?i:(i.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},e==null?void 0:e.headers),i.body=JSON.stringify(a),Object.assign(Object.assign({},i),t))};async function $(r,e,t,a){var i;const n=Object.assign({},a==null?void 0:a.headers);n[Sr]||(n[Sr]=sn["2024-01-01"].name),a!=null&&a.jwt&&(n.Authorization=`Bearer ${a.jwt}`);const o=(i=a==null?void 0:a.query)!==null&&i!==void 0?i:{};a!=null&&a.redirectTo&&(o.redirect_to=a.redirectTo);const l=Object.keys(o).length?"?"+new URLSearchParams(o).toString():"",c=await Gc(r,e,t+l,{headers:n,noResolveJson:a==null?void 0:a.noResolveJson},{},a==null?void 0:a.body);return a!=null&&a.xform?a==null?void 0:a.xform(c):{data:Object.assign({},c),error:null}}async function Gc(r,e,t,a,i,n){const o=Wc(e,a,i,n);let l;try{l=await r(t,Object.assign({},o))}catch(c){throw console.error(c),new Cr(st(c),0)}if(l.ok||await Ra(l),a!=null&&a.noResolveJson)return l;try{return await l.json()}catch(c){await Ra(c)}}function Ae(r){var e;let t=null;Qc(r)&&(t=Object.assign({},r),r.expires_at||(t.expires_at=Cc(r.expires_in)));const a=(e=r.user)!==null&&e!==void 0?e:r;return{data:{session:t,user:a},error:null}}function Ma(r){const e=Ae(r);return!e.error&&r.weak_password&&typeof r.weak_password=="object"&&Array.isArray(r.weak_password.reasons)&&r.weak_password.reasons.length&&r.weak_password.message&&typeof r.weak_password.message=="string"&&r.weak_password.reasons.reduce((t,a)=>t&&typeof a=="string",!0)&&(e.data.weak_password=r.weak_password),e}function ze(r){var e;return{data:{user:(e=r.user)!==null&&e!==void 0?e:r},error:null}}function Kc(r){return{data:r,error:null}}function Vc(r){const{action_link:e,email_otp:t,hashed_token:a,redirect_to:i,verification_type:n}=r,o=Bc(r,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),l={action_link:e,email_otp:t,hashed_token:a,redirect_to:i,verification_type:n},c=Object.assign({},o);return{data:{properties:l,user:c},error:null}}function Hc(r){return r}function Qc(r){return r.access_token&&r.refresh_token&&r.expires_in}const Ys=["global","local","others"];var Jc=function(r,e){var t={};for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&e.indexOf(a)<0&&(t[a]=r[a]);if(r!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,a=Object.getOwnPropertySymbols(r);i<a.length;i++)e.indexOf(a[i])<0&&Object.prototype.propertyIsEnumerable.call(r,a[i])&&(t[a[i]]=r[a[i]]);return t};class Yc{constructor({url:e="",headers:t={},fetch:a}){this.url=e,this.headers=t,this.fetch=on(a),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)}}async signOut(e,t=Ys[0]){if(Ys.indexOf(t)<0)throw new Error(`@supabase/auth-js: Parameter scope must be one of ${Ys.join(", ")}`);try{return await $(this.fetch,"POST",`${this.url}/logout?scope=${t}`,{headers:this.headers,jwt:e,noResolveJson:!0}),{data:null,error:null}}catch(a){if(R(a))return{data:null,error:a};throw a}}async inviteUserByEmail(e,t={}){try{return await $(this.fetch,"POST",`${this.url}/invite`,{body:{email:e,data:t.data},headers:this.headers,redirectTo:t.redirectTo,xform:ze})}catch(a){if(R(a))return{data:{user:null},error:a};throw a}}async generateLink(e){try{const{options:t}=e,a=Jc(e,["options"]),i=Object.assign(Object.assign({},a),t);return"newEmail"in a&&(i.new_email=a==null?void 0:a.newEmail,delete i.newEmail),await $(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:i,headers:this.headers,xform:Vc,redirectTo:t==null?void 0:t.redirectTo})}catch(t){if(R(t))return{data:{properties:null,user:null},error:t};throw t}}async createUser(e){try{return await $(this.fetch,"POST",`${this.url}/admin/users`,{body:e,headers:this.headers,xform:ze})}catch(t){if(R(t))return{data:{user:null},error:t};throw t}}async listUsers(e){var t,a,i,n,o,l,c;try{const d={nextPage:null,lastPage:0,total:0},u=await $(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(a=(t=e==null?void 0:e.page)===null||t===void 0?void 0:t.toString())!==null&&a!==void 0?a:"",per_page:(n=(i=e==null?void 0:e.perPage)===null||i===void 0?void 0:i.toString())!==null&&n!==void 0?n:""},xform:Hc});if(u.error)throw u.error;const h=await u.json(),g=(o=u.headers.get("x-total-count"))!==null&&o!==void 0?o:0,f=(c=(l=u.headers.get("link"))===null||l===void 0?void 0:l.split(","))!==null&&c!==void 0?c:[];return f.length>0&&(f.forEach(x=>{const y=parseInt(x.split(";")[0].split("=")[1].substring(0,1)),p=JSON.parse(x.split(";")[1].split("=")[1]);d[`${p}Page`]=y}),d.total=parseInt(g)),{data:Object.assign(Object.assign({},h),d),error:null}}catch(d){if(R(d))return{data:{users:[]},error:d};throw d}}async getUserById(e){vt(e);try{return await $(this.fetch,"GET",`${this.url}/admin/users/${e}`,{headers:this.headers,xform:ze})}catch(t){if(R(t))return{data:{user:null},error:t};throw t}}async updateUserById(e,t){vt(e);try{return await $(this.fetch,"PUT",`${this.url}/admin/users/${e}`,{body:t,headers:this.headers,xform:ze})}catch(a){if(R(a))return{data:{user:null},error:a};throw a}}async deleteUser(e,t=!1){vt(e);try{return await $(this.fetch,"DELETE",`${this.url}/admin/users/${e}`,{headers:this.headers,body:{should_soft_delete:t},xform:ze})}catch(a){if(R(a))return{data:{user:null},error:a};throw a}}async _listFactors(e){vt(e.userId);try{const{data:t,error:a}=await $(this.fetch,"GET",`${this.url}/admin/users/${e.userId}/factors`,{headers:this.headers,xform:i=>({data:{factors:i},error:null})});return{data:t,error:a}}catch(t){if(R(t))return{data:null,error:t};throw t}}async _deleteFactor(e){vt(e.userId),vt(e.id);try{return{data:await $(this.fetch,"DELETE",`${this.url}/admin/users/${e.userId}/factors/${e.id}`,{headers:this.headers}),error:null}}catch(t){if(R(t))return{data:null,error:t};throw t}}}function $a(r={}){return{getItem:e=>r[e]||null,setItem:(e,t)=>{r[e]=t},removeItem:e=>{delete r[e]}}}function Zc(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}const wt={debug:!!(globalThis&&nn()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class ln extends Error{constructor(e){super(e),this.isAcquireTimeout=!0}}class Xc extends ln{}async function ed(r,e,t){wt.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",r,e);const a=new globalThis.AbortController;return e>0&&setTimeout(()=>{a.abort(),wt.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",r)},e),await Promise.resolve().then(()=>globalThis.navigator.locks.request(r,e===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:a.signal},async i=>{if(i){wt.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",r,i.name);try{return await t()}finally{wt.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",r,i.name)}}else{if(e===0)throw wt.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",r),new Xc(`Acquiring an exclusive Navigator LockManager lock "${r}" immediately failed`);if(wt.debug)try{const n=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(n,null,"  "))}catch(n){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",n)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await t()}}))}Zc();const td={url:uc,storageKey:hc,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:mc,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1};async function La(r,e,t){return await t()}const jt={};class ns{constructor(e){var t,a;this.userStorage=null,this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log,this.instanceID=ns.nextInstanceID,ns.nextInstanceID+=1,this.instanceID>0&&xe()&&console.warn("Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.");const i=Object.assign(Object.assign({},td),e);if(this.logDebugMessages=!!i.debug,typeof i.debug=="function"&&(this.logger=i.debug),this.persistSession=i.persistSession,this.storageKey=i.storageKey,this.autoRefreshToken=i.autoRefreshToken,this.admin=new Yc({url:i.url,headers:i.headers,fetch:i.fetch}),this.url=i.url,this.headers=i.headers,this.fetch=on(i.fetch),this.lock=i.lock||La,this.detectSessionInUrl=i.detectSessionInUrl,this.flowType=i.flowType,this.hasCustomAuthorizationHeader=i.hasCustomAuthorizationHeader,i.lock?this.lock=i.lock:xe()&&(!((t=globalThis==null?void 0:globalThis.navigator)===null||t===void 0)&&t.locks)?this.lock=ed:this.lock=La,this.jwks||(this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER),this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this)},this.persistSession?(i.storage?this.storage=i.storage:nn()?this.storage=globalThis.localStorage:(this.memoryStorage={},this.storage=$a(this.memoryStorage)),i.userStorage&&(this.userStorage=i.userStorage)):(this.memoryStorage={},this.storage=$a(this.memoryStorage)),xe()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(n){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",n)}(a=this.broadcastChannel)===null||a===void 0||a.addEventListener("message",async n=>{this._debug("received broadcast notification from other tab or client",n),await this._notifyAllSubscribers(n.data.event,n.data.session,!1)})}this.initialize()}get jwks(){var e,t;return(t=(e=jt[this.storageKey])===null||e===void 0?void 0:e.jwks)!==null&&t!==void 0?t:{keys:[]}}set jwks(e){jt[this.storageKey]=Object.assign(Object.assign({},jt[this.storageKey]),{jwks:e})}get jwks_cached_at(){var e,t;return(t=(e=jt[this.storageKey])===null||e===void 0?void 0:e.cachedAt)!==null&&t!==void 0?t:Number.MIN_SAFE_INTEGER}set jwks_cached_at(e){jt[this.storageKey]=Object.assign(Object.assign({},jt[this.storageKey]),{cachedAt:e})}_debug(...e){return this.logDebugMessages&&this.logger(`GoTrueClient@${this.instanceID} (${tn}) ${new Date().toISOString()}`,...e),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(-1,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){var e;try{const t=Tc(window.location.href);let a="none";if(this._isImplicitGrantCallback(t)?a="implicit":await this._isPKCECallback(t)&&(a="pkce"),xe()&&this.detectSessionInUrl&&a!=="none"){const{data:i,error:n}=await this._getSessionFromURL(t,a);if(n){if(this._debug("#_initialize()","error detecting session from URL",n),bc(n)){const c=(e=n.details)===null||e===void 0?void 0:e.code;if(c==="identity_already_exists"||c==="identity_not_found"||c==="single_identity_not_deletable")return{error:n}}return await this._removeSession(),{error:n}}const{session:o,redirectType:l}=i;return this._debug("#_initialize()","detected session in URL",o,"redirect type",l),await this._saveSession(o),setTimeout(async()=>{l==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",o):await this._notifyAllSubscribers("SIGNED_IN",o)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(t){return R(t)?{error:t}:{error:new rn("Unexpected error during initialization",t)}}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(e){var t,a,i;try{const n=await $(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(a=(t=e==null?void 0:e.options)===null||t===void 0?void 0:t.data)!==null&&a!==void 0?a:{},gotrue_meta_security:{captcha_token:(i=e==null?void 0:e.options)===null||i===void 0?void 0:i.captchaToken}},xform:Ae}),{data:o,error:l}=n;if(l||!o)return{data:{user:null,session:null},error:l};const c=o.session,d=o.user;return o.session&&(await this._saveSession(o.session),await this._notifyAllSubscribers("SIGNED_IN",c)),{data:{user:d,session:c},error:null}}catch(n){if(R(n))return{data:{user:null,session:null},error:n};throw n}}async signUp(e){var t,a,i;try{let n;if("email"in e){const{email:u,password:h,options:g}=e;let f=null,x=null;this.flowType==="pkce"&&([f,x]=await bt(this.storage,this.storageKey)),n=await $(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:g==null?void 0:g.emailRedirectTo,body:{email:u,password:h,data:(t=g==null?void 0:g.data)!==null&&t!==void 0?t:{},gotrue_meta_security:{captcha_token:g==null?void 0:g.captchaToken},code_challenge:f,code_challenge_method:x},xform:Ae})}else if("phone"in e){const{phone:u,password:h,options:g}=e;n=await $(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:u,password:h,data:(a=g==null?void 0:g.data)!==null&&a!==void 0?a:{},channel:(i=g==null?void 0:g.channel)!==null&&i!==void 0?i:"sms",gotrue_meta_security:{captcha_token:g==null?void 0:g.captchaToken}},xform:Ae})}else throw new ys("You must provide either an email or phone number and a password");const{data:o,error:l}=n;if(l||!o)return{data:{user:null,session:null},error:l};const c=o.session,d=o.user;return o.session&&(await this._saveSession(o.session),await this._notifyAllSubscribers("SIGNED_IN",c)),{data:{user:d,session:c},error:null}}catch(n){if(R(n))return{data:{user:null,session:null},error:n};throw n}}async signInWithPassword(e){try{let t;if("email"in e){const{email:n,password:o,options:l}=e;t=await $(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:n,password:o,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken}},xform:Ma})}else if("phone"in e){const{phone:n,password:o,options:l}=e;t=await $(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:n,password:o,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken}},xform:Ma})}else throw new ys("You must provide either an email or phone number and a password");const{data:a,error:i}=t;return i?{data:{user:null,session:null},error:i}:!a||!a.session||!a.user?{data:{user:null,session:null},error:new xs}:(a.session&&(await this._saveSession(a.session),await this._notifyAllSubscribers("SIGNED_IN",a.session)),{data:Object.assign({user:a.user,session:a.session},a.weak_password?{weakPassword:a.weak_password}:null),error:i})}catch(t){if(R(t))return{data:{user:null,session:null},error:t};throw t}}async signInWithOAuth(e){var t,a,i,n;return await this._handleProviderSignIn(e.provider,{redirectTo:(t=e.options)===null||t===void 0?void 0:t.redirectTo,scopes:(a=e.options)===null||a===void 0?void 0:a.scopes,queryParams:(i=e.options)===null||i===void 0?void 0:i.queryParams,skipBrowserRedirect:(n=e.options)===null||n===void 0?void 0:n.skipBrowserRedirect})}async exchangeCodeForSession(e){return await this.initializePromise,this._acquireLock(-1,async()=>this._exchangeCodeForSession(e))}async signInWithWeb3(e){const{chain:t}=e;if(t==="solana")return await this.signInWithSolana(e);throw new Error(`@supabase/auth-js: Unsupported chain "${t}"`)}async signInWithSolana(e){var t,a,i,n,o,l,c,d,u,h,g,f;let x,y;if("message"in e)x=e.message,y=e.signature;else{const{chain:p,wallet:w,statement:T,options:v}=e;let C;if(xe())if(typeof w=="object")C=w;else{const _=window;if("solana"in _&&typeof _.solana=="object"&&("signIn"in _.solana&&typeof _.solana.signIn=="function"||"signMessage"in _.solana&&typeof _.solana.signMessage=="function"))C=_.solana;else throw new Error("@supabase/auth-js: No compatible Solana wallet interface on the window object (window.solana) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'solana', wallet: resolvedUserWallet }) instead.")}else{if(typeof w!="object"||!(v!=null&&v.url))throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");C=w}const N=new URL((t=v==null?void 0:v.url)!==null&&t!==void 0?t:window.location.href);if("signIn"in C&&C.signIn){const _=await C.signIn(Object.assign(Object.assign(Object.assign({issuedAt:new Date().toISOString()},v==null?void 0:v.signInWithSolana),{version:"1",domain:N.host,uri:N.href}),T?{statement:T}:null));let k;if(Array.isArray(_)&&_[0]&&typeof _[0]=="object")k=_[0];else if(_&&typeof _=="object"&&"signedMessage"in _&&"signature"in _)k=_;else throw new Error("@supabase/auth-js: Wallet method signIn() returned unrecognized value");if("signedMessage"in k&&"signature"in k&&(typeof k.signedMessage=="string"||k.signedMessage instanceof Uint8Array)&&k.signature instanceof Uint8Array)x=typeof k.signedMessage=="string"?k.signedMessage:new TextDecoder().decode(k.signedMessage),y=k.signature;else throw new Error("@supabase/auth-js: Wallet method signIn() API returned object without signedMessage and signature fields")}else{if(!("signMessage"in C)||typeof C.signMessage!="function"||!("publicKey"in C)||typeof C!="object"||!C.publicKey||!("toBase58"in C.publicKey)||typeof C.publicKey.toBase58!="function")throw new Error("@supabase/auth-js: Wallet does not have a compatible signMessage() and publicKey.toBase58() API");x=[`${N.host} wants you to sign in with your Solana account:`,C.publicKey.toBase58(),...T?["",T,""]:[""],"Version: 1",`URI: ${N.href}`,`Issued At: ${(i=(a=v==null?void 0:v.signInWithSolana)===null||a===void 0?void 0:a.issuedAt)!==null&&i!==void 0?i:new Date().toISOString()}`,...!((n=v==null?void 0:v.signInWithSolana)===null||n===void 0)&&n.notBefore?[`Not Before: ${v.signInWithSolana.notBefore}`]:[],...!((o=v==null?void 0:v.signInWithSolana)===null||o===void 0)&&o.expirationTime?[`Expiration Time: ${v.signInWithSolana.expirationTime}`]:[],...!((l=v==null?void 0:v.signInWithSolana)===null||l===void 0)&&l.chainId?[`Chain ID: ${v.signInWithSolana.chainId}`]:[],...!((c=v==null?void 0:v.signInWithSolana)===null||c===void 0)&&c.nonce?[`Nonce: ${v.signInWithSolana.nonce}`]:[],...!((d=v==null?void 0:v.signInWithSolana)===null||d===void 0)&&d.requestId?[`Request ID: ${v.signInWithSolana.requestId}`]:[],...!((h=(u=v==null?void 0:v.signInWithSolana)===null||u===void 0?void 0:u.resources)===null||h===void 0)&&h.length?["Resources",...v.signInWithSolana.resources.map(k=>`- ${k}`)]:[]].join(`
`);const _=await C.signMessage(new TextEncoder().encode(x),"utf8");if(!_||!(_ instanceof Uint8Array))throw new Error("@supabase/auth-js: Wallet signMessage() API returned an recognized value");y=_}}try{const{data:p,error:w}=await $(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"solana",message:x,signature:Sc(y)},!((g=e.options)===null||g===void 0)&&g.captchaToken?{gotrue_meta_security:{captcha_token:(f=e.options)===null||f===void 0?void 0:f.captchaToken}}:null),xform:Ae});if(w)throw w;return!p||!p.session||!p.user?{data:{user:null,session:null},error:new xs}:(p.session&&(await this._saveSession(p.session),await this._notifyAllSubscribers("SIGNED_IN",p.session)),{data:Object.assign({},p),error:w})}catch(p){if(R(p))return{data:{user:null,session:null},error:p};throw p}}async _exchangeCodeForSession(e){const t=await tt(this.storage,`${this.storageKey}-code-verifier`),[a,i]=(t??"").split("/");try{const{data:n,error:o}=await $(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:e,code_verifier:a},xform:Ae});if(await De(this.storage,`${this.storageKey}-code-verifier`),o)throw o;return!n||!n.session||!n.user?{data:{user:null,session:null,redirectType:null},error:new xs}:(n.session&&(await this._saveSession(n.session),await this._notifyAllSubscribers("SIGNED_IN",n.session)),{data:Object.assign(Object.assign({},n),{redirectType:i??null}),error:o})}catch(n){if(R(n))return{data:{user:null,session:null,redirectType:null},error:n};throw n}}async signInWithIdToken(e){try{const{options:t,provider:a,token:i,access_token:n,nonce:o}=e,l=await $(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:a,id_token:i,access_token:n,nonce:o,gotrue_meta_security:{captcha_token:t==null?void 0:t.captchaToken}},xform:Ae}),{data:c,error:d}=l;return d?{data:{user:null,session:null},error:d}:!c||!c.session||!c.user?{data:{user:null,session:null},error:new xs}:(c.session&&(await this._saveSession(c.session),await this._notifyAllSubscribers("SIGNED_IN",c.session)),{data:c,error:d})}catch(t){if(R(t))return{data:{user:null,session:null},error:t};throw t}}async signInWithOtp(e){var t,a,i,n,o;try{if("email"in e){const{email:l,options:c}=e;let d=null,u=null;this.flowType==="pkce"&&([d,u]=await bt(this.storage,this.storageKey));const{error:h}=await $(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:l,data:(t=c==null?void 0:c.data)!==null&&t!==void 0?t:{},create_user:(a=c==null?void 0:c.shouldCreateUser)!==null&&a!==void 0?a:!0,gotrue_meta_security:{captcha_token:c==null?void 0:c.captchaToken},code_challenge:d,code_challenge_method:u},redirectTo:c==null?void 0:c.emailRedirectTo});return{data:{user:null,session:null},error:h}}if("phone"in e){const{phone:l,options:c}=e,{data:d,error:u}=await $(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:l,data:(i=c==null?void 0:c.data)!==null&&i!==void 0?i:{},create_user:(n=c==null?void 0:c.shouldCreateUser)!==null&&n!==void 0?n:!0,gotrue_meta_security:{captcha_token:c==null?void 0:c.captchaToken},channel:(o=c==null?void 0:c.channel)!==null&&o!==void 0?o:"sms"}});return{data:{user:null,session:null,messageId:d==null?void 0:d.message_id},error:u}}throw new ys("You must provide either an email or phone number.")}catch(l){if(R(l))return{data:{user:null,session:null},error:l};throw l}}async verifyOtp(e){var t,a;try{let i,n;"options"in e&&(i=(t=e.options)===null||t===void 0?void 0:t.redirectTo,n=(a=e.options)===null||a===void 0?void 0:a.captchaToken);const{data:o,error:l}=await $(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},e),{gotrue_meta_security:{captcha_token:n}}),redirectTo:i,xform:Ae});if(l)throw l;if(!o)throw new Error("An error occurred on token verification.");const c=o.session,d=o.user;return c!=null&&c.access_token&&(await this._saveSession(c),await this._notifyAllSubscribers(e.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",c)),{data:{user:d,session:c},error:null}}catch(i){if(R(i))return{data:{user:null,session:null},error:i};throw i}}async signInWithSSO(e){var t,a,i;try{let n=null,o=null;return this.flowType==="pkce"&&([n,o]=await bt(this.storage,this.storageKey)),await $(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in e?{provider_id:e.providerId}:null),"domain"in e?{domain:e.domain}:null),{redirect_to:(a=(t=e.options)===null||t===void 0?void 0:t.redirectTo)!==null&&a!==void 0?a:void 0}),!((i=e==null?void 0:e.options)===null||i===void 0)&&i.captchaToken?{gotrue_meta_security:{captcha_token:e.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:n,code_challenge_method:o}),headers:this.headers,xform:Kc})}catch(n){if(R(n))return{data:null,error:n};throw n}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async e=>{const{data:{session:t},error:a}=e;if(a)throw a;if(!t)throw new Fe;const{error:i}=await $(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:t.access_token});return{data:{user:null,session:null},error:i}})}catch(e){if(R(e))return{data:{user:null,session:null},error:e};throw e}}async resend(e){try{const t=`${this.url}/resend`;if("email"in e){const{email:a,type:i,options:n}=e,{error:o}=await $(this.fetch,"POST",t,{headers:this.headers,body:{email:a,type:i,gotrue_meta_security:{captcha_token:n==null?void 0:n.captchaToken}},redirectTo:n==null?void 0:n.emailRedirectTo});return{data:{user:null,session:null},error:o}}else if("phone"in e){const{phone:a,type:i,options:n}=e,{data:o,error:l}=await $(this.fetch,"POST",t,{headers:this.headers,body:{phone:a,type:i,gotrue_meta_security:{captcha_token:n==null?void 0:n.captchaToken}}});return{data:{user:null,session:null,messageId:o==null?void 0:o.message_id},error:l}}throw new ys("You must provide either an email or phone number and a type")}catch(t){if(R(t))return{data:{user:null,session:null},error:t};throw t}}async getSession(){return await this.initializePromise,await this._acquireLock(-1,async()=>this._useSession(async t=>t))}async _acquireLock(e,t){this._debug("#_acquireLock","begin",e);try{if(this.lockAcquired){const a=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),i=(async()=>(await a,await t()))();return this.pendingInLock.push((async()=>{try{await i}catch{}})()),i}return await this.lock(`lock:${this.storageKey}`,e,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const a=t();for(this.pendingInLock.push((async()=>{try{await a}catch{}})()),await a;this.pendingInLock.length;){const i=[...this.pendingInLock];await Promise.all(i),this.pendingInLock.splice(0,i.length)}return await a}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(e){this._debug("#_useSession","begin");try{const t=await this.__loadSession();return await e(t)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let e=null;const t=await tt(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",t),t!==null&&(this._isValidSession(t)?e=t:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!e)return{data:{session:null},error:null};const a=e.expires_at?e.expires_at*1e3-Date.now()<Vs:!1;if(this._debug("#__loadSession()",`session has${a?"":" not"} expired`,"expires_at",e.expires_at),!a){if(this.userStorage){const o=await tt(this.userStorage,this.storageKey+"-user");o!=null&&o.user?e.user=o.user:e.user=Js()}if(this.storage.isServer&&e.user){let o=this.suppressGetSessionWarning;e=new Proxy(e,{get:(c,d,u)=>(!o&&d==="user"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),o=!0,this.suppressGetSessionWarning=!0),Reflect.get(c,d,u))})}return{data:{session:e},error:null}}const{session:i,error:n}=await this._callRefreshToken(e.refresh_token);return n?{data:{session:null},error:n}:{data:{session:i},error:null}}finally{this._debug("#__loadSession()","end")}}async getUser(e){return e?await this._getUser(e):(await this.initializePromise,await this._acquireLock(-1,async()=>await this._getUser()))}async _getUser(e){try{return e?await $(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:e,xform:ze}):await this._useSession(async t=>{var a,i,n;const{data:o,error:l}=t;if(l)throw l;return!(!((a=o.session)===null||a===void 0)&&a.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new Fe}:await $(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(n=(i=o.session)===null||i===void 0?void 0:i.access_token)!==null&&n!==void 0?n:void 0,xform:ze})})}catch(t){if(R(t))return yc(t)&&(await this._removeSession(),await De(this.storage,`${this.storageKey}-code-verifier`)),{data:{user:null},error:t};throw t}}async updateUser(e,t={}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._updateUser(e,t))}async _updateUser(e,t={}){try{return await this._useSession(async a=>{const{data:i,error:n}=a;if(n)throw n;if(!i.session)throw new Fe;const o=i.session;let l=null,c=null;this.flowType==="pkce"&&e.email!=null&&([l,c]=await bt(this.storage,this.storageKey));const{data:d,error:u}=await $(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:t==null?void 0:t.emailRedirectTo,body:Object.assign(Object.assign({},e),{code_challenge:l,code_challenge_method:c}),jwt:o.access_token,xform:ze});if(u)throw u;return o.user=d.user,await this._saveSession(o),await this._notifyAllSubscribers("USER_UPDATED",o),{data:{user:o.user},error:null}})}catch(a){if(R(a))return{data:{user:null},error:a};throw a}}async setSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._setSession(e))}async _setSession(e){try{if(!e.access_token||!e.refresh_token)throw new Fe;const t=Date.now()/1e3;let a=t,i=!0,n=null;const{payload:o}=Qs(e.access_token);if(o.exp&&(a=o.exp,i=a<=t),i){const{session:l,error:c}=await this._callRefreshToken(e.refresh_token);if(c)return{data:{user:null,session:null},error:c};if(!l)return{data:{user:null,session:null},error:null};n=l}else{const{data:l,error:c}=await this._getUser(e.access_token);if(c)throw c;n={access_token:e.access_token,refresh_token:e.refresh_token,user:l.user,token_type:"bearer",expires_in:a-t,expires_at:a},await this._saveSession(n),await this._notifyAllSubscribers("SIGNED_IN",n)}return{data:{user:n.user,session:n},error:null}}catch(t){if(R(t))return{data:{session:null,user:null},error:t};throw t}}async refreshSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._refreshSession(e))}async _refreshSession(e){try{return await this._useSession(async t=>{var a;if(!e){const{data:o,error:l}=t;if(l)throw l;e=(a=o.session)!==null&&a!==void 0?a:void 0}if(!(e!=null&&e.refresh_token))throw new Fe;const{session:i,error:n}=await this._callRefreshToken(e.refresh_token);return n?{data:{user:null,session:null},error:n}:i?{data:{user:i.user,session:i},error:null}:{data:{user:null,session:null},error:null}})}catch(t){if(R(t))return{data:{user:null,session:null},error:t};throw t}}async _getSessionFromURL(e,t){try{if(!xe())throw new bs("No browser detected.");if(e.error||e.error_description||e.error_code)throw new bs(e.error_description||"Error in URL with unspecified error_description",{error:e.error||"unspecified_error",code:e.error_code||"unspecified_code"});switch(t){case"implicit":if(this.flowType==="pkce")throw new Ea("Not a valid PKCE flow url.");break;case"pkce":if(this.flowType==="implicit")throw new bs("Not a valid implicit grant flow url.");break;default:}if(t==="pkce"){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!e.code)throw new Ea("No code detected.");const{data:T,error:v}=await this._exchangeCodeForSession(e.code);if(v)throw v;const C=new URL(window.location.href);return C.searchParams.delete("code"),window.history.replaceState(window.history.state,"",C.toString()),{data:{session:T.session,redirectType:null},error:null}}const{provider_token:a,provider_refresh_token:i,access_token:n,refresh_token:o,expires_in:l,expires_at:c,token_type:d}=e;if(!n||!l||!o||!d)throw new bs("No session defined in URL");const u=Math.round(Date.now()/1e3),h=parseInt(l);let g=u+h;c&&(g=parseInt(c));const f=g-u;f*1e3<=Nt&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${f}s, should have been closer to ${h}s`);const x=g-h;u-x>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",x,g,u):u-x<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",x,g,u);const{data:y,error:p}=await this._getUser(n);if(p)throw p;const w={provider_token:a,provider_refresh_token:i,access_token:n,expires_in:h,expires_at:g,refresh_token:o,token_type:d,user:y.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),{data:{session:w,redirectType:e.type},error:null}}catch(a){if(R(a))return{data:{session:null,redirectType:null},error:a};throw a}}_isImplicitGrantCallback(e){return!!(e.access_token||e.error_description)}async _isPKCECallback(e){const t=await tt(this.storage,`${this.storageKey}-code-verifier`);return!!(e.code&&t)}async signOut(e={scope:"global"}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._signOut(e))}async _signOut({scope:e}={scope:"global"}){return await this._useSession(async t=>{var a;const{data:i,error:n}=t;if(n)return{error:n};const o=(a=i.session)===null||a===void 0?void 0:a.access_token;if(o){const{error:l}=await this.admin.signOut(o,e);if(l&&!(xc(l)&&(l.status===404||l.status===401||l.status===403)))return{error:l}}return e!=="others"&&(await this._removeSession(),await De(this.storage,`${this.storageKey}-code-verifier`)),{error:null}})}onAuthStateChange(e){const t=Ec(),a={id:t,callback:e,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",t),this.stateChangeEmitters.delete(t)}};return this._debug("#onAuthStateChange()","registered callback with id",t),this.stateChangeEmitters.set(t,a),(async()=>(await this.initializePromise,await this._acquireLock(-1,async()=>{this._emitInitialSession(t)})))(),{data:{subscription:a}}}async _emitInitialSession(e){return await this._useSession(async t=>{var a,i;try{const{data:{session:n},error:o}=t;if(o)throw o;await((a=this.stateChangeEmitters.get(e))===null||a===void 0?void 0:a.callback("INITIAL_SESSION",n)),this._debug("INITIAL_SESSION","callback id",e,"session",n)}catch(n){await((i=this.stateChangeEmitters.get(e))===null||i===void 0?void 0:i.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",e,"error",n),console.error(n)}})}async resetPasswordForEmail(e,t={}){let a=null,i=null;this.flowType==="pkce"&&([a,i]=await bt(this.storage,this.storageKey,!0));try{return await $(this.fetch,"POST",`${this.url}/recover`,{body:{email:e,code_challenge:a,code_challenge_method:i,gotrue_meta_security:{captcha_token:t.captchaToken}},headers:this.headers,redirectTo:t.redirectTo})}catch(n){if(R(n))return{data:null,error:n};throw n}}async getUserIdentities(){var e;try{const{data:t,error:a}=await this.getUser();if(a)throw a;return{data:{identities:(e=t.user.identities)!==null&&e!==void 0?e:[]},error:null}}catch(t){if(R(t))return{data:null,error:t};throw t}}async linkIdentity(e){var t;try{const{data:a,error:i}=await this._useSession(async n=>{var o,l,c,d,u;const{data:h,error:g}=n;if(g)throw g;const f=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,e.provider,{redirectTo:(o=e.options)===null||o===void 0?void 0:o.redirectTo,scopes:(l=e.options)===null||l===void 0?void 0:l.scopes,queryParams:(c=e.options)===null||c===void 0?void 0:c.queryParams,skipBrowserRedirect:!0});return await $(this.fetch,"GET",f,{headers:this.headers,jwt:(u=(d=h.session)===null||d===void 0?void 0:d.access_token)!==null&&u!==void 0?u:void 0})});if(i)throw i;return xe()&&!(!((t=e.options)===null||t===void 0)&&t.skipBrowserRedirect)&&window.location.assign(a==null?void 0:a.url),{data:{provider:e.provider,url:a==null?void 0:a.url},error:null}}catch(a){if(R(a))return{data:{provider:e.provider,url:null},error:a};throw a}}async unlinkIdentity(e){try{return await this._useSession(async t=>{var a,i;const{data:n,error:o}=t;if(o)throw o;return await $(this.fetch,"DELETE",`${this.url}/user/identities/${e.identity_id}`,{headers:this.headers,jwt:(i=(a=n.session)===null||a===void 0?void 0:a.access_token)!==null&&i!==void 0?i:void 0})})}catch(t){if(R(t))return{data:null,error:t};throw t}}async _refreshAccessToken(e){const t=`#_refreshAccessToken(${e.substring(0,5)}...)`;this._debug(t,"begin");try{const a=Date.now();return await Ac(async i=>(i>0&&await Ic(200*Math.pow(2,i-1)),this._debug(t,"refreshing attempt",i),await $(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:e},headers:this.headers,xform:Ae})),(i,n)=>{const o=200*Math.pow(2,i);return n&&Hs(n)&&Date.now()+o-a<Nt})}catch(a){if(this._debug(t,"error",a),R(a))return{data:{session:null,user:null},error:a};throw a}finally{this._debug(t,"end")}}_isValidSession(e){return typeof e=="object"&&e!==null&&"access_token"in e&&"refresh_token"in e&&"expires_at"in e}async _handleProviderSignIn(e,t){const a=await this._getUrlForProvider(`${this.url}/authorize`,e,{redirectTo:t.redirectTo,scopes:t.scopes,queryParams:t.queryParams});return this._debug("#_handleProviderSignIn()","provider",e,"options",t,"url",a),xe()&&!t.skipBrowserRedirect&&window.location.assign(a),{data:{provider:e,url:a},error:null}}async _recoverAndRefresh(){var e,t;const a="#_recoverAndRefresh()";this._debug(a,"begin");try{const i=await tt(this.storage,this.storageKey);if(i&&this.userStorage){let o=await tt(this.userStorage,this.storageKey+"-user");!this.storage.isServer&&Object.is(this.storage,this.userStorage)&&!o&&(o={user:i.user},await kt(this.userStorage,this.storageKey+"-user",o)),i.user=(e=o==null?void 0:o.user)!==null&&e!==void 0?e:Js()}else if(i&&!i.user&&!i.user){const o=await tt(this.storage,this.storageKey+"-user");o&&(o!=null&&o.user)?(i.user=o.user,await De(this.storage,this.storageKey+"-user"),await kt(this.storage,this.storageKey,i)):i.user=Js()}if(this._debug(a,"session from storage",i),!this._isValidSession(i)){this._debug(a,"session is not valid"),i!==null&&await this._removeSession();return}const n=((t=i.expires_at)!==null&&t!==void 0?t:1/0)*1e3-Date.now()<Vs;if(this._debug(a,`session has${n?"":" not"} expired with margin of ${Vs}s`),n){if(this.autoRefreshToken&&i.refresh_token){const{error:o}=await this._callRefreshToken(i.refresh_token);o&&(console.error(o),Hs(o)||(this._debug(a,"refresh failed with a non-retryable error, removing the session",o),await this._removeSession()))}}else if(i.user&&i.user.__isUserNotAvailableProxy===!0)try{const{data:o,error:l}=await this._getUser(i.access_token);!l&&(o!=null&&o.user)?(i.user=o.user,await this._saveSession(i),await this._notifyAllSubscribers("SIGNED_IN",i)):this._debug(a,"could not get user data, skipping SIGNED_IN notification")}catch(o){console.error("Error getting user data:",o),this._debug(a,"error getting user data, skipping SIGNED_IN notification",o)}else await this._notifyAllSubscribers("SIGNED_IN",i)}catch(i){this._debug(a,"error",i),console.error(i);return}finally{this._debug(a,"end")}}async _callRefreshToken(e){var t,a;if(!e)throw new Fe;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const i=`#_callRefreshToken(${e.substring(0,5)}...)`;this._debug(i,"begin");try{this.refreshingDeferred=new Ds;const{data:n,error:o}=await this._refreshAccessToken(e);if(o)throw o;if(!n.session)throw new Fe;await this._saveSession(n.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",n.session);const l={session:n.session,error:null};return this.refreshingDeferred.resolve(l),l}catch(n){if(this._debug(i,"error",n),R(n)){const o={session:null,error:n};return Hs(n)||await this._removeSession(),(t=this.refreshingDeferred)===null||t===void 0||t.resolve(o),o}throw(a=this.refreshingDeferred)===null||a===void 0||a.reject(n),n}finally{this.refreshingDeferred=null,this._debug(i,"end")}}async _notifyAllSubscribers(e,t,a=!0){const i=`#_notifyAllSubscribers(${e})`;this._debug(i,"begin",t,`broadcast = ${a}`);try{this.broadcastChannel&&a&&this.broadcastChannel.postMessage({event:e,session:t});const n=[],o=Array.from(this.stateChangeEmitters.values()).map(async l=>{try{await l.callback(e,t)}catch(c){n.push(c)}});if(await Promise.all(o),n.length>0){for(let l=0;l<n.length;l+=1)console.error(n[l]);throw n[0]}}finally{this._debug(i,"end")}}async _saveSession(e){this._debug("#_saveSession()",e),this.suppressGetSessionWarning=!0;const t=Object.assign({},e),a=t.user&&t.user.__isUserNotAvailableProxy===!0;if(this.userStorage){!a&&t.user&&await kt(this.userStorage,this.storageKey+"-user",{user:t.user});const i=Object.assign({},t);delete i.user;const n=Oa(i);await kt(this.storage,this.storageKey,n)}else{const i=Oa(t);await kt(this.storage,this.storageKey,i)}}async _removeSession(){this._debug("#_removeSession()"),await De(this.storage,this.storageKey),await De(this.storage,this.storageKey+"-code-verifier"),await De(this.storage,this.storageKey+"-user"),this.userStorage&&await De(this.userStorage,this.storageKey+"-user"),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const e=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{e&&xe()&&(window!=null&&window.removeEventListener)&&window.removeEventListener("visibilitychange",e)}catch(t){console.error("removing visibilitychange callback failed",t)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const e=setInterval(()=>this._autoRefreshTokenTick(),Nt);this.autoRefreshTicker=e,e&&typeof e=="object"&&typeof e.unref=="function"?e.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(e),setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const e=this.autoRefreshTicker;this.autoRefreshTicker=null,e&&clearInterval(e)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const e=Date.now();try{return await this._useSession(async t=>{const{data:{session:a}}=t;if(!a||!a.refresh_token||!a.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const i=Math.floor((a.expires_at*1e3-e)/Nt);this._debug("#_autoRefreshTokenTick()",`access token expires in ${i} ticks, a tick lasts ${Nt}ms, refresh threshold is ${kr} ticks`),i<=kr&&await this._callRefreshToken(a.refresh_token)})}catch(t){console.error("Auto refresh tick failed with error. This is likely a transient error.",t)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(e){if(e.isAcquireTimeout||e instanceof ln)this._debug("auto refresh token tick lock not available");else throw e}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!xe()||!(window!=null&&window.addEventListener))return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),window==null||window.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(e){console.error("_handleVisibilityChange",e)}}async _onVisibilityChanged(e){const t=`#_onVisibilityChanged(${e})`;this._debug(t,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),e||(await this.initializePromise,await this._acquireLock(-1,async()=>{if(document.visibilityState!=="visible"){this._debug(t,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(e,t,a){const i=[`provider=${encodeURIComponent(t)}`];if(a!=null&&a.redirectTo&&i.push(`redirect_to=${encodeURIComponent(a.redirectTo)}`),a!=null&&a.scopes&&i.push(`scopes=${encodeURIComponent(a.scopes)}`),this.flowType==="pkce"){const[n,o]=await bt(this.storage,this.storageKey),l=new URLSearchParams({code_challenge:`${encodeURIComponent(n)}`,code_challenge_method:`${encodeURIComponent(o)}`});i.push(l.toString())}if(a!=null&&a.queryParams){const n=new URLSearchParams(a.queryParams);i.push(n.toString())}return a!=null&&a.skipBrowserRedirect&&i.push(`skip_http_redirect=${a.skipBrowserRedirect}`),`${e}?${i.join("&")}`}async _unenroll(e){try{return await this._useSession(async t=>{var a;const{data:i,error:n}=t;return n?{data:null,error:n}:await $(this.fetch,"DELETE",`${this.url}/factors/${e.factorId}`,{headers:this.headers,jwt:(a=i==null?void 0:i.session)===null||a===void 0?void 0:a.access_token})})}catch(t){if(R(t))return{data:null,error:t};throw t}}async _enroll(e){try{return await this._useSession(async t=>{var a,i;const{data:n,error:o}=t;if(o)return{data:null,error:o};const l=Object.assign({friendly_name:e.friendlyName,factor_type:e.factorType},e.factorType==="phone"?{phone:e.phone}:{issuer:e.issuer}),{data:c,error:d}=await $(this.fetch,"POST",`${this.url}/factors`,{body:l,headers:this.headers,jwt:(a=n==null?void 0:n.session)===null||a===void 0?void 0:a.access_token});return d?{data:null,error:d}:(e.factorType==="totp"&&(!((i=c==null?void 0:c.totp)===null||i===void 0)&&i.qr_code)&&(c.totp.qr_code=`data:image/svg+xml;utf-8,${c.totp.qr_code}`),{data:c,error:null})})}catch(t){if(R(t))return{data:null,error:t};throw t}}async _verify(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async t=>{var a;const{data:i,error:n}=t;if(n)return{data:null,error:n};const{data:o,error:l}=await $(this.fetch,"POST",`${this.url}/factors/${e.factorId}/verify`,{body:{code:e.code,challenge_id:e.challengeId},headers:this.headers,jwt:(a=i==null?void 0:i.session)===null||a===void 0?void 0:a.access_token});return l?{data:null,error:l}:(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+o.expires_in},o)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",o),{data:o,error:l})})}catch(t){if(R(t))return{data:null,error:t};throw t}})}async _challenge(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async t=>{var a;const{data:i,error:n}=t;return n?{data:null,error:n}:await $(this.fetch,"POST",`${this.url}/factors/${e.factorId}/challenge`,{body:{channel:e.channel},headers:this.headers,jwt:(a=i==null?void 0:i.session)===null||a===void 0?void 0:a.access_token})})}catch(t){if(R(t))return{data:null,error:t};throw t}})}async _challengeAndVerify(e){const{data:t,error:a}=await this._challenge({factorId:e.factorId});return a?{data:null,error:a}:await this._verify({factorId:e.factorId,challengeId:t.id,code:e.code})}async _listFactors(){const{data:{user:e},error:t}=await this.getUser();if(t)return{data:null,error:t};const a=(e==null?void 0:e.factors)||[],i=a.filter(o=>o.factor_type==="totp"&&o.status==="verified"),n=a.filter(o=>o.factor_type==="phone"&&o.status==="verified");return{data:{all:a,totp:i,phone:n},error:null}}async _getAuthenticatorAssuranceLevel(){return this._acquireLock(-1,async()=>await this._useSession(async e=>{var t,a;const{data:{session:i},error:n}=e;if(n)return{data:null,error:n};if(!i)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:o}=Qs(i.access_token);let l=null;o.aal&&(l=o.aal);let c=l;((a=(t=i.user.factors)===null||t===void 0?void 0:t.filter(h=>h.status==="verified"))!==null&&a!==void 0?a:[]).length>0&&(c="aal2");const u=o.amr||[];return{data:{currentLevel:l,nextLevel:c,currentAuthenticationMethods:u},error:null}}))}async fetchJwk(e,t={keys:[]}){let a=t.keys.find(l=>l.kid===e);if(a)return a;const i=Date.now();if(a=this.jwks.keys.find(l=>l.kid===e),a&&this.jwks_cached_at+fc>i)return a;const{data:n,error:o}=await $(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(o)throw o;return!n.keys||n.keys.length===0||(this.jwks=n,this.jwks_cached_at=i,a=n.keys.find(l=>l.kid===e),!a)?null:a}async getClaims(e,t={}){try{let a=e;if(!a){const{data:f,error:x}=await this.getSession();if(x||!f.session)return{data:null,error:x};a=f.session.access_token}const{header:i,payload:n,signature:o,raw:{header:l,payload:c}}=Qs(a);t!=null&&t.allowExpired||Uc(n.exp);const d=!i.alg||i.alg.startsWith("HS")||!i.kid||!("crypto"in globalThis&&"subtle"in globalThis.crypto)?null:await this.fetchJwk(i.kid,t!=null&&t.keys?{keys:t.keys}:t==null?void 0:t.jwks);if(!d){const{error:f}=await this.getUser(a);if(f)throw f;return{data:{claims:n,header:i,signature:o},error:null}}const u=Fc(i.alg),h=await crypto.subtle.importKey("jwk",d,u,!0,["verify"]);if(!await crypto.subtle.verify(u,h,o,kc(`${l}.${c}`)))throw new Er("Invalid JWT signature");return{data:{claims:n,header:i,signature:o},error:null}}catch(a){if(R(a))return{data:null,error:a};throw a}}}ns.nextInstanceID=0;const sd=ns;class rd extends sd{constructor(e){super(e)}}var ad=function(r,e,t,a){function i(n){return n instanceof t?n:new t(function(o){o(n)})}return new(t||(t=Promise))(function(n,o){function l(u){try{d(a.next(u))}catch(h){o(h)}}function c(u){try{d(a.throw(u))}catch(h){o(h)}}function d(u){u.done?n(u.value):i(u.value).then(l,c)}d((a=a.apply(r,e||[])).next())})};class id{constructor(e,t,a){var i,n,o;if(this.supabaseUrl=e,this.supabaseKey=t,!e)throw new Error("supabaseUrl is required.");if(!t)throw new Error("supabaseKey is required.");const l=cc(e),c=new URL(l);this.realtimeUrl=new URL("realtime/v1",c),this.realtimeUrl.protocol=this.realtimeUrl.protocol.replace("http","ws"),this.authUrl=new URL("auth/v1",c),this.storageUrl=new URL("storage/v1",c),this.functionsUrl=new URL("functions/v1",c);const d=`sb-${c.hostname.split(".")[0]}-auth-token`,u={db:tc,realtime:rc,auth:Object.assign(Object.assign({},sc),{storageKey:d}),global:ec},h=dc(a??{},u);this.storageKey=(i=h.auth.storageKey)!==null&&i!==void 0?i:"",this.headers=(n=h.global.headers)!==null&&n!==void 0?n:{},h.accessToken?(this.accessToken=h.accessToken,this.auth=new Proxy({},{get:(g,f)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(f)} is not possible`)}})):this.auth=this._initSupabaseAuthClient((o=h.auth)!==null&&o!==void 0?o:{},this.headers,h.global.fetch),this.fetch=oc(t,this._getAccessToken.bind(this),h.global.fetch),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers,accessToken:this._getAccessToken.bind(this)},h.realtime)),this.rest=new _l(new URL("rest/v1",c).href,{headers:this.headers,schema:h.db.schema,fetch:this.fetch}),this.storage=new Yl(this.storageUrl.href,this.headers,this.fetch,a==null?void 0:a.storage),h.accessToken||this._listenForAuthEvents()}get functions(){return new Xo(this.functionsUrl.href,{headers:this.headers,customFetch:this.fetch})}from(e){return this.rest.from(e)}schema(e){return this.rest.schema(e)}rpc(e,t={},a={}){return this.rest.rpc(e,t,a)}channel(e,t={config:{}}){return this.realtime.channel(e,t)}getChannels(){return this.realtime.getChannels()}removeChannel(e){return this.realtime.removeChannel(e)}removeAllChannels(){return this.realtime.removeAllChannels()}_getAccessToken(){var e,t;return ad(this,void 0,void 0,function*(){if(this.accessToken)return yield this.accessToken();const{data:a}=yield this.auth.getSession();return(t=(e=a.session)===null||e===void 0?void 0:e.access_token)!==null&&t!==void 0?t:null})}_initSupabaseAuthClient({autoRefreshToken:e,persistSession:t,detectSessionInUrl:a,storage:i,storageKey:n,flowType:o,lock:l,debug:c},d,u){const h={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new rd({url:this.authUrl.href,headers:Object.assign(Object.assign({},h),d),storageKey:n,autoRefreshToken:e,persistSession:t,detectSessionInUrl:a,storage:i,flowType:o,lock:l,debug:c,fetch:u,hasCustomAuthorizationHeader:"Authorization"in this.headers})}_initRealtimeClient(e){return new Dl(this.realtimeUrl.href,Object.assign(Object.assign({},e),{params:Object.assign({apikey:this.supabaseKey},e==null?void 0:e.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((t,a)=>{this._handleTokenChanged(t,"CLIENT",a==null?void 0:a.access_token)})}_handleTokenChanged(e,t,a){(e==="TOKEN_REFRESHED"||e==="SIGNED_IN")&&this.changedAccessToken!==a?this.changedAccessToken=a:e==="SIGNED_OUT"&&(this.realtime.setAuth(),t=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}}const nd=(r,e,t)=>new id(r,e,t);function od(){if(typeof window<"u"||typeof process>"u"||process.version===void 0||process.version===null)return!1;const r=process.version.match(/^v(\d+)\./);return r?parseInt(r[1],10)<=18:!1}od()&&console.warn("  Node.js 18 and below are deprecated and will no longer be supported in future versions of @supabase/supabase-js. Please upgrade to Node.js 20 or later. For more information, visit: https://github.com/orgs/supabase/discussions/37217");const Da={BASE_URL:"./",DEV:!1,MODE:"production",PROD:!0,SSR:!1,VITE_SUPABASE_ANON_KEY:"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImJjZmlsc3J5Zmp3ZW1xeXR3YnZyIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTQwMzU5MTksImV4cCI6MjA2OTYxMTkxOX0.9AJ51rynZVDSINfVWYsh9s2cjpUvz75BR7FiA_TqNvk",VITE_SUPABASE_URL:"https://bcfilsryfjwemqytwbvr.supabase.co",VITE_USDA_API_KEY:"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImJjZmlsc3J5Zmp3ZW1xeXR3YnZyIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTQwMzU5MTksImV4cCI6MjA2OTYxMTkxOX0.9AJ51rynZVDSINfVWYsh9s2cjpUvz75BR7FiA_TqNvk"};var Ua={};const cn=typeof window<"u"&&window.location.hostname==="localhost",dn=!cn,_t={supabaseUrl:"https://ykgqcftrfvjblmqzbqvr.supabase.co",supabaseKey:"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InlrZ3FjZnRyZnZqYmxtcXpicXZyIiwicm9sZSI6ImFub24iLCJpYXQiOjE3MzU3ODcxNjQsImV4cCI6MjA1MTM2MzE2NH0.x7kMQbFJevYhYe4LvBTIb3VjcL6H6M7AQwvR8IbgAY4",usdaApiKey:"z4YPCZm0HAL1SLXe9sRhXXRG8meDjQDBkGqE7hqY"};function Zs(r){try{if(typeof import.meta<"u"&&Da)return Da[r];if(typeof process<"u"&&Ua)return Ua[r]}catch{}}const Kr={isDev:cn,isProd:dn,supabase:{url:Zs("VITE_SUPABASE_URL")||_t.supabaseUrl,anonKey:Zs("VITE_SUPABASE_ANON_KEY")||_t.supabaseKey},usda:{apiKey:Zs("VITE_USDA_API_KEY")||_t.usdaApiKey,baseUrl:"https://api.nal.usda.gov/fdc/v1"},fallback:{supabaseUrl:_t.supabaseUrl,supabaseKey:_t.supabaseKey,usdaApiKey:_t.usdaApiKey}};dn&&console.log(" ByteWise Production Mode");const ld=Kr.supabase.url,cd=Kr.supabase.anonKey,V=nd(ld,cd,{auth:{autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0},db:{schema:"public"},global:{headers:{"X-Client-Info":"bytewise-nutrition-tracker"}}});V.auth;V.storage;V.functions;const Fa={async getCurrentUser(){const{data:{user:r},error:e}=await V.auth.getUser();if(e)throw e;if(r){const{data:t}=await V.from("users").select("*").eq("id",r.id).single();return t}return null},async updateProfile(r){const{data:{user:e}}=await V.auth.getUser();if(!e)throw new Error("Not authenticated");const{data:t,error:a}=await V.from("users").update({...r,updated_at:new Date().toISOString()}).eq("id",e.id).select().single();if(a)throw a;return t},async upsertUser(r){const{data:e,error:t}=await V.from("users").upsert({...r,updated_at:new Date().toISOString()}).select().single();if(t)throw t;return e}};function un(){const[r,e]=b.useState(null),[t,a]=b.useState(!0),[i,n]=b.useState(null),o=pt(),l=Kr.supabase.isConfigured,{data:c,isLoading:d}=Et({queryKey:["user-profile",r==null?void 0:r.id],queryFn:()=>Fa.getCurrentUser(),enabled:!!r,retry:!1});return b.useEffect(()=>{if(!l){a(!1),n("Supabase not configured");return}V.auth.getSession().then(({data:{session:p},error:w})=>{w&&(console.error("Auth session error:",w),n(w.message)),e((p==null?void 0:p.user)??null),a(!1)}).catch(p=>{console.error("Auth setup error:",p),n("Authentication setup failed"),a(!1)});const{data:{subscription:y}}=V.auth.onAuthStateChange(async(p,w)=>{var T,v,C,N;if(console.log("Auth state changed:",p,(T=w==null?void 0:w.user)==null?void 0:T.email),e((w==null?void 0:w.user)??null),a(!1),p==="SIGNED_IN"&&(w!=null&&w.user)){const _=w.user;try{await Fa.upsertUser({id:_.id,email:_.email,first_name:(v=_.user_metadata)==null?void 0:v.first_name,last_name:(C=_.user_metadata)==null?void 0:C.last_name,profile_image_url:(N=_.user_metadata)==null?void 0:N.avatar_url}),o.invalidateQueries({queryKey:["user-profile"]})}catch(k){console.error("Error upserting user:",k)}}p==="SIGNED_OUT"&&o.clear()});return()=>y.unsubscribe()},[o]),{user:r,profile:c,loading:t||d,isAuthenticated:!!r&&l,isConfigured:l,error:i,signInWithEmail:async(y,p)=>{const{data:w,error:T}=await V.auth.signInWithPassword({email:y,password:p});if(T)throw T;return w},signUpWithEmail:async(y,p,w)=>{const{data:T,error:v}=await V.auth.signUp({email:y,password:p,options:{data:w}});if(v)throw v;return T},signInWithProvider:async y=>{const{data:p,error:w}=await V.auth.signInWithOAuth({provider:y,options:{redirectTo:`${window.location.origin}/auth/callback`}});if(w)throw w;return p},signOut:async()=>{const{error:y}=await V.auth.signOut();if(y)throw y},resetPassword:async y=>{const{error:p}=await V.auth.resetPasswordForEmail(y,{redirectTo:`${window.location.origin}/auth/reset-password`});if(p)throw p}}}const za=r=>typeof r=="boolean"?`${r}`:r===0?"0":r,Ba=wi,hn=(r,e)=>t=>{var a;if((e==null?void 0:e.variants)==null)return Ba(r,t==null?void 0:t.class,t==null?void 0:t.className);const{variants:i,defaultVariants:n}=e,o=Object.keys(i).map(d=>{const u=t==null?void 0:t[d],h=n==null?void 0:n[d];if(u===null)return null;const g=za(u)||za(h);return i[d][g]}),l=t&&Object.entries(t).reduce((d,u)=>{let[h,g]=u;return g===void 0||(d[h]=g),d},{}),c=e==null||(a=e.compoundVariants)===null||a===void 0?void 0:a.reduce((d,u)=>{let{class:h,className:g,...f}=u;return Object.entries(f).every(x=>{let[y,p]=x;return Array.isArray(p)?p.includes({...n,...l}[y]):{...n,...l}[y]===p})?[...d,h,g]:d},[]);return Ba(r,o,c,t==null?void 0:t.class,t==null?void 0:t.className)};function H(...r){return co(wi(r))}const dd=hn("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),A=b.forwardRef(({className:r,variant:e,size:t,asChild:a=!1,...i},n)=>{const o=a?Wn:"button";return s.jsx(o,{className:H(dd({variant:e,size:t,className:r})),ref:n,...i})});A.displayName="Button";function F({className:r,...e}){return s.jsx("div",{"data-slot":"card",className:H("bg-card text-card-foreground flex flex-col gap-6 rounded-xl border",r),...e})}function oe({className:r,type:e,...t}){return s.jsx("input",{type:e,"data-slot":"input",className:H("file:text-foreground placeholder:text-muted-foreground selection:bg-primary selection:text-primary-foreground dark:bg-input/30 border-input flex h-10 w-full min-w-0 rounded-md border px-3 py-2 text-base bg-white transition-[color,box-shadow] outline-none file:inline-flex file:h-7 file:border-0 file:bg-transparent file:text-sm file:font-medium disabled:pointer-events-none disabled:cursor-not-allowed disabled:opacity-50 md:text-sm","focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px]","aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive",r),...t})}var ud="Label",mn=b.forwardRef((r,e)=>s.jsx(Kt.label,{...r,ref:e,onMouseDown:t=>{var i;t.target.closest("button, input, select, textarea")||((i=r.onMouseDown)==null||i.call(r,t),!t.defaultPrevented&&t.detail>1&&t.preventDefault())}}));mn.displayName=ud;var hd=mn;function qa({className:r,...e}){return s.jsx(hd,{"data-slot":"label",className:H("flex items-center gap-2 text-sm leading-none font-medium select-none group-data-[disabled=true]:pointer-events-none group-data-[disabled=true]:opacity-50 peer-disabled:cursor-not-allowed peer-disabled:opacity-50",r),...e})}const md=hn("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function U({className:r,variant:e,...t}){return s.jsx("div",{className:H(md({variant:e}),r),...t})}/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gd=r=>r.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),gn=(...r)=>r.filter((e,t,a)=>!!e&&a.indexOf(e)===t).join(" ");/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var fd={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pd=b.forwardRef(({color:r="currentColor",size:e=24,strokeWidth:t=2,absoluteStrokeWidth:a,className:i="",children:n,iconNode:o,...l},c)=>b.createElement("svg",{ref:c,...fd,width:e,height:e,stroke:r,strokeWidth:a?Number(t)*24/Number(e):t,className:gn("lucide",i),...l},[...o.map(([d,u])=>b.createElement(d,u)),...Array.isArray(n)?n:[n]]));/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const I=(r,e)=>{const t=b.forwardRef(({className:a,...i},n)=>b.createElement(pd,{ref:n,iconNode:e,className:gn(`lucide-${gd(r)}`,a),...i}));return t.displayName=`${r}`,t};/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const os=I("Activity",[["path",{d:"M22 12h-2.48a2 2 0 0 0-1.93 1.46l-2.35 8.36a.25.25 0 0 1-.48 0L9.24 2.18a.25.25 0 0 0-.48 0l-2.35 8.36A2 2 0 0 1 4.49 12H2",key:"169zse"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xd=I("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ht=I("Award",[["path",{d:"m15.477 12.89 1.515 8.526a.5.5 0 0 1-.81.47l-3.58-2.687a1 1 0 0 0-1.197 0l-3.586 2.686a.5.5 0 0 1-.81-.469l1.514-8.526",key:"1yiouv"}],["circle",{cx:"12",cy:"8",r:"6",key:"1vp47v"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Tr=I("Beef",[["circle",{cx:"12.5",cy:"8.5",r:"2.5",key:"9738u8"}],["path",{d:"M12.5 2a6.5 6.5 0 0 0-6.22 4.6c-1.1 3.13-.78 3.9-3.18 6.08A3 3 0 0 0 5 18c4 0 8.4-1.8 11.4-4.3A6.5 6.5 0 0 0 12.5 2Z",key:"o0f6za"}],["path",{d:"m18.5 6 2.19 4.5a6.48 6.48 0 0 1 .31 2 6.49 6.49 0 0 1-2.6 5.2C15.4 20.2 11 22 7 22a3 3 0 0 1-2.68-1.66L2.4 16.5",key:"k7p6i0"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ze=I("Bell",[["path",{d:"M6 8a6 6 0 0 1 12 0c0 7 3 9 3 9H3s3-2 3-9",key:"1qo2s2"}],["path",{d:"M10.3 21a1.94 1.94 0 0 0 3.4 0",key:"qgo35s"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const es=I("Calculator",[["rect",{width:"16",height:"20",x:"4",y:"2",rx:"2",key:"1nb95v"}],["line",{x1:"8",x2:"16",y1:"6",y2:"6",key:"x4nwl0"}],["line",{x1:"16",x2:"16",y1:"14",y2:"18",key:"wjye3r"}],["path",{d:"M16 10h.01",key:"1m94wz"}],["path",{d:"M12 10h.01",key:"1nrarc"}],["path",{d:"M8 10h.01",key:"19clt8"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M8 14h.01",key:"6423bh"}],["path",{d:"M12 18h.01",key:"mhygvu"}],["path",{d:"M8 18h.01",key:"lrp35t"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Te=I("Calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Pr=I("ChartColumn",[["path",{d:"M3 3v16a2 2 0 0 0 2 2h16",key:"c24i48"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yd=I("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bd=I("ChefHat",[["path",{d:"M17 21a1 1 0 0 0 1-1v-5.35c0-.457.316-.844.727-1.041a4 4 0 0 0-2.134-7.589 5 5 0 0 0-9.186 0 4 4 0 0 0-2.134 7.588c.411.198.727.585.727 1.041V20a1 1 0 0 0 1 1Z",key:"1qvrer"}],["path",{d:"M6 17h12",key:"1jwigz"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Vr=I("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vd=I("ChevronLeft",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fn=I("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pn=I("ChevronUp",[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ir=I("CircleAlert",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const je=I("CircleCheckBig",[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xn=I("CircleX",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Wa=I("Circle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Us=I("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wd=I("Coffee",[["path",{d:"M10 2v2",key:"7u0qdc"}],["path",{d:"M14 2v2",key:"6buw04"}],["path",{d:"M16 8a1 1 0 0 1 1 1v8a4 4 0 0 1-4 4H7a4 4 0 0 1-4-4V9a1 1 0 0 1 1-1h14a4 4 0 1 1 0 8h-1",key:"pwadti"}],["path",{d:"M6 2v2",key:"colzsn"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ar=I("Database",[["ellipse",{cx:"12",cy:"5",rx:"9",ry:"3",key:"msslwz"}],["path",{d:"M3 5V19A9 3 0 0 0 21 19V5",key:"1wlel7"}],["path",{d:"M3 12A9 3 0 0 0 21 12",key:"mv7ke4"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Fs=I("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Or=I("Droplets",[["path",{d:"M7 16.3c2.2 0 4-1.83 4-4.05 0-1.16-.57-2.26-1.71-3.19S7.29 6.75 7 5.3c-.29 1.45-1.14 2.84-2.29 3.76S3 11.1 3 12.25c0 2.22 1.8 4.05 4 4.05z",key:"1ptgy4"}],["path",{d:"M12.56 6.6A10.97 10.97 0 0 0 14 3.02c.5 2.5 2 4.9 4 6.5s3 3.5 3 5.5a6.98 6.98 0 0 1-11.91 4.97",key:"1sl1rz"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jd=I("EyeOff",[["path",{d:"M10.733 5.076a10.744 10.744 0 0 1 11.205 6.575 1 1 0 0 1 0 .696 10.747 10.747 0 0 1-1.444 2.49",key:"ct8e1f"}],["path",{d:"M14.084 14.158a3 3 0 0 1-4.242-4.242",key:"151rxh"}],["path",{d:"M17.479 17.499a10.75 10.75 0 0 1-15.417-5.151 1 1 0 0 1 0-.696 10.75 10.75 0 0 1 4.446-5.143",key:"13bj9a"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rs=I("Eye",[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const as=I("FileText",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ue=I("Flame",[["path",{d:"M8.5 14.5A2.5 2.5 0 0 0 11 12c0-1.38-.5-2-1-3-1.072-2.143-.224-4.054 2-6 .5 2.5 2 4.9 4 6.5 2 1.6 3 3.5 3 5.5a7 7 0 1 1-14 0c0-1.153.433-2.294 1-3a2.5 2.5 0 0 0 2.5 2.5z",key:"96xj49"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ga=I("Globe",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 2a14.5 14.5 0 0 0 0 20 14.5 14.5 0 0 0 0-20",key:"13o1zl"}],["path",{d:"M2 12h20",key:"9i4pu4"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ka=I("House",[["path",{d:"M15 21v-8a1 1 0 0 0-1-1h-4a1 1 0 0 0-1 1v8",key:"5wwlr5"}],["path",{d:"M3 10a2 2 0 0 1 .709-1.528l7-5.999a2 2 0 0 1 2.582 0l7 5.999A2 2 0 0 1 21 10v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"1d0kgt"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Hr=I("Info",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Rr=I("Lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _d=I("LogIn",[["path",{d:"M15 3h4a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2h-4",key:"u53s6r"}],["polyline",{points:"10 17 15 12 10 7",key:"1ail0h"}],["line",{x1:"15",x2:"3",y1:"12",y2:"12",key:"v6grx8"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Nd=I("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Es=I("Mail",[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yn=I("Moon",[["path",{d:"M12 3a6 6 0 0 0 9 9 9 9 0 1 1-9-9Z",key:"a7tn18"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vs=I("Palette",[["circle",{cx:"13.5",cy:"6.5",r:".5",fill:"currentColor",key:"1okk4w"}],["circle",{cx:"17.5",cy:"10.5",r:".5",fill:"currentColor",key:"f64h9f"}],["circle",{cx:"8.5",cy:"7.5",r:".5",fill:"currentColor",key:"fotxhn"}],["circle",{cx:"6.5",cy:"12.5",r:".5",fill:"currentColor",key:"qy21gx"}],["path",{d:"M12 2C6.5 2 2 6.5 2 12s4.5 10 10 10c.926 0 1.648-.746 1.648-1.688 0-.437-.18-.835-.437-1.125-.29-.289-.438-.652-.438-1.125a1.64 1.64 0 0 1 1.668-1.668h1.996c3.051 0 5.555-2.503 5.555-5.554C21.965 6.012 17.461 2 12 2z",key:"12rzf8"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qt=I("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Be=I("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kd=I("Save",[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bn=I("Scale",[["path",{d:"m16 16 3-8 3 8c-.87.65-1.92 1-3 1s-2.13-.35-3-1Z",key:"7g6ntu"}],["path",{d:"m2 16 3-8 3 8c-.87.65-1.92 1-3 1s-2.13-.35-3-1Z",key:"ijws7r"}],["path",{d:"M7 21h10",key:"1b0cd5"}],["path",{d:"M12 3v18",key:"108xh3"}],["path",{d:"M3 7h2c2 0 5-1 7-2 2 1 5 2 7 2h2",key:"3gwbw2"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Va=I("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ts=I("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Me=I("Shield",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Mr=I("Smartphone",[["rect",{width:"14",height:"20",x:"5",y:"2",rx:"2",ry:"2",key:"1yt0o3"}],["path",{d:"M12 18h.01",key:"mhygvu"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Sd=I("SquarePen",[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z",key:"ohrbg2"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const at=I("Star",[["polygon",{points:"12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2",key:"8f66p6"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vn=I("Sun",[["circle",{cx:"12",cy:"12",r:"4",key:"4exip2"}],["path",{d:"M12 2v2",key:"tus03m"}],["path",{d:"M12 20v2",key:"1lh1kg"}],["path",{d:"m4.93 4.93 1.41 1.41",key:"149t6j"}],["path",{d:"m17.66 17.66 1.41 1.41",key:"ptbguv"}],["path",{d:"M2 12h2",key:"1t8f8n"}],["path",{d:"M20 12h2",key:"1q8mjw"}],["path",{d:"m6.34 17.66-1.41 1.41",key:"1m8zz5"}],["path",{d:"m19.07 4.93-1.41 1.41",key:"1shlcs"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Cd=I("Sunrise",[["path",{d:"M12 2v8",key:"1q4o3n"}],["path",{d:"m4.93 10.93 1.41 1.41",key:"2a7f42"}],["path",{d:"M2 18h2",key:"j10viu"}],["path",{d:"M20 18h2",key:"wocana"}],["path",{d:"m19.07 10.93-1.41 1.41",key:"15zs5n"}],["path",{d:"M22 22H2",key:"19qnx5"}],["path",{d:"m8 6 4-4 4 4",key:"ybng9g"}],["path",{d:"M16 18a4 4 0 0 0-8 0",key:"1lzouq"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const he=I("Target",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"12",r:"6",key:"1vlfrh"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wn=I("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ft=I("TrendingUp",[["polyline",{points:"22 7 13.5 15.5 8.5 10.5 2 17",key:"126l90"}],["polyline",{points:"16 7 22 7 22 13",key:"kwv8wd"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ha=I("TriangleAlert",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qr=I("Trophy",[["path",{d:"M6 9H4.5a2.5 2.5 0 0 1 0-5H6",key:"17hqa7"}],["path",{d:"M18 9h1.5a2.5 2.5 0 0 0 0-5H18",key:"lmptdp"}],["path",{d:"M4 22h16",key:"57wxv0"}],["path",{d:"M10 14.66V17c0 .55-.47.98-.97 1.21C7.85 18.75 7 20.24 7 22",key:"1nw9bq"}],["path",{d:"M14 14.66V17c0 .55.47.98.97 1.21C16.15 18.75 17 20.24 17 22",key:"1np0yb"}],["path",{d:"M18 2H6v7a6 6 0 0 0 12 0V2Z",key:"u46fv3"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xs=I("Type",[["polyline",{points:"4 7 4 4 20 4 20 7",key:"1nosan"}],["line",{x1:"9",x2:"15",y1:"20",y2:"20",key:"swin9y"}],["line",{x1:"12",x2:"12",y1:"4",y2:"20",key:"1tx1rr"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ps=I("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qa=I("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Pe=I("Utensils",[["path",{d:"M3 2v7c0 1.1.9 2 2 2h4a2 2 0 0 0 2-2V2",key:"cjf0a3"}],["path",{d:"M7 2v20",key:"1473qp"}],["path",{d:"M21 15V2a5 5 0 0 0-5 5v6c0 1.1.9 2 2 2h3Zm0 0v7",key:"j28e5"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ed=I("Wheat",[["path",{d:"M2 22 16 8",key:"60hf96"}],["path",{d:"M3.47 12.53 5 11l1.53 1.53a3.5 3.5 0 0 1 0 4.94L5 19l-1.53-1.53a3.5 3.5 0 0 1 0-4.94Z",key:"1rdhi6"}],["path",{d:"M7.47 8.53 9 7l1.53 1.53a3.5 3.5 0 0 1 0 4.94L9 15l-1.53-1.53a3.5 3.5 0 0 1 0-4.94Z",key:"1sdzmb"}],["path",{d:"M11.47 4.53 13 3l1.53 1.53a3.5 3.5 0 0 1 0 4.94L13 11l-1.53-1.53a3.5 3.5 0 0 1 0-4.94Z",key:"eoatbi"}],["path",{d:"M20 2h2v2a4 4 0 0 1-4 4h-2V6a4 4 0 0 1 4-4Z",key:"19rau1"}],["path",{d:"M11.47 17.47 13 19l-1.53 1.53a3.5 3.5 0 0 1-4.94 0L5 19l1.53-1.53a3.5 3.5 0 0 1 4.94 0Z",key:"tc8ph9"}],["path",{d:"M15.47 13.47 17 15l-1.53 1.53a3.5 3.5 0 0 1-4.94 0L9 15l1.53-1.53a3.5 3.5 0 0 1 4.94 0Z",key:"2m8kc5"}],["path",{d:"M19.47 9.47 21 11l-1.53 1.53a3.5 3.5 0 0 1-4.94 0L13 11l1.53-1.53a3.5 3.5 0 0 1 4.94 0Z",key:"vex3ng"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Wt=I("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Jr=I("Zap",[["path",{d:"M4 14a1 1 0 0 1-.78-1.63l9.9-10.2a.5.5 0 0 1 .86.46l-1.92 6.02A1 1 0 0 0 13 10h7a1 1 0 0 1 .78 1.63l-9.9 10.2a.5.5 0 0 1-.86-.46l1.92-6.02A1 1 0 0 0 11 14z",key:"1xq2db"}]]);function zs({size:r="md",clickable:e=!1,onClick:t,className:a=""}){const i=e?"button":"div",o={xs:{mainSize:"1.125rem",taglineSize:"0.5rem",taglineSpacing:"0.05rem"},sm:{mainSize:"1.5rem",taglineSize:"0.625rem",taglineSpacing:"0.0625rem"},md:{mainSize:"2.25rem",taglineSize:"0.875rem",taglineSpacing:"0.125rem"},lg:{mainSize:"3rem",taglineSize:"1.125rem",taglineSpacing:"0.1875rem"},xl:{mainSize:"4rem",taglineSize:"1.5rem",taglineSpacing:"0.25rem"}}[r],l=e?"hover:scale-102 transition-transform duration-200 cursor-pointer focus:outline-none focus:ring-2 focus:ring-blue-400 focus:ring-offset-2 rounded-lg":"";return s.jsxs(i,{className:`new-bytewise-logo ${l} ${a}`,onClick:e?t:void 0,"aria-label":e?"Go to Dashboard":void 0,type:e?"button":void 0,style:{display:"inline-block",userSelect:"none",WebkitUserSelect:"none"},children:[s.jsx("div",{className:"new-bytewise-main",style:{fontFamily:"'League Spartan', 'Arial Black', sans-serif",fontSize:o.mainSize,fontWeight:"800",color:"#7dd3fc",lineHeight:"1",letterSpacing:"-0.025em",margin:"0",padding:"0",textTransform:"lowercase"},children:"bytewise"}),s.jsx("div",{className:"new-bytewise-tagline",style:{fontFamily:"'League Spartan', 'Arial', sans-serif",fontSize:o.taglineSize,fontWeight:"400",color:"#374151",lineHeight:"1",letterSpacing:"0.2em",margin:"0",padding:"0",marginTop:o.taglineSpacing,textTransform:"uppercase",textAlign:"center"},children:"Nutritionist"})]})}const jn=""+new URL("apple-3313209_1920_1753859530078-BJW4vFlt.jpg",import.meta.url).href,_n=""+new URL("blueberries-9450130_1920_1753859477806-DQeN0M4j.jpg",import.meta.url).href,Nn=""+new URL("bowl-1842294_1920_1753859477806-bRUsOvIC.jpg",import.meta.url).href,kn=""+new URL("burgers-5590503_1920_1753859530083-I99DUxaH.jpg",import.meta.url).href,Sn=""+new URL("food-3262796_1920_1753859530086-BeFn5V1r.jpg",import.meta.url).href,ws=[{src:jn,alt:"Fresh red apple",theme:"fresh-fruits"},{src:_n,alt:"Fresh blueberries",theme:"berries"},{src:Nn,alt:"Healthy bowl",theme:"healthy-meals"},{src:kn,alt:"Gourmet burgers",theme:"comfort-food"},{src:Sn,alt:"Delicious dish",theme:"fine-dining"}];function Td(){const[r,e]=b.useState(0),[t,a]=b.useState(!0);b.useEffect(()=>{const o=(()=>{const c=localStorage.getItem("bytewise_bg_index"),u=((c?parseInt(c,10):-1)+1)%ws.length;return localStorage.setItem("bytewise_bg_index",u.toString()),u})();e(o);const l=new Image;l.onload=()=>a(!1),l.src=ws[o].src},[]);const i=ws[r];return{currentImage:i.src,currentTheme:i.theme,currentAlt:i.alt,isLoading:t,totalImages:ws.length}}function Pd({onNavigate:r}){const[e,t]=b.useState(!1),[a,i]=b.useState(""),[n,o]=b.useState(""),[l,c]=b.useState(!1),[d,u]=b.useState("login"),[h,g]=b.useState(null),[f,x]=b.useState(null),{currentImage:y,currentTheme:p,currentAlt:w,isLoading:T}=Td(),v=async _=>{_.preventDefault(),t(!0),g(null),x(null);try{if(d==="login"){const{error:k}=await V.auth.signInWithPassword({email:a,password:n});if(k)throw k}else if(d==="signup"){const{data:k,error:S}=await V.auth.signUp({email:a,password:n,options:{emailRedirectTo:`${window.location.origin}/auth/callback`,data:{first_name:a.split("@")[0]}}});if(S)throw S;k.user&&!k.session?(localStorage.setItem("pending_confirmation_email",a),x(`Confirmation email sent to ${a}! Please check your inbox and click the confirmation link to complete your account setup.`)):k.session&&x("Account created successfully! Welcome to Bytewise!")}else if(d==="forgot"){const{error:k}=await V.auth.resetPasswordForEmail(a,{redirectTo:`${window.location.origin}/reset-password`});if(k)throw k;x(`Password reset link sent to ${a}! Please check your email.`),setTimeout(()=>u("login"),3e3)}}catch(k){let S=k.message;k.message.includes("fetch")?S="Unable to connect to authentication service. Please check your internet connection.":k.message.includes("Invalid login credentials")?S="Invalid email or password. Please check your credentials.":k.message.includes("Email not confirmed")&&(S="Please check your email and click the confirmation link first."),g(S)}finally{t(!1)}},C=async()=>{t(!0),g(null);try{const{error:_}=await V.auth.signInWithOAuth({provider:"google",options:{redirectTo:window.location.origin}});if(_)throw _}catch(_){let k=_.message;_.message.includes("fetch")&&(k="Unable to connect to Google authentication. Please try again."),g(k),t(!1)}},N=()=>{switch(d){case"signup":return"Join thousands tracking their nutrition";case"forgot":return"Enter your email to reset your password";default:return"Your personal nutrition companion"}};return s.jsxs("div",{className:"min-h-screen relative overflow-hidden",children:[s.jsx("div",{className:`absolute inset-0 z-0 transition-opacity duration-500 ${T?"opacity-0":"opacity-100"}`,style:{backgroundImage:`url(${y})`,backgroundSize:"cover",backgroundPosition:"center",backgroundRepeat:"no-repeat",filter:"blur(2px) brightness(0.6)"},role:"img","aria-label":w}),T&&s.jsx("div",{className:"absolute inset-0 z-0 bg-gradient-to-br from-emerald-500 to-blue-600"}),s.jsx("div",{className:"absolute inset-0 z-5 bg-black/20"}),s.jsx("div",{className:"relative z-30 min-h-screen flex items-center justify-center p-6",children:s.jsx("div",{className:"w-full max-w-md",children:s.jsxs(F,{className:"p-8 bg-white/95 backdrop-blur-md border-0 shadow-2xl",children:[s.jsxs("div",{className:"text-center mb-6",children:[s.jsx("div",{className:"mb-4",children:s.jsx(zs,{size:"lg"})}),s.jsx("p",{className:"text-gray-600",children:N()})]}),h&&s.jsx("div",{className:"mb-4 p-3 bg-red-50 border border-red-200 rounded-lg",children:s.jsx("p",{className:"text-red-600 text-sm",children:h})}),f&&s.jsx("div",{className:"mb-4 p-4 bg-green-50 border border-green-200 rounded-lg",children:s.jsxs("div",{className:"flex items-start",children:[s.jsx("svg",{className:"w-5 h-5 text-green-500 mt-0.5 mr-2 flex-shrink-0",fill:"currentColor",viewBox:"0 0 20 20",children:s.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z",clipRule:"evenodd"})}),s.jsx("p",{className:"text-green-700 text-sm",children:f})]})}),s.jsxs("form",{onSubmit:v,className:"space-y-4 mb-4",children:[s.jsxs("div",{className:"space-y-2",children:[s.jsx(qa,{htmlFor:"email",className:"text-sm font-medium text-gray-700",children:"Email"}),s.jsxs("div",{className:"relative",children:[s.jsx(oe,{id:"email",type:"email",placeholder:"Enter your email",className:"pl-0 pr-11 h-11 text-gray-900 bg-white border-gray-300 focus:border-blue-500 focus:ring-blue-500 focus:ring-1",style:{backgroundColor:"white !important",color:"#1f2937 !important"},value:a,onChange:_=>i(_.target.value),required:!0}),s.jsx(Es,{className:"absolute right-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"})]})]}),d!=="forgot"&&s.jsxs("div",{className:"space-y-2",children:[s.jsx(qa,{htmlFor:"password",className:"text-sm font-medium text-gray-700",children:"Password"}),s.jsxs("div",{className:"relative",children:[s.jsx(oe,{id:"password",type:l?"text":"password",placeholder:"Enter your password",className:"pl-0 pr-20 h-11 text-gray-900 bg-white border-gray-300 focus:border-blue-500 focus:ring-blue-500 focus:ring-1",style:{backgroundColor:"white !important",color:"#1f2937 !important"},value:n,onChange:_=>o(_.target.value),required:!0}),s.jsx(Rr,{className:"absolute right-10 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),s.jsx("button",{type:"button",className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400 hover:text-gray-600 z-10 focus:outline-none",onClick:()=>c(!l),children:l?s.jsx(jd,{className:"h-4 w-4"}):s.jsx(rs,{className:"h-4 w-4"})})]})]}),s.jsx(A,{type:"submit",disabled:e,className:"w-full h-12 bg-gradient-to-r from-emerald-600 to-blue-600 hover:from-emerald-700 hover:to-blue-700 text-white font-semibold rounded-lg transition-all duration-300 transform hover:scale-[1.02] shadow-lg hover:shadow-xl",children:e?s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"}),d==="login"?"Signing In...":d==="signup"?"Creating Account...":"Sending Reset..."]}):s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(_d,{className:"w-5 h-5"}),d==="login"?"Sign In":d==="signup"?"Create Account":"Reset Password"]})})]}),s.jsxs("div",{className:"text-center space-y-3",children:[d==="login"&&s.jsxs(s.Fragment,{children:[s.jsxs("p",{className:"text-sm text-gray-600",children:["Don't have an account?"," ",s.jsx("button",{type:"button",onClick:()=>u("signup"),className:"text-blue-600 hover:text-blue-700 font-medium",children:"Sign up"})]}),s.jsxs("p",{className:"text-sm text-gray-600",children:["Forgot your password?"," ",s.jsx("button",{type:"button",onClick:()=>u("forgot"),className:"text-blue-600 hover:text-blue-700 font-medium",children:"Reset password"})]}),s.jsxs("div",{className:"relative",children:[s.jsx("div",{className:"absolute inset-0 flex items-center",children:s.jsx("div",{className:"w-full border-t border-gray-300"})}),s.jsx("div",{className:"relative flex justify-center text-sm",children:s.jsx("span",{className:"px-2 bg-white text-gray-500",children:"or"})})]}),s.jsxs(A,{type:"button",variant:"outline",onClick:C,disabled:e,className:"w-full",children:[s.jsxs("svg",{className:"w-4 h-4 mr-2",viewBox:"0 0 24 24",children:[s.jsx("path",{fill:"currentColor",d:"M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z"}),s.jsx("path",{fill:"currentColor",d:"M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z"}),s.jsx("path",{fill:"currentColor",d:"M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z"}),s.jsx("path",{fill:"currentColor",d:"M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z"})]}),"Google"]})]}),d==="signup"&&s.jsxs("p",{className:"text-sm text-gray-600",children:["Already have an account?"," ",s.jsx("button",{type:"button",onClick:()=>u("login"),className:"text-blue-600 hover:text-blue-700 font-medium",children:"Sign in"})]}),d==="forgot"&&s.jsxs("p",{className:"text-sm text-gray-600",children:["Remember your password?"," ",s.jsx("button",{type:"button",onClick:()=>u("login"),className:"text-blue-600 hover:text-blue-700 font-medium",children:"Back to sign in"})]})]}),s.jsx("p",{className:"text-xs text-gray-500 text-center mt-6",children:"Secure authentication powered by Supabase"}),s.jsx("div",{className:"text-center mt-2",children:s.jsxs(U,{variant:"outline",className:"text-xs bg-white/80",children:[p.replace("-"," ").replace(/\b\w/g,_=>_.toUpperCase())," Theme"]})})]})})})]})}function Id({children:r,onNavigate:e}){const{isAuthenticated:t,loading:a,isConfigured:i,error:n}=un();return i?a?s.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 to-purple-100 flex items-center justify-center",children:s.jsxs("div",{className:"text-center",children:[s.jsx(zs,{size:"xl",className:"mb-6"}),s.jsx("div",{className:"w-8 h-8 border-4 border-blue-600 border-t-transparent rounded-full animate-spin mx-auto"}),s.jsx("p",{className:"text-gray-600 mt-4",children:"Loading your nutrition dashboard..."})]})}):t?s.jsx(s.Fragment,{children:r}):s.jsx(Pd,{onNavigate:e}):s.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-50",children:s.jsxs("div",{className:"text-center",children:[s.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-2",children:"Configuration Required"}),s.jsx("p",{className:"text-gray-600",children:"Please contact support to set up your account."})]})})}var Ad="Separator",Ja="horizontal",Od=["horizontal","vertical"],Cn=b.forwardRef((r,e)=>{const{decorative:t,orientation:a=Ja,...i}=r,n=Rd(a)?a:Ja,l=t?{role:"none"}:{"aria-orientation":n==="vertical"?n:void 0,role:"separator"};return s.jsx(Kt.div,{"data-orientation":n,...l,...i,ref:e})});Cn.displayName=Ad;function Rd(r){return Od.includes(r)}var En=Cn;const ee=b.forwardRef(({className:r,orientation:e="horizontal",decorative:t=!0,...a},i)=>s.jsx(En,{ref:i,decorative:t,orientation:e,className:H("shrink-0 bg-border",e==="horizontal"?"h-[1px] w-full":"h-full w-[1px]",r),...a}));ee.displayName=En.displayName;function Yr({isOpen:r,onClose:e,notifications:t,onMarkAsRead:a,onMarkAllAsRead:i,onDeleteNotification:n,onNavigate:o}){const[l,c]=b.useState(!1);if(b.useEffect(()=>{c(!0)},[]),!l||!r)return null;const d=(h,g)=>{if(g)return g;switch(h){case"success":return je;case"warning":return Ha;case"error":return xn;case"achievement":return he;default:return Hr}},u=h=>{switch(h){case"success":return"text-green-600";case"warning":return"text-yellow-600";case"error":return"text-red-600";case"achievement":return"text-blue-600";default:return"text-blue-600"}};return s.jsx("div",{className:"absolute top-full right-0 mt-2 w-80 max-h-96 z-50",children:s.jsxs(F,{className:"p-4 bg-white/80 backdrop-blur-sm border-0 shadow-lg max-h-96 overflow-y-auto",children:[s.jsxs("div",{className:"flex items-center justify-between mb-4",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(Ze,{className:"w-5 h-5 text-blue-600"}),s.jsx("h3",{className:"text-lg font-bold text-gray-900",children:"Notifications"})]}),s.jsx(A,{variant:"ghost",size:"sm",onClick:e,className:"h-8 w-8 p-0",children:s.jsx(Wt,{className:"w-4 h-4"})})]}),s.jsxs("div",{className:"mb-4",children:[s.jsxs("div",{className:"flex items-center justify-between mb-3",children:[s.jsxs("div",{children:[s.jsx("h4",{className:"font-medium text-gray-900",children:"Notification Summary"}),s.jsx("p",{className:"text-sm text-gray-600",children:"Stay updated with your nutrition progress"})]}),s.jsxs(U,{variant:"outline",className:"text-blue-600 border-blue-600",children:[s.jsx(Ze,{className:"w-3 h-3 mr-1"}),t.filter(h=>!h.read).length," New"]})]}),s.jsxs("div",{className:"grid grid-cols-3 gap-2",children:[s.jsxs("div",{className:"text-center p-2 bg-blue-50 rounded-lg",children:[s.jsx(Ze,{className:"w-4 h-4 mx-auto text-blue-600 mb-1"}),s.jsx("p",{className:"text-xs text-gray-600",children:"Total"}),s.jsx("p",{className:"font-bold text-gray-900 text-sm",children:t.length})]}),s.jsxs("div",{className:"text-center p-2 bg-green-50 rounded-lg",children:[s.jsx(je,{className:"w-4 h-4 mx-auto text-green-600 mb-1"}),s.jsx("p",{className:"text-xs text-gray-600",children:"Read"}),s.jsx("p",{className:"font-bold text-gray-900 text-sm",children:t.filter(h=>h.read).length})]}),s.jsxs("div",{className:"text-center p-2 bg-orange-50 rounded-lg",children:[s.jsx(Ha,{className:"w-4 h-4 mx-auto text-orange-600 mb-1"}),s.jsx("p",{className:"text-xs text-gray-600",children:"Unread"}),s.jsx("p",{className:"font-bold text-gray-900 text-sm",children:t.filter(h=>!h.read).length})]})]})]}),s.jsx(ee,{className:"mb-4"}),t.length>0&&s.jsx("div",{className:"mb-4",children:s.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-2",children:[s.jsxs(A,{variant:"outline",size:"sm",onClick:i,className:"border-blue-600 text-blue-600 hover:bg-blue-50 text-xs",children:[s.jsx(je,{className:"w-3 h-3 mr-1"}),"Mark All Read"]}),s.jsxs(A,{variant:"outline",size:"sm",onClick:()=>t.forEach(h=>n(h.id)),className:"border-red-600 text-red-600 hover:bg-red-50 text-xs",children:[s.jsx(wn,{className:"w-3 h-3 mr-1"}),"Clear All"]})]})}),s.jsx("div",{className:"space-y-2 max-h-64 overflow-y-auto",children:t.length===0?s.jsxs("div",{className:"text-center py-8 text-gray-500",children:[s.jsx(Ze,{className:"w-8 h-8 mx-auto mb-2 opacity-50"}),s.jsx("p",{className:"text-sm",children:"No notifications"}),s.jsx("p",{className:"text-xs text-gray-400",children:"You're all caught up!"})]}):t.map(h=>{const g=d(h.type,h.icon);return s.jsx("div",{className:`p-2 rounded-lg border transition-all duration-200 ${h.read?"bg-gray-50 border-gray-200":"bg-blue-50 border-blue-200 shadow-sm"}`,children:s.jsxs("div",{className:"flex items-start gap-2",children:[s.jsx(g,{className:`w-3 h-3 mt-0.5 flex-shrink-0 ${u(h.type)}`}),s.jsx("div",{className:"flex-1 min-w-0",children:s.jsxs("div",{className:"flex items-start justify-between gap-2",children:[s.jsxs("div",{className:"flex-1",children:[s.jsx("h4",{className:"text-xs font-medium text-gray-900 mb-0.5",children:h.title}),s.jsx("p",{className:"text-xs text-gray-600 leading-relaxed",children:h.message}),s.jsx("p",{className:"text-xs text-gray-400 mt-1",children:h.timestamp.toLocaleTimeString()})]}),s.jsxs("div",{className:"flex items-center gap-1 flex-shrink-0",children:[!h.read&&s.jsx(A,{variant:"ghost",size:"sm",onClick:()=>a(h.id),className:"h-5 w-5 p-0",children:s.jsx(je,{className:"w-3 h-3"})}),s.jsx(A,{variant:"ghost",size:"sm",onClick:()=>n(h.id),className:"h-5 w-5 p-0 text-red-500 hover:text-red-700",children:s.jsx(Wt,{className:"w-3 h-3"})})]})]})})]})},h.id)})}),s.jsxs(s.Fragment,{children:[s.jsx(ee,{className:"my-4"}),s.jsxs("div",{className:"bg-gray-50 -mx-6 -mb-6 px-6 py-4 rounded-b-lg",children:[s.jsxs("div",{className:"flex items-center justify-between mb-3",children:[s.jsxs("div",{children:[s.jsx("h4",{className:"text-sm font-medium text-gray-900",children:"Notification Center"}),s.jsx("p",{className:"text-xs text-gray-600",children:"Manage all your notifications and preferences"})]}),s.jsx(A,{variant:"outline",size:"sm",className:"text-xs",onClick:()=>{o&&o("profile","notifications"),e()},children:"View All"})]}),s.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[s.jsxs(A,{variant:"ghost",size:"sm",className:"justify-start text-xs text-gray-600 hover:text-gray-900 h-8",onClick:()=>{o&&o("profile","settings"),e()},children:[s.jsx(Ts,{className:"w-3 h-3 mr-1"}),"Settings"]}),s.jsxs(A,{variant:"ghost",size:"sm",className:"justify-start text-xs text-gray-600 hover:text-gray-900 h-8",onClick:()=>{o&&o("profile","history"),e()},children:[s.jsx(Us,{className:"w-3 h-3 mr-1"}),"History"]})]})]})]})]})})}function Md({currentPage:r,onNavigate:e,showNotifications:t=!1,notificationCount:a=0,onLogout:i}){const[n,o]=b.useState(!1),[l,c]=b.useState([]),d=f=>{c(x=>x.map(y=>y.id===f?{...y,read:!0}:y))},u=()=>{c(f=>f.map(x=>({...x,read:!0})))},h=f=>{c(x=>x.filter(y=>y.id!==f))},g=()=>"";return s.jsx("header",{className:"fixed top-0 left-0 right-0 z-50 bg-background/95 backdrop-blur-sm border-b border-border safe-area-inset-top",children:s.jsx("div",{className:"w-full max-w-lg mx-auto px-4 py-3",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("div",{className:"flex-shrink-0 flex items-center",children:s.jsx(zs,{size:"sm",clickable:!0,onClick:()=>e("dashboard"),className:"hover:opacity-80 transition-opacity duration-200"})}),s.jsx("div",{className:"flex-1 text-center",children:s.jsx("h2",{style:{fontFamily:"'League Spartan', sans-serif",fontSize:"1.125rem",fontWeight:600},children:g()})}),s.jsxs("div",{className:"flex items-center gap-1.5 flex-shrink-0 -mr-6",children:[t&&s.jsxs("div",{className:"relative",children:[s.jsxs(A,{variant:"ghost",size:"sm",className:"relative h-16 w-16 p-0 touch-target hover:bg-accent/80 transition-all duration-200",onClick:()=>o(!n),children:[s.jsx(Ze,{size:20,className:"text-gray-700"}),l.filter(f=>!f.read).length>0&&s.jsx("span",{className:"absolute -top-1 -right-1 h-5 w-5 bg-red-500 text-white rounded-full text-xs flex items-center justify-center font-bold",children:l.filter(f=>!f.read).length>9?"9+":l.filter(f=>!f.read).length})]}),s.jsx(Yr,{isOpen:n,onClose:()=>o(!1),notifications:l,onMarkAsRead:d,onMarkAllAsRead:u,onDeleteNotification:h,onNavigate:e})]}),s.jsx(A,{variant:"ghost",size:"sm",className:"h-16 w-16 p-0 touch-target hover:bg-accent/80 transition-all duration-200",onClick:()=>e("profile"),children:s.jsx(Ts,{size:20,className:"text-gray-700"})}),i&&s.jsx(A,{variant:"ghost",size:"sm",className:"h-16 w-16 p-0 touch-target hover:bg-accent/80 transition-all duration-200",onClick:i,title:"Sign Out",children:s.jsx(Nd,{size:20,className:"text-gray-700"})})]})]})})})}const $d=[{id:"dashboard",label:"Dashboard",icon:Ka,activeIcon:Ka},{id:"calculator",label:"Calculator",icon:bd},{id:"logger",label:"Logger",icon:Te,activeIcon:Te},{id:"profile",label:"Profile",icon:Ps,activeIcon:Ps}];function Ld({activeTab:r,onTabChange:e}){return s.jsx("nav",{className:"fixed bottom-0 left-0 right-0 z-40 bg-background/95 backdrop-blur-sm border-t border-border safe-area-inset-bottom",children:s.jsx("div",{className:"w-full max-w-lg mx-auto px-4 py-3",children:s.jsx("div",{className:"grid grid-cols-4 gap-1",children:$d.map(t=>{const a=r===t.id,i=a&&t.activeIcon?t.activeIcon:t.icon;return s.jsxs(A,{variant:a?"default":"ghost",size:"sm",className:`
                  navigation-button flex flex-col items-center justify-center h-16 touch-target relative
                  ${a?"bg-primary text-primary-foreground shadow-sm active":"text-muted-foreground hover:text-foreground"}
                `,onClick:()=>e(t.id),children:[s.jsx(i,{size:20,className:`mb-1 ${a?"text-primary-foreground":""}`}),s.jsx("span",{className:`text-xs leading-none ${a?"text-primary-foreground":""}`,style:{fontFamily:"'Work Sans', sans-serif",fontWeight:a?600:500,fontSize:"0.6875rem"},children:t.label}),a&&s.jsx("div",{className:"absolute top-1 right-1 w-2 h-2 bg-primary-foreground rounded-full opacity-75"})]},t.id)})})})})}function Dd(){const[r,e]=b.useState(null),[t,a]=b.useState(!1),[i,n]=b.useState(!1);b.useEffect(()=>{if(window.matchMedia("(display-mode: standalone)").matches){n(!0);return}const c=u=>{u.preventDefault(),e(u),setTimeout(()=>{localStorage.getItem("pwa-install-dismissed")||a(!0)},3e4)},d=()=>{n(!0),a(!1),e(null)};return window.addEventListener("beforeinstallprompt",c),window.addEventListener("appinstalled",d),()=>{window.removeEventListener("beforeinstallprompt",c),window.removeEventListener("appinstalled",d)}},[]);const o=async()=>{if(r)try{await r.prompt(),(await r.userChoice).outcome==="accepted"?console.log("User accepted PWA install"):console.log("User dismissed PWA install"),e(null),a(!1)}catch(c){console.error("Error during PWA install:",c)}},l=()=>{a(!1),localStorage.setItem("pwa-install-dismissed","true"),setTimeout(()=>{localStorage.removeItem("pwa-install-dismissed")},7*24*60*60*1e3)};return i||!t||!r?null:s.jsx("div",{className:"fixed bottom-4 left-4 right-4 z-50 md:left-auto md:right-4 md:max-w-sm",children:s.jsx(F,{className:"p-4 bg-white shadow-lg border-0 animate-in slide-in-from-bottom-4",children:s.jsxs("div",{className:"flex items-start gap-3",children:[s.jsx("div",{className:"p-2 bg-blue-50 rounded-lg flex-shrink-0",children:s.jsx(Mr,{className:"w-5 h-5 text-blue-600"})}),s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsx("h3",{className:"font-semibold text-gray-900 text-sm mb-1",children:"Install Bytewise App"}),s.jsx("p",{className:"text-xs text-gray-600 mb-3",children:"Get the full app experience with offline access and faster loading"}),s.jsxs("div",{className:"flex gap-2",children:[s.jsxs(A,{onClick:o,size:"sm",className:"flex-1 bg-blue-600 hover:bg-blue-700 text-white",children:[s.jsx(Fs,{className:"w-4 h-4 mr-1"}),"Install"]}),s.jsx(A,{onClick:l,variant:"outline",size:"sm",className:"px-3",children:s.jsx(Wt,{className:"w-4 h-4"})})]})]})]})})})}function Ud(){const[r,e]=b.useState(!1);b.useEffect(()=>{const a=/iPad|iPhone|iPod/.test(navigator.userAgent),i=/^((?!chrome|android).)*safari/i.test(navigator.userAgent),n=window.matchMedia("(display-mode: standalone)").matches;a&&i&&!n&&(localStorage.getItem("ios-install-dismissed")||setTimeout(()=>e(!0),45e3))},[]);const t=()=>{e(!1),localStorage.setItem("ios-install-dismissed","true")};return r?s.jsx("div",{className:"fixed bottom-4 left-4 right-4 z-50",children:s.jsx(F,{className:"p-4 bg-white shadow-lg border-0 animate-in slide-in-from-bottom-4",children:s.jsxs("div",{className:"flex items-start gap-3",children:[s.jsx("div",{className:"p-2 bg-green-50 rounded-lg flex-shrink-0",children:s.jsx(Fs,{className:"w-5 h-5 text-green-600"})}),s.jsxs("div",{className:"flex-1",children:[s.jsx("h3",{className:"font-semibold text-gray-900 text-sm mb-2",children:"Add to Home Screen"}),s.jsxs("div",{className:"text-xs text-gray-600 space-y-1 mb-3",children:[s.jsx("p",{children:"1. Tap the share button in Safari"}),s.jsx("p",{children:'2. Select "Add to Home Screen"'}),s.jsx("p",{children:'3. Tap "Add" to install the app'})]}),s.jsx(A,{onClick:t,variant:"outline",size:"sm",className:"w-full",children:"Got it"})]}),s.jsx(A,{onClick:t,variant:"ghost",size:"sm",className:"p-1",children:s.jsx(Wt,{className:"w-4 h-4"})})]})})}):null}const Fd=""+new URL("chocolate-1927921_1920_1753859477802-D-SPQY8I.jpg",import.meta.url).href,zd=""+new URL("cupcakes-813078_1920_1753859477803-D9uLIWdp.jpg",import.meta.url).href,Bd=""+new URL("tomatoes-1238255_1920_1753859477803-BBxmQtT1.jpg",import.meta.url).href,qd=""+new URL("spaghetti-2931846_1920_1753859477804-BSrB8P7y.jpg",import.meta.url).href,Wd=""+new URL("spaghetti-1392266_1920_1753859477805-HAisuHs3.jpg",import.meta.url).href,Gd=""+new URL("pancakes-2291908_1920_1753859477805-FMeaELmV.jpg",import.meta.url).href,Kd=""+new URL("vegetable-2924245_1920_1753859477807-CZELXr6Z.jpg",import.meta.url).href,Vd=""+new URL("grapes-2032838_1920_1753859477808-CXmP7soY.jpg",import.meta.url).href,Hd=""+new URL("churros-2188871_1920_1753859477808-BGqrIj5F.jpg",import.meta.url).href,Qd=""+new URL("macarons-2179198_1920_1753859477809-B5cbwbKS.jpg",import.meta.url).href,Jd=""+new URL("mango-1534061_1920_1753859530079-BEyrLl3D.jpg",import.meta.url).href,Yd=""+new URL("oatmeal-1839515_1920_1753859530080-Cf--RV4v.jpg",import.meta.url).href,Zd=""+new URL("pizza-2068272_1920_1753859530080-DhVI5ZGb.jpg",import.meta.url).href,Xd=""+new URL("raw-chicken-6946604_1920_1753859530081-BqlbPNnB.jpg",import.meta.url).href,eu=""+new URL("steak-6278031_1920_1753859530081-BukNuh5v.jpg",import.meta.url).href,tu=""+new URL("steak-7423231_1920_1753859530082-DBBrmAYH.jpg",import.meta.url).href,su=""+new URL("swedish-6053292_1920_1753859530083-CbbGYA9Y.jpg",import.meta.url).href,ru=""+new URL("chicken-2443901_1920_1753859530084-CTPERNUZ.jpg",import.meta.url).href,au=""+new URL("chicken-nuggets-1108_1920_1753859530084-DLWOOEId.jpg",import.meta.url).href,iu=""+new URL("salad-6948004_1920_1753859530085-1zwSa4Vt.jpg",import.meta.url).href,nu=""+new URL("fried-prawn-1737593_1920_1753859794686-DkxziorZ.jpg",import.meta.url).href,ou=""+new URL("sandwich-6935938_1920_1753859794687-CXrSzbzE.jpg",import.meta.url).href,lu=""+new URL("food-993457_1920_1753859794688-oWnyu60z.jpg",import.meta.url).href,cu=""+new URL("new-years-eve-518032_1920_1753859794689-DPPW0W6m.jpg",import.meta.url).href,du=""+new URL("chicken-762531_1920_1753859530086-BwBmOm1s.jpg",import.meta.url).href,uu=""+new URL("variety-5044809_1920_1753859530087-C7xAS9wM.jpg",import.meta.url).href,hu=""+new URL("plums-1898196_1920_1753859477809-C44a7c3I.jpg",import.meta.url).href,mu=""+new URL("strawberry-7224875_1920_1753859477810-CXpGW8lN.jpg",import.meta.url).href,Ne={chocolate:Fd,cupcakes:zd,tomatoes:Bd,spaghetti:qd,spaghetti2:Wd,pancakes:Gd,fries:Nn,blueberries:_n,vegetable:Kd,grapes:Vd,churros:Hd,macarons:Qd,apple:jn,mango:Jd,oatmeal:Yd,pizza:Zd,rawChicken:Xd,steak:eu,steak2:tu,swedish:su,burgers:kn,chicken2:ru,chickenNuggets:au,salad:iu,friedPrawn:nu,sandwich:ou,fish:lu,salmon:cu,chicken:du,foodVariety:Sn,variety:uu,plums:hu,strawberry:mu},Zr=Object.values(Ne),gu={calculator:Ne.blueberries,logger:Ne.pancakes,dashboard:Ne.salad,profile:Ne.apple,login:Ne.pizza,meals:Ne.burgers,recipes:Ne.chocolate,planning:Ne.oatmeal};function fu(){const r=new Date,e=Math.floor((r.getTime()-new Date(r.getFullYear(),0,0).getTime())/(1e3*60*60*24)),t=sessionStorage.getItem("app-session-id")||String(Date.now());return sessionStorage.getItem("app-session-id")||sessionStorage.setItem("app-session-id",t),`${e}-${t}`}function pu(r){const e=fu(),t=Array.from(e+r).reduce((a,i)=>i.charCodeAt(0)+((a<<5)-a),0);return Math.abs(t)%Zr.length}function xu(r){if(!(localStorage.getItem("food-image-rotation")!=="false"))return gu[r]||Ne.blueberries;const t=pu(r);return Zr[t]}function St(){sessionStorage.removeItem("app-session-id")}function yu(r){localStorage.setItem("food-image-rotation",r?"true":"false")}function $r(){return localStorage.getItem("food-image-rotation")!=="false"}function bu(){return Zr.length}function vu(r,e=.85){return{backgroundImage:`linear-gradient(rgba(248, 250, 252, ${e}), rgba(248, 250, 252, ${e})), url("${r}")`,backgroundSize:"cover",backgroundPosition:"center",backgroundRepeat:"no-repeat"}}function wu(){return b.useEffect(()=>{if(!$r())return;const r=()=>{if(document.visibilityState==="visible"){const n=sessionStorage.getItem("app-last-hidden"),o=Date.now();n&&o-parseInt(n)>3e4&&St()}else sessionStorage.setItem("app-last-hidden",String(Date.now()))},e=()=>{St()},t=()=>{const n=sessionStorage.getItem("app-last-blur"),o=Date.now();n&&o-parseInt(n)>6e4&&St()},a=()=>{sessionStorage.setItem("app-last-blur",String(Date.now()))},i=()=>{sessionStorage.getItem("session-start-time")||(sessionStorage.setItem("session-start-time",String(Date.now())),St())};return document.addEventListener("visibilitychange",r),window.addEventListener("beforeunload",e),window.addEventListener("focus",t),window.addEventListener("blur",a),i(),()=>{document.removeEventListener("visibilitychange",r),window.removeEventListener("beforeunload",e),window.removeEventListener("focus",t),window.removeEventListener("blur",a)}},[]),{resetRotation:St,isRotationEnabled:$r}}function Bs({title:r,subtitle:e,caloriesConsumed:t=0,caloriesGoal:a=2e3,currentStreak:i=0,showProgress:n=!0,className:o="",component:l="dashboard",stats:c=[]}){const d=Math.min(t/a*100,100),u=xu(l);return s.jsxs("div",{className:`relative bg-gradient-to-br from-[var(--pastel-blue)] to-[var(--pastel-blue-dark)] text-white px-4 py-8 overflow-hidden ${o}`,style:{minHeight:"280px",paddingTop:"1.5rem"},children:[s.jsx("div",{className:"absolute inset-0 opacity-30",style:vu(u,.15)}),s.jsx("div",{className:"relative z-10",children:s.jsxs("div",{className:"max-w-md mx-auto",children:[s.jsxs("div",{className:"text-center mb-6",children:[s.jsx("h1",{className:"text-3xl font-bold mb-3",children:r}),e&&s.jsx("p",{className:"text-blue-100 text-base font-semibold opacity-95",children:e})]}),n&&s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"flex justify-center mb-6",children:s.jsxs("div",{className:"relative w-32 h-32",children:[s.jsxs("svg",{className:"w-32 h-32 transform -rotate-90",viewBox:"0 0 100 100",children:[s.jsx("circle",{cx:"50",cy:"50",r:"40",stroke:"rgba(255,255,255,0.2)",strokeWidth:"8",fill:"transparent"}),s.jsx("circle",{cx:"50",cy:"50",r:"40",stroke:"white",strokeWidth:"8",fill:"transparent",strokeDasharray:`${d*2.51} 251`,strokeLinecap:"round",className:"transition-all duration-500"})]}),s.jsx("div",{className:"absolute inset-0 flex flex-col items-center justify-center",children:s.jsxs("div",{className:"text-center",children:[s.jsxs("p",{className:"text-3xl font-bold",children:[Math.round(d),"%"]}),s.jsx("p",{className:"text-sm text-blue-100 font-medium",children:"Daily Goal"})]})})]})}),s.jsxs("div",{className:"grid grid-cols-3 gap-3",children:[s.jsxs(F,{className:"p-4 bg-white/10 backdrop-blur-sm border-0 text-center",children:[s.jsx(ue,{className:"w-6 h-6 mx-auto text-orange-300 mb-2"}),s.jsx("p",{className:"text-xl font-bold",children:t}),s.jsx("p",{className:"text-sm text-blue-100 font-medium",children:"Consumed"})]}),s.jsxs(F,{className:"p-4 bg-white/10 backdrop-blur-sm border-0 text-center",children:[s.jsx(he,{className:"w-6 h-6 mx-auto text-green-300 mb-2"}),s.jsx("p",{className:"text-xl font-bold",children:a}),s.jsx("p",{className:"text-sm text-blue-100 font-medium",children:"Goal"})]}),s.jsxs(F,{className:"p-4 bg-white/10 backdrop-blur-sm border-0 text-center",children:[s.jsx(ft,{className:"w-6 h-6 mx-auto text-yellow-300 mb-2"}),s.jsx("p",{className:"text-xl font-bold",children:i}),s.jsx("p",{className:"text-sm text-blue-100 font-medium",children:"Day Streak"})]})]})]}),c.length>0&&s.jsx("div",{className:"grid grid-cols-3 gap-3 mt-6",children:c.map((h,g)=>{const f=h.icon;return s.jsxs("div",{className:"text-center",children:[s.jsx("div",{className:`p-3 ${h.bgColor} rounded-lg mb-3 mx-auto w-fit`,children:s.jsx(f,{className:`w-6 h-6 ${h.color}`})}),s.jsx("div",{className:"text-xl font-bold",children:h.value}),s.jsx("div",{className:"text-sm text-blue-100 font-medium",children:h.label})]},g)})})]})})]})}function Xr(){const[r,e]=b.useState([]),[t,a]=b.useState(0),i=pt(),n=Li({mutationFn:async u=>{const h=JSON.parse(localStorage.getItem("weeklyMeals")||"[]"),g={name:u.name,calories:u.calories,protein:u.protein,carbs:u.carbs,fat:u.fat,date:u.date,time:u.time.replace(/:\d\d$/,""),category:l(),timestamp:new Date().toISOString(),source:"calculator",mealType:l()};return h.push(g),localStorage.setItem("weeklyMeals",JSON.stringify(h)),console.log("Calories logged from calculator:",g),console.log("Successfully logged to weekly "+l()+":",{name:g.name,calories:g.calories,protein:g.protein,carbs:g.carbs,fat:g.fat,date:g.date,time:g.time,category:g.category}),g},onSuccess:()=>{i.invalidateQueries({queryKey:["weeklyMeals"]})}}),o=b.useCallback(u=>{const h={...u,id:Date.now().toString(),date:new Date().toISOString().split("T")[0],time:new Date().toLocaleTimeString(),source:"calculator"};e(x=>[...x,h]),a(x=>x+u.calories);const g=localStorage.getItem("calculatedCalories"),f=g?JSON.parse(g):[];return localStorage.setItem("calculatedCalories",JSON.stringify([...f,h])),console.log("Added calculated calories:",h),h},[n]),l=()=>{const u=new Date().getHours();return u>=5&&u<11?"breakfast":u>=11&&u<16?"lunch":u>=16&&u<21?"dinner":"snack"},c=b.useCallback(()=>{const u=new Date().toISOString().split("T")[0];return r.filter(h=>h.date===u)},[r]),d=b.useCallback(()=>c().reduce((h,g)=>({calories:h.calories+g.calories,protein:h.protein+g.protein,carbs:h.carbs+g.carbs,fat:h.fat+g.fat,count:h.count+1}),{calories:0,protein:0,carbs:0,fat:0,count:0}),[c]);return{calculatedCalories:r,dailyTotal:t,addCalculatedCalories:o,logCaloriesMutation:n,getTodaysCalories:c,getDailyStats:d}}function Ya({onNavigate:r}){const{getDailyStats:e,getTodaysCalories:t}=Xr(),a=e(),i=t(),{data:n}=Et({queryKey:["/api/auth/user"],retry:!1}),{data:o}=Et({queryKey:["/api/meals/logged"],retry:!1}),[l,c]=b.useState({name:"User",currentStreak:0,caloriesConsumed:0,caloriesGoal:2200,proteinConsumed:0,proteinGoal:120,carbsConsumed:0,carbsGoal:300,fatConsumed:0,fatGoal:70,waterConsumed:0,waterGoal:8});b.useEffect(()=>{const N=a.calories||0,_=Array.isArray(o)?o.reduce((_e,j)=>_e+(parseFloat(j.calories)||0),0):0,k=a.protein||0,S=Array.isArray(o)?o.reduce((_e,j)=>_e+(parseFloat(j.protein)||0),0):0,L=a.carbs||0,P=Array.isArray(o)?o.reduce((_e,j)=>_e+(parseFloat(j.carbs)||0),0):0,q=a.fat||0,ce=Array.isArray(o)?o.reduce((_e,j)=>_e+(parseFloat(j.fat)||0),0):0,gs={name:(n==null?void 0:n.firstName)||"User",currentStreak:0,caloriesConsumed:Math.round(N+_),proteinConsumed:Math.round(k+S),carbsConsumed:Math.round(L+P),fatConsumed:Math.round(q+ce),caloriesGoal:(n==null?void 0:n.dailyCalorieGoal)||2200,proteinGoal:(n==null?void 0:n.dailyProteinGoal)||120,carbsGoal:(n==null?void 0:n.dailyCarbGoal)||300,fatGoal:(n==null?void 0:n.dailyFatGoal)||70,waterConsumed:0,waterGoal:(n==null?void 0:n.dailyWaterGoal)||8};c(gs)},[a.calories,a.protein,a.carbs,a.fat,o,n==null?void 0:n.firstName,n==null?void 0:n.dailyCalorieGoal,n==null?void 0:n.dailyProteinGoal,n==null?void 0:n.dailyCarbGoal,n==null?void 0:n.dailyFatGoal,n==null?void 0:n.dailyWaterGoal]);const d=Array.isArray(o)?o.filter(N=>{var S;const _=N.date||((S=N.created_at)==null?void 0:S.split("T")[0]),k=new Date().toISOString().split("T")[0];return _===k}):[],u=i.map(N=>({name:N.name,time:N.time,calories:N.calories,type:"calculated",source:"calculator",color:"from-blue-100 to-blue-200"})),g=[...d.map(N=>({name:N.name||"Logged Meal",time:N.time||new Date(N.created_at).toLocaleTimeString(),calories:Math.round(parseFloat(N.totalCalories)||N.calories||0),type:N.mealType||N.type||"meal",source:"logger",color:"from-green-100 to-green-200"})),...u].sort((N,_)=>{const k=new Date(`1970-01-01 ${N.time}`).getTime(),S=new Date(`1970-01-01 ${_.time}`).getTime();return k-S});Et({queryKey:["/api/achievements"],retry:!1});const f=Math.round(l.caloriesConsumed/l.caloriesGoal*100),x=Math.round(l.proteinConsumed/l.proteinGoal*100),y=Math.round(l.carbsConsumed/l.carbsGoal*100),p=Math.round(l.fatConsumed/l.fatGoal*100),w=Math.round(l.waterConsumed/l.waterGoal*100),v=(()=>{const N=[];return f>=100&&N.push({id:1,title:"Daily Goal",icon:he,color:"text-green-500"}),x>=100&&N.push({id:2,title:"Protein Power",icon:Tr,color:"text-red-500"}),l.currentStreak>=7&&N.push({id:3,title:"Week Warrior",icon:ue,color:"text-orange-500"}),g.length>=3&&N.push({id:4,title:"Meal Master",icon:Pe,color:"text-blue-500"}),u.length>=2&&N.push({id:5,title:"Calculator Pro",icon:he,color:"text-purple-500"}),d.length>=2&&N.push({id:6,title:"Logger Champion",icon:Te,color:"text-indigo-500"}),N.slice(0,3)})(),C={calculatorEntries:i.length,calculatorCalories:a.calories,mealEntries:Array.isArray(o)?o.length:0,lastUpdate:new Date().toLocaleTimeString()};return s.jsxs("div",{className:"flex flex-col min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100",children:[s.jsx(Bs,{title:`Good morning, ${l.name}!`,subtitle:"Keep up your amazing progress",component:"dashboard",caloriesConsumed:l.caloriesConsumed,caloriesGoal:l.caloriesGoal,currentStreak:l.currentStreak}),s.jsxs("div",{className:"flex-1 max-w-md mx-auto w-full px-3 py-6 space-y-6",children:[s.jsxs(F,{className:"p-6 bg-white/80 backdrop-blur-sm border-0 shadow-lg",children:[s.jsxs("div",{className:"flex items-center justify-between mb-4",children:[s.jsx("h3",{className:"text-lg font-bold text-gray-900",children:"Daily Nutrition Overview"}),s.jsxs(U,{variant:"outline",className:"text-xs",children:[" Calculator: ",C.calculatorEntries,"  Logger: ",C.mealEntries]})]}),s.jsxs("div",{className:"bg-blue-50 p-3 rounded-lg mb-4",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(ue,{className:"w-4 h-4 text-blue-600"}),s.jsx("span",{className:"text-sm font-medium text-blue-900",children:"Live Data Sources"})]}),s.jsxs("div",{className:"text-xs text-blue-700 mt-1",children:["Calculator: ",Math.round(C.calculatorCalories)," cal  Last update: ",C.lastUpdate]})]}),s.jsxs("div",{className:"grid grid-cols-4 gap-3 mb-6",children:[s.jsxs("div",{className:"text-center p-3 bg-red-50 rounded-lg",children:[s.jsx("div",{className:"p-2 bg-red-100 rounded-lg w-fit mx-auto mb-2",children:s.jsx(Tr,{className:"w-4 h-4 text-red-600"})}),s.jsxs("div",{className:"text-xl font-bold text-red-600",children:[l.proteinConsumed,"g"]}),s.jsx("div",{className:"text-xs text-gray-600 mb-2",children:"Protein"}),s.jsx("div",{className:"h-16 w-3 bg-gray-200 rounded-full mx-auto mb-2 relative",children:s.jsx("div",{className:"bg-red-500 w-full rounded-full absolute bottom-0 transition-all duration-500",style:{height:`${Math.min(x,100)}%`}})}),s.jsxs("div",{className:"text-xs text-gray-500",children:[l.proteinGoal,"g"]})]}),s.jsxs("div",{className:"text-center p-3 bg-yellow-50 rounded-lg",children:[s.jsx("div",{className:"p-2 bg-yellow-100 rounded-lg w-fit mx-auto mb-2",children:s.jsx(Te,{className:"w-4 h-4 text-yellow-600"})}),s.jsxs("div",{className:"text-xl font-bold text-yellow-600",children:[l.carbsConsumed,"g"]}),s.jsx("div",{className:"text-xs text-gray-600 mb-2",children:"Carbs"}),s.jsx("div",{className:"h-16 w-3 bg-gray-200 rounded-full mx-auto mb-2 relative",children:s.jsx("div",{className:"bg-yellow-500 w-full rounded-full absolute bottom-0 transition-all duration-500",style:{height:`${Math.min(y,100)}%`}})}),s.jsxs("div",{className:"text-xs text-gray-500",children:[l.carbsGoal,"g"]})]}),s.jsxs("div",{className:"text-center p-3 bg-green-50 rounded-lg",children:[s.jsx("div",{className:"p-2 bg-green-100 rounded-lg w-fit mx-auto mb-2",children:s.jsx(Or,{className:"w-4 h-4 text-green-600"})}),s.jsxs("div",{className:"text-xl font-bold text-green-600",children:[l.fatConsumed,"g"]}),s.jsx("div",{className:"text-xs text-gray-600 mb-2",children:"Fat"}),s.jsx("div",{className:"h-16 w-3 bg-gray-200 rounded-full mx-auto mb-2 relative",children:s.jsx("div",{className:"bg-green-500 w-full rounded-full absolute bottom-0 transition-all duration-500",style:{height:`${Math.min(p,100)}%`}})}),s.jsxs("div",{className:"text-xs text-gray-500",children:[l.fatGoal,"g"]})]}),s.jsxs("div",{className:"text-center p-3 bg-blue-50 rounded-lg",children:[s.jsx("div",{className:"p-2 bg-blue-100 rounded-lg w-fit mx-auto mb-2",children:s.jsx(Or,{className:"w-4 h-4 text-blue-600"})}),s.jsx("div",{className:"text-xl font-bold text-blue-600",children:l.waterConsumed}),s.jsx("div",{className:"text-xs text-gray-600 mb-2",children:"Water"}),s.jsx("div",{className:"h-16 w-3 bg-gray-200 rounded-full mx-auto mb-2 relative",children:s.jsx("div",{className:"bg-blue-500 w-full rounded-full absolute bottom-0 transition-all duration-500",style:{height:`${Math.min(w,100)}%`}})}),s.jsxs("div",{className:"text-xs text-gray-500",children:[l.waterGoal," cups"]})]})]}),s.jsxs("div",{className:"border-t pt-4",children:[s.jsx("h4",{className:"font-semibold text-gray-900 mb-3",children:"Key Micronutrients"}),s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[s.jsxs("div",{className:"flex items-center justify-between p-3 bg-green-50 rounded-lg",children:[s.jsxs("div",{children:[s.jsx("div",{className:"font-medium text-gray-900",children:"Fiber"}),s.jsx("div",{className:"text-sm text-gray-600",children:"28g / 35g"})]}),s.jsx("div",{className:"text-green-600 font-bold",children:"80%"})]}),s.jsxs("div",{className:"flex items-center justify-between p-3 bg-blue-50 rounded-lg",children:[s.jsxs("div",{children:[s.jsx("div",{className:"font-medium text-gray-900",children:"Sodium"}),s.jsx("div",{className:"text-sm text-gray-600",children:"1,890mg / 2,300mg"})]}),s.jsx("div",{className:"text-blue-600 font-bold",children:"82%"})]}),s.jsxs("div",{className:"flex items-center justify-between p-3 bg-orange-50 rounded-lg",children:[s.jsxs("div",{children:[s.jsx("div",{className:"font-medium text-gray-900",children:"Vitamin C"}),s.jsx("div",{className:"text-sm text-gray-600",children:"67mg / 90mg"})]}),s.jsx("div",{className:"text-orange-600 font-bold",children:"74%"})]}),s.jsxs("div",{className:"flex items-center justify-between p-3 bg-indigo-50 rounded-lg",children:[s.jsxs("div",{children:[s.jsx("div",{className:"font-medium text-gray-900",children:"Iron"}),s.jsx("div",{className:"text-sm text-gray-600",children:"12mg / 18mg"})]}),s.jsx("div",{className:"text-indigo-600 font-bold",children:"67%"})]})]})]})]}),s.jsxs(F,{className:"p-6 bg-white/80 backdrop-blur-sm border-0 shadow-lg",children:[s.jsxs("div",{className:"flex items-center justify-between mb-4",children:[s.jsx("h3",{className:"text-lg font-bold text-gray-900",children:"Today's Meals"}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsxs(U,{variant:"outline",className:"text-xs",children:[" ",g.length," entries"]}),s.jsxs(A,{variant:"ghost",size:"sm",onClick:()=>r("calculator"),className:"text-blue-600 hover:text-blue-700",children:[s.jsx(qt,{className:"w-4 h-4 mr-1"}),"Add Meal"]})]})]}),s.jsxs("div",{className:"bg-green-50 p-3 rounded-lg mb-4",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(Te,{className:"w-4 h-4 text-green-600"}),s.jsx("span",{className:"text-sm font-medium text-green-900",children:"Live Data Connection"})]}),s.jsxs("div",{className:"text-xs text-green-700 mt-1",children:["Calculator: ",u.length,"  Logger: ",d.length,"  Last sync: ",C.lastUpdate]})]}),s.jsx("div",{className:"space-y-3",children:g.length>0?g.map((N,_)=>s.jsxs("div",{className:`flex items-center justify-between p-3 bg-gradient-to-r ${N.color} rounded-lg border`,children:[s.jsxs("div",{className:"flex items-center space-x-3",children:[s.jsx("div",{className:"p-2 bg-white rounded-lg shadow-sm",children:N.source==="calculator"?s.jsx(he,{className:"w-4 h-4 text-blue-600"}):s.jsx(Pe,{className:"w-4 h-4 text-green-600"})}),s.jsxs("div",{children:[s.jsx("p",{className:"font-medium text-gray-900",children:N.name}),s.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-600",children:[s.jsx("span",{children:N.time}),s.jsx(U,{variant:"outline",className:"text-xs",children:N.source==="calculator"?" Calc":" Logger"})]})]})]}),s.jsxs(U,{variant:"secondary",className:"bg-white",children:[N.calories," cal"]})]},_)):s.jsxs("div",{className:"text-center py-8",children:[s.jsx(Pe,{className:"w-12 h-12 text-gray-300 mx-auto mb-3"}),s.jsx("p",{className:"text-gray-500 mb-2",children:"No meals logged today"}),s.jsx("p",{className:"text-sm text-gray-400",children:"Use the calculator or logger to add entries"})]})})]}),s.jsxs(F,{className:"p-6 bg-white/80 backdrop-blur-sm border-0 shadow-lg",children:[s.jsxs("div",{className:"flex items-center justify-between mb-4",children:[s.jsx("h3",{className:"text-lg font-bold text-gray-900",children:"Recent Achievements"}),s.jsxs(U,{variant:"outline",className:"text-xs",children:[" ",v.length," earned today"]})]}),s.jsxs("div",{className:"bg-yellow-50 p-3 rounded-lg mb-4",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(ht,{className:"w-4 h-4 text-yellow-600"}),s.jsx("span",{className:"text-sm font-medium text-yellow-900",children:"Achievement System Active"})]}),s.jsxs("div",{className:"text-xs text-yellow-700 mt-1",children:["Tracking daily & weekly nutrition goals  Next reward at ",Math.max(100-f,0),"% progress"]})]}),s.jsx("div",{className:"grid grid-cols-3 gap-4",children:v.length>0?v.map(N=>{const _=N.icon;return s.jsxs("div",{className:"text-center",children:[s.jsx("div",{className:"p-3 bg-gradient-to-br from-yellow-50 to-yellow-100 rounded-lg mb-2 mx-auto w-fit border border-yellow-200",children:s.jsx(_,{className:`w-6 h-6 ${N.color}`})}),s.jsx("p",{className:"text-xs font-medium text-gray-700",children:N.title}),s.jsx("div",{className:"w-2 h-2 bg-green-500 rounded-full mx-auto mt-1"})]},N.id)}):s.jsxs("div",{className:"col-span-3 text-center py-4",children:[s.jsx(ht,{className:"w-12 h-12 text-gray-300 mx-auto mb-2"}),s.jsx("p",{className:"text-gray-500 text-sm",children:"Complete nutrition goals to earn achievements"}),s.jsx("p",{className:"text-xs text-gray-400 mt-1",children:"Track calories & meet daily targets"})]})}),s.jsxs("div",{className:"mt-4 pt-4 border-t border-gray-200",children:[s.jsx("div",{className:"text-xs text-gray-600 mb-2",children:"Today's Progress"}),s.jsxs("div",{className:"grid grid-cols-2 gap-2 text-xs",children:[s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{children:"Calories:"}),s.jsxs("span",{className:f>=100?"text-green-600 font-medium":"text-gray-600",children:[f,"%"]})]}),s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{children:"Protein:"}),s.jsxs("span",{className:x>=100?"text-green-600 font-medium":"text-gray-600",children:[x,"%"]})]}),s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{children:"Meals logged:"}),s.jsxs("span",{className:g.length>=3?"text-green-600 font-medium":"text-gray-600",children:[g.length,"/3"]})]}),s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{children:"Streak:"}),s.jsxs("span",{className:l.currentStreak>=7?"text-green-600 font-medium":"text-gray-600",children:[l.currentStreak," days"]})]})]})]})]}),s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[s.jsxs(A,{onClick:()=>r("calculator"),className:"h-16 bg-gradient-to-r from-green-500 to-green-600 hover:from-green-600 hover:to-green-700 text-white border-0 shadow-lg",children:[s.jsx(qt,{className:"w-5 h-5 mr-2"}),"Calculate Calories"]}),s.jsxs(A,{onClick:()=>r("logger"),variant:"outline",className:"h-16 bg-white/80 backdrop-blur-sm border-gray-200 shadow-lg hover:bg-white",children:[s.jsx(Te,{className:"w-5 h-5 mr-2"}),"Weekly Logger"]})]})]})]})}const ju=Jn,_u=Yn,Tn=b.forwardRef(({className:r,children:e,...t},a)=>s.jsxs(mi,{ref:a,className:H("flex h-10 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background data-[placeholder]:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1",r),...t,children:[e,s.jsx(Gn,{asChild:!0,children:s.jsx(Vr,{className:"h-4 w-4 opacity-50"})})]}));Tn.displayName=mi.displayName;const Pn=b.forwardRef(({className:r,...e},t)=>s.jsx(gi,{ref:t,className:H("flex cursor-default items-center justify-center py-1",r),...e,children:s.jsx(pn,{className:"h-4 w-4"})}));Pn.displayName=gi.displayName;const In=b.forwardRef(({className:r,...e},t)=>s.jsx(fi,{ref:t,className:H("flex cursor-default items-center justify-center py-1",r),...e,children:s.jsx(Vr,{className:"h-4 w-4"})}));In.displayName=fi.displayName;const An=b.forwardRef(({className:r,children:e,position:t="popper",...a},i)=>s.jsx(Kn,{children:s.jsxs(pi,{ref:i,className:H("relative z-50 max-h-[--radix-select-content-available-height] min-w-[8rem] overflow-y-auto overflow-x-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-select-content-transform-origin]",t==="popper"&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",r),position:t,...a,children:[s.jsx(Pn,{}),s.jsx(Vn,{className:H("p-1",t==="popper"&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:e}),s.jsx(In,{})]})}));An.displayName=pi.displayName;const Nu=b.forwardRef(({className:r,...e},t)=>s.jsx(xi,{ref:t,className:H("py-1.5 pl-8 pr-2 text-sm font-semibold",r),...e}));Nu.displayName=xi.displayName;const On=b.forwardRef(({className:r,children:e,...t},a)=>s.jsxs(yi,{ref:a,className:H("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",r),...t,children:[s.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:s.jsx(Hn,{children:s.jsx(yd,{className:"h-4 w-4"})})}),s.jsx(Qn,{children:e})]}));On.displayName=yi.displayName;const ku=b.forwardRef(({className:r,...e},t)=>s.jsx(bi,{ref:t,className:H("-mx-1 my-1 h-px bg-muted",r),...e}));ku.displayName=bi.displayName;const js={categories:{Flours:{all_purpose_flour:{displayName:"All-Purpose Flour",aliases:["AP flour","plain flour","all purpose"],usdaQuery:"all purpose flour",units:{cup:120,"3/4_cup":105,"2/3_cup":93,"1/2_cup":70,"1/3_cup":47,"1/4_cup":35,"1/8_cup":18,tbsp:9,tsp:3,oz:28.35,lb:454,g:1},tags:{isCommon:!0,densityType:"dry",dietType:["vegetarian","vegan"],categoryColor:"#F4E1A1"}},bread_flour:{displayName:"Bread Flour",aliases:["high protein flour","strong flour"],usdaQuery:"bread flour",units:{cup:127,"3/4_cup":95,"1/2_cup":64,"1/3_cup":42,"1/4_cup":32,tbsp:8,tsp:2.7,oz:28,lb:454,g:1},tags:{isCommon:!0,densityType:"dry",dietType:["vegetarian","vegan"],categoryColor:"#F4E1A1"}},cake_flour:{displayName:"Cake Flour",aliases:["pastry flour","soft flour"],usdaQuery:"cake flour",units:{cup:114,"3/4_cup":86,"1/2_cup":57,"1/3_cup":38,"1/4_cup":29,tbsp:7,tsp:2.4,oz:28,lb:454,g:1},tags:{isCommon:!0,densityType:"dry",dietType:["vegetarian","vegan"],categoryColor:"#F4E1A1"}},whole_wheat_flour:{displayName:"Whole Wheat Flour",aliases:["whole grain flour","wholemeal flour"],usdaQuery:"whole wheat flour",units:{cup:113,"3/4_cup":85,"1/2_cup":57,"1/3_cup":38,"1/4_cup":28,tbsp:7,tsp:2.3,oz:28,lb:454,g:1},tags:{isCommon:!0,densityType:"dry",dietType:["vegetarian","vegan"],categoryColor:"#F4E1A1"}}},"Oils & Fats":{olive_oil:{displayName:"Olive Oil",aliases:["extra virgin olive oil","EVOO"],usdaQuery:"olive oil",units:{cup:216,"3/4_cup":162,"2/3_cup":144,"1/2_cup":108,"1/3_cup":72,"1/4_cup":54,tbsp:14,tsp:5,fl_oz:30,ml:.92,l:920,g:1},tags:{isCommon:!0,densityType:"liquid",dietType:["vegetarian","vegan","keto"],categoryColor:"#FFD580"}},butter:{displayName:"Butter",aliases:["unsalted butter","salted butter"],usdaQuery:"butter",units:{cup:227,"3/4_cup":170,"2/3_cup":151,"1/2_cup":113,"1/3_cup":76,"1/4_cup":57,tbsp:14,tsp:5,stick:113,oz:28,lb:454,g:1},tags:{isCommon:!0,densityType:"solid",dietType:["vegetarian"],categoryColor:"#FFD580"}},coconut_oil:{displayName:"Coconut Oil",aliases:["virgin coconut oil","refined coconut oil"],usdaQuery:"coconut oil",units:{cup:218,"3/4_cup":164,"1/2_cup":109,"1/3_cup":73,"1/4_cup":55,tbsp:14,tsp:5,oz:28,lb:454,g:1},tags:{isCommon:!0,densityType:"solid",dietType:["vegetarian","vegan","keto"],categoryColor:"#FFD580"}}},"Dairy & Eggs":{egg_large:{displayName:"Egg (Large)",aliases:["large egg","whole egg"],usdaQuery:"egg large",units:{piece:55,cup:275,"1/2_cup":138,"1/4_cup":69,yolk:20,white:35,dozen:660,g:1},tags:{isCommon:!0,densityType:"solid",dietType:["vegetarian"],categoryColor:"#FDD692"}},milk_whole:{displayName:"Milk (Whole)",aliases:["whole milk","3.25% milk"],usdaQuery:"milk whole",units:{cup:244,"3/4_cup":183,"2/3_cup":163,"1/2_cup":122,"1/3_cup":81,"1/4_cup":61,"1/8_cup":30,tbsp:15,tsp:5,fl_oz:30,pt:488,qt:976,gal:3904,ml:1.03,l:1030,g:1},tags:{isCommon:!0,densityType:"liquid",dietType:["vegetarian"],categoryColor:"#FDD692"}},heavy_cream:{displayName:"Heavy Cream",aliases:["heavy whipping cream","double cream"],usdaQuery:"heavy cream",units:{cup:240,"3/4_cup":180,"1/2_cup":120,"1/3_cup":80,"1/4_cup":60,tbsp:15,tsp:5,fl_oz:30,ml:.98,g:1},tags:{isCommon:!0,densityType:"liquid",dietType:["vegetarian","keto"],categoryColor:"#FDD692"}},cheddar_cheese:{displayName:"Cheddar Cheese",aliases:["sharp cheddar","mild cheddar"],usdaQuery:"cheddar cheese",units:{cup_shredded:113,"1/2_cup_shredded":57,"1/4_cup_shredded":28,oz:28,slice:28,lb:454,g:1},tags:{isCommon:!0,densityType:"solid",dietType:["vegetarian"],categoryColor:"#FDD692"}}},"Sugars & Sweeteners":{granulated_sugar:{displayName:"Granulated Sugar",aliases:["white sugar","table sugar","refined sugar"],usdaQuery:"sugar granulated",units:{cup:198,"3/4_cup":150,"2/3_cup":133,"1/2_cup":100,"1/3_cup":67,"1/4_cup":50,"1/8_cup":25,tbsp:13,tsp:4,oz:28.35,lb:454,g:1},tags:{isCommon:!0,densityType:"dry",dietType:["vegetarian","vegan"],categoryColor:"#F8E8FF"}},brown_sugar:{displayName:"Brown Sugar (Packed)",aliases:["light brown sugar","dark brown sugar"],usdaQuery:"brown sugar",units:{cup_packed:213,"3/4_cup_packed":165,"2/3_cup_packed":145,"1/2_cup_packed":110,"1/3_cup_packed":75,"1/4_cup_packed":55,tbsp:15,tsp:5,oz:28.35,lb:454,g:1},tags:{isCommon:!0,densityType:"dry",dietType:["vegetarian","vegan"],categoryColor:"#F8E8FF"}},honey:{displayName:"Honey",aliases:["pure honey","raw honey"],usdaQuery:"honey",units:{cup:320,"3/4_cup":240,"2/3_cup":213,"1/2_cup":160,"1/3_cup":107,"1/4_cup":80,tbsp:20,tsp:7,oz:28.35,lb:454,g:1},tags:{isCommon:!0,densityType:"liquid",dietType:["vegetarian"],categoryColor:"#F8E8FF"}},powdered_sugar:{displayName:"Powdered Sugar",aliases:["confectioners sugar","icing sugar"],usdaQuery:"powdered sugar",units:{cup:160,"3/4_cup":120,"2/3_cup":107,"1/2_cup":80,"1/3_cup":53,"1/4_cup":40,tbsp:10,tsp:3.3,oz:28.35,lb:454,g:1},tags:{isCommon:!0,densityType:"dry",dietType:["vegetarian","vegan"],categoryColor:"#F8E8FF"}},maple_syrup:{displayName:"Maple Syrup",aliases:["pure maple syrup","real maple syrup"],usdaQuery:"maple syrup",units:{cup:312,"3/4_cup":234,"2/3_cup":208,"1/2_cup":156,"1/3_cup":104,"1/4_cup":78,tbsp:20,tsp:7,oz:28.35,lb:454,g:1},tags:{isCommon:!0,densityType:"liquid",dietType:["vegetarian","vegan"],categoryColor:"#F8E8FF"}}},Grains:{white_rice:{displayName:"White Rice",aliases:["long grain rice","jasmine rice"],usdaQuery:"white rice cooked",units:{cup_cooked:158,cup_dry:185,"3/4_cup_cooked":119,"1/2_cup_cooked":79,"1/3_cup_cooked":53,"1/4_cup_cooked":40,tbsp:10,oz:28,lb:454,g:1},tags:{isCommon:!0,densityType:"solid",dietType:["vegetarian","vegan"],categoryColor:"#F4E4BC"}},quinoa:{displayName:"Quinoa",aliases:["cooked quinoa","quinoa grain"],usdaQuery:"quinoa cooked",units:{cup_cooked:185,cup_dry:170,"1/2_cup_cooked":93,"1/3_cup_cooked":62,"1/4_cup_cooked":46,oz:28,lb:454,g:1},tags:{isCommon:!0,densityType:"solid",dietType:["vegetarian","vegan","gluten-free"],categoryColor:"#F4E4BC"}},oats:{displayName:"Rolled Oats",aliases:["old fashioned oats","oatmeal","quick oats"],usdaQuery:"oats rolled dry",units:{cup:81,"3/4_cup":61,"1/2_cup":41,"1/3_cup":27,"1/4_cup":20,tbsp:5,tsp:1.7,oz:28,lb:454,g:1},tags:{isCommon:!0,densityType:"dry",dietType:["vegetarian","vegan","gluten-free"],categoryColor:"#F4E4BC"}}},"Nuts & Seeds":{almonds:{displayName:"Almonds",aliases:["raw almonds","whole almonds"],usdaQuery:"almonds raw",units:{cup_whole:142,cup_sliced:100,cup_slivered:108,"1/2_cup_whole":71,"1/4_cup_whole":36,tbsp:9,oz:28.35,"23_almonds":28,handful:28,lb:454,g:1},tags:{isCommon:!0,densityType:"solid",dietType:["vegetarian","vegan","keto","gluten-free"],categoryColor:"#D4A574"}},walnuts:{displayName:"Walnuts",aliases:["english walnuts","walnut halves"],usdaQuery:"walnuts english",units:{cup_halves:90,cup_chopped:113,"3/4_cup_halves":68,"2/3_cup_halves":60,"1/2_cup_halves":45,"1/3_cup_halves":30,"1/4_cup_halves":23,tbsp:7,oz:28.35,lb:454,g:1},tags:{isCommon:!0,densityType:"solid",dietType:["vegetarian","vegan","keto","gluten-free"],categoryColor:"#D4A574"}},peanut_butter:{displayName:"Peanut Butter",aliases:["smooth peanut butter","creamy peanut butter"],usdaQuery:"peanut butter",units:{cup:270,"3/4_cup":203,"1/2_cup":135,"1/3_cup":90,"1/4_cup":68,tbsp:17,tsp:6,oz:28.35,lb:454,g:1},tags:{isCommon:!0,densityType:"solid",dietType:["vegetarian","vegan"],categoryColor:"#D4A574"}},sesame_seeds:{displayName:"Sesame Seeds",aliases:["white sesame seeds","hulled sesame seeds"],usdaQuery:"sesame seeds",units:{cup:144,"1/2_cup":71,"1/4_cup":36,tbsp:9,tsp:3,oz:28.35,lb:454,g:1},tags:{isCommon:!0,densityType:"solid",dietType:["vegetarian","vegan","keto"],categoryColor:"#D4A574"}}},"Baking Ingredients":{cocoa_powder:{displayName:"Cocoa Powder (Unsweetened)",aliases:["unsweetened cocoa","cocoa powder"],usdaQuery:"cocoa powder unsweetened",units:{cup:100,"3/4_cup":75,"2/3_cup":67,"1/2_cup":50,"1/3_cup":33,"1/4_cup":25,tbsp:6,tsp:2,oz:28.35,lb:454,g:1},tags:{isCommon:!0,densityType:"dry",dietType:["vegetarian","vegan"],categoryColor:"#8B4513"}},baking_powder:{displayName:"Baking Powder",aliases:["double acting baking powder"],usdaQuery:"baking powder",units:{tbsp:12,"2.5_tsp":10,"2_tsp":8,"1.75_tsp":7,"1.5_tsp":6,"1.25_tsp":5,tsp:4,"0.75_tsp":3,"0.5_tsp":2,"0.25_tsp":1,oz:28.35,g:1},tags:{isCommon:!0,densityType:"dry",dietType:["vegetarian","vegan"],categoryColor:"#FFF8DC"}},baking_soda:{displayName:"Baking Soda",aliases:["sodium bicarbonate"],usdaQuery:"baking soda",units:{tbsp:20,"2_tsp":14,"1.75_tsp":12,"1.5_tsp":10,"1.25_tsp":9,tsp:7,"0.75_tsp":5,"0.5_tsp":3,"0.25_tsp":2,oz:28.35,g:1},tags:{isCommon:!0,densityType:"dry",dietType:["vegetarian","vegan"],categoryColor:"#FFF8DC"}},vanilla_extract:{displayName:"Vanilla Extract",aliases:["pure vanilla extract"],usdaQuery:"vanilla extract",units:{tbsp:14,tsp:5,"0.5_tsp":2.5,fl_oz:30,ml:1,oz:28.35,g:1},tags:{isCommon:!0,densityType:"liquid",dietType:["vegetarian","vegan"],categoryColor:"#8B4513"}},salt:{displayName:"Salt (Table Salt)",aliases:["fine salt","table salt","iodized salt"],usdaQuery:"salt table",units:{tbsp:18,tsp:6,"0.5_tsp":3,"0.25_tsp":1.5,oz:28.35,lb:454,g:1},tags:{isCommon:!0,densityType:"dry",dietType:["vegetarian","vegan"],categoryColor:"#FFFFFF"}}},"Canned Goods":{canned_tomatoes:{displayName:"Canned Diced Tomatoes",aliases:["diced tomatoes","canned tomatoes"],usdaQuery:"tomatoes canned diced",units:{"can_14.5oz":411,can_28oz:794,"#10_can":3e3,cup:244,"1/2_cup":122,oz:28,g:1},tags:{isCommon:!0,densityType:"liquid",dietType:["vegetarian","vegan"],categoryColor:"#FFB3B3"}},canned_beans:{displayName:"Canned Black Beans",aliases:["black beans","canned black beans"],usdaQuery:"black beans canned",units:{can_15oz:425,can_15oz_drained:255,"#10_can":3e3,"#10_can_drained":1936,cup:240,"1/2_cup":120,oz:28,g:1},tags:{isCommon:!0,densityType:"solid",dietType:["vegetarian","vegan","gluten-free"],categoryColor:"#C8A882"}}}}};class er{static searchIngredients(e){const t=[],a=e.toLowerCase();return Object.entries(js.categories).forEach(([i,n])=>{Object.entries(n).forEach(([o,l])=>{if(l.displayName.toLowerCase().includes(a)){t.push({category:i,key:o,data:l});return}if(l.aliases.some(c=>c.toLowerCase().includes(a))){t.push({category:i,key:o,data:l});return}})}),t.sort((i,n)=>i.data.tags.isCommon&&!n.data.tags.isCommon?-1:!i.data.tags.isCommon&&n.data.tags.isCommon?1:i.data.displayName.localeCompare(n.data.displayName))}static getIngredient(e,t){var a;return((a=js.categories[e])==null?void 0:a[t])||null}static convertUnits(e,t,a,i,n){const o=this.getIngredient(e,t);if(!o)return null;const l=o.units[i],c=o.units[n];if(!l||!c)return null;const u=a*l/c,h=this.isPreciseMeasurement(i,n)?"exact":"approximate";return{amount:u,precision:h}}static isPreciseMeasurement(e,t){const a=["g","oz","lb","ml","l"],i=["cup","tbsp","tsp"];return!!(a.includes(e)&&a.includes(t)||i.some(n=>e.includes(n))&&i.some(n=>t.includes(n)))}static getAvailableUnits(e,t){const a=this.getIngredient(e,t);return a?Object.keys(a.units).sort():[]}static getCategories(){return Object.keys(js.categories)}static getCategoryIngredients(e){const t=js.categories[e];return t?Object.entries(t).map(([a,i])=>({key:a,data:i})).sort((a,i)=>a.data.tags.isCommon&&!i.data.tags.isCommon?-1:!a.data.tags.isCommon&&i.data.tags.isCommon?1:a.data.displayName.localeCompare(i.data.displayName)):[]}static getConversionSuggestions(e,t,a){const i=this.getIngredient(e,t);if(!i)return[];const n=[],o=i.tags.densityType;return o==="dry"?(a!=="cup"&&n.push("cup"),a!=="g"&&n.push("g"),a!=="oz"&&n.push("oz")):o==="liquid"&&(a!=="cup"&&n.push("cup"),a!=="ml"&&n.push("ml"),a!=="fl_oz"&&n.push("fl_oz")),n.filter(l=>i.units[l])}}const Za=[{id:"bread_white",name:"White Bread",category:"Grains",calories_per_100g:265,protein_per_100g:9,carbs_per_100g:49,fat_per_100g:3.2,fiber_per_100g:2.7,sugar_per_100g:5,sodium_per_100g:491,usda_fdc_id:"167512",data_reliability:"high",portions:[{name:"slice",grams:28,common_serving:!0,usda_verified:!0},{name:"serving",grams:34,common_serving:!0,usda_verified:!0},{name:"2 slices",grams:56,common_serving:!0}],allergens:["gluten","wheat"],diet_types:["vegetarian"]},{id:"bagel_plain",name:"Plain Bagel",category:"Grains",calories_per_100g:257,protein_per_100g:10.1,carbs_per_100g:50.9,fat_per_100g:1.7,fiber_per_100g:2.1,sugar_per_100g:5.1,sodium_per_100g:430,usda_fdc_id:"167534",data_reliability:"high",portions:[{name:"whole bagel",grams:98,common_serving:!0,usda_verified:!0},{name:"half bagel",grams:49,common_serving:!0},{name:"mini bagel",grams:45,common_serving:!0}],allergens:["gluten","wheat"],diet_types:["vegetarian"]},{id:"waffle_frozen",name:"Frozen Waffle",category:"Grains",calories_per_100g:273,protein_per_100g:6.4,carbs_per_100g:42,fat_per_100g:9,fiber_per_100g:1.5,sugar_per_100g:4.2,sodium_per_100g:456,usda_fdc_id:"167516",data_reliability:"high",portions:[{name:"waffle, square",grams:39,common_serving:!0,usda_verified:!0},{name:"waffle, round",grams:38,common_serving:!0,usda_verified:!0},{name:"2 waffles",grams:78,common_serving:!0}],allergens:["gluten","wheat","eggs","milk"],diet_types:["vegetarian"]},{id:"crackers_saltine",name:"Saltine Crackers",category:"Snacks",calories_per_100g:421,protein_per_100g:9.1,carbs_per_100g:73.3,fat_per_100g:9.6,fiber_per_100g:2.8,sugar_per_100g:1.3,sodium_per_100g:1092,usda_fdc_id:"167529",data_reliability:"high",portions:[{name:"serving (4 crackers)",grams:30,common_serving:!0,usda_verified:!0},{name:"1 cracker",grams:12.7,common_serving:!0,usda_verified:!0},{name:"6 crackers",grams:76,common_serving:!0},{name:"1 sleeve",grams:120,common_serving:!1}],allergens:["gluten","wheat"],diet_types:["vegetarian"]},{id:"candy_bar_chocolate",name:"Chocolate Candy Bar",category:"Sweets",calories_per_100g:535,protein_per_100g:4.9,carbs_per_100g:57,fat_per_100g:31.3,fiber_per_100g:3.4,sugar_per_100g:47.9,sodium_per_100g:24,usda_fdc_id:"167565",data_reliability:"high",portions:[{name:"fun size (0.65 oz)",grams:18,common_serving:!0,usda_verified:!0},{name:"regular bar (1.55 oz)",grams:44,common_serving:!0,usda_verified:!0},{name:"large bar (2.1 oz)",grams:60,common_serving:!0,usda_verified:!0},{name:"king size",grams:108,common_serving:!1,usda_verified:!0},{name:"bite size",grams:7,common_serving:!0,usda_verified:!0}],allergens:["milk","soy"],diet_types:["vegetarian"]},{id:"taco_beef",name:"Beef Taco",category:"Restaurant Foods",calories_per_100g:226,protein_per_100g:12.1,carbs_per_100g:18,fat_per_100g:12.2,fiber_per_100g:2.8,sugar_per_100g:2.1,sodium_per_100g:367,usda_fdc_id:"167658",data_reliability:"high",portions:[{name:"single taco",grams:134,common_serving:!0,usda_verified:!0},{name:"2 tacos",grams:279,common_serving:!0,usda_verified:!0},{name:"3 tacos",grams:389,common_serving:!0,usda_verified:!0},{name:"serving (1-3 tacos)",grams:281,common_serving:!0,usda_verified:!0}],allergens:["gluten","wheat"],diet_types:[]},{id:"steak_beef",name:"Beef Steak",category:"Meat",calories_per_100g:271,protein_per_100g:26.1,carbs_per_100g:0,fat_per_100g:18,fiber_per_100g:0,sugar_per_100g:0,sodium_per_100g:54,usda_fdc_id:"167670",data_reliability:"high",portions:[{name:"steak (5.3 oz)",grams:151,common_serving:!0,usda_verified:!0},{name:"3 oz serving",grams:85,common_serving:!0},{name:"6 oz serving",grams:170,common_serving:!0},{name:"8 oz serving",grams:227,common_serving:!0}],allergens:[],diet_types:[]},{id:"pie_apple",name:"Apple Pie",category:"Desserts",calories_per_100g:237,protein_per_100g:2.4,carbs_per_100g:34,fat_per_100g:11,fiber_per_100g:1.6,sugar_per_100g:16.4,sodium_per_100g:327,usda_fdc_id:"167522",data_reliability:"high",portions:[{name:'slice (1/8 of 9" pie)',grams:131,common_serving:!0,usda_verified:!0},{name:"slice",grams:137,common_serving:!0,usda_verified:!0},{name:"whole pie",grams:1137,common_serving:!1,usda_verified:!0},{name:"small slice",grams:100,common_serving:!0}],allergens:["gluten","wheat","eggs"],diet_types:["vegetarian"]},{id:"flour_all_purpose",name:"All-Purpose Flour",category:"Baking",calories_per_100g:364,protein_per_100g:10.3,carbs_per_100g:76.3,fat_per_100g:.9,fiber_per_100g:2.7,sugar_per_100g:.3,sodium_per_100g:2,data_reliability:"high",portions:[{name:"1 cup",grams:120,common_serving:!0,description:"sifted"},{name:"1 cup",grams:125,common_serving:!0,description:"unsifted"},{name:"3/4 cup",grams:94,common_serving:!0},{name:"2/3 cup",grams:83,common_serving:!0},{name:"1/2 cup",grams:63,common_serving:!0},{name:"1/3 cup",grams:42,common_serving:!0},{name:"1/4 cup",grams:31,common_serving:!0},{name:"1 tablespoon",grams:8,common_serving:!0},{name:"1 pound",grams:454,common_serving:!1}],allergens:["gluten","wheat"],diet_types:["vegetarian","vegan"]},{id:"sugar_white",name:"White Sugar",category:"Baking",calories_per_100g:387,protein_per_100g:0,carbs_per_100g:100,fat_per_100g:0,fiber_per_100g:0,sugar_per_100g:99.8,sodium_per_100g:1,data_reliability:"high",portions:[{name:"1 cup",grams:200,common_serving:!0},{name:"3/4 cup",grams:150,common_serving:!0},{name:"2/3 cup",grams:133,common_serving:!0},{name:"1/2 cup",grams:100,common_serving:!0},{name:"1/3 cup",grams:67,common_serving:!0},{name:"1/4 cup",grams:50,common_serving:!0},{name:"1 tablespoon",grams:12.5,common_serving:!0},{name:"1 teaspoon",grams:4,common_serving:!0},{name:"1 packet",grams:4,common_serving:!0}],allergens:[],diet_types:["vegetarian","vegan"]}],Su=r=>{const e=r.toLowerCase().trim();return e?Za.filter(t=>{var a;return t.name.toLowerCase().includes(e)||t.category.toLowerCase().includes(e)||((a=t.diet_types)==null?void 0:a.some(i=>i.toLowerCase().includes(e)))||t.portions.some(i=>i.name.toLowerCase().includes(e))}):Za},Cu=(r,e,t=1)=>{const a=r.portions.find(o=>o.name===e);if(!a)return null;const i=a.grams*t,n=i/100;return{calories:Math.round(r.calories_per_100g*n),protein:Math.round(r.protein_per_100g*n*10)/10,carbs:Math.round(r.carbs_per_100g*n*10)/10,fat:Math.round(r.fat_per_100g*n*10)/10,fiber:Math.round(r.fiber_per_100g*n*10)/10,sugar:Math.round(r.sugar_per_100g*n*10)/10,sodium:Math.round(r.sodium_per_100g*n),totalGrams:i,usda_verified:a.usda_verified||!1,data_reliability:r.data_reliability}};function Eu({onAddToMeal:r,onNavigate:e,onCaloriesCalculated:t,onLogToWeekly:a,isCompact:i=!1}){const[n,o]=b.useState(""),[l,c]=b.useState(""),[d,u]=b.useState(""),[h,g]=b.useState(""),[f,x]=b.useState([]),[y,p]=b.useState([]),[w,T]=b.useState(null),[v,C]=b.useState([]),[N,_]=b.useState(null),[k,S]=b.useState([]);pt(),b.useEffect(()=>{if(n.length>=2){const j=er.searchIngredients(n);p(j.slice(0,6));const W=Su(n);C(W.slice(0,8))}else p([]),C([])},[n]),b.useEffect(()=>{if(w){const j=er.getAvailableUnits(w.category,w.key);S(j),j.length>0&&!d&&u(j[0])}},[w]);const L=j=>{T(j),_(null),o(j.data.displayName),p([]),C([])},P=j=>{_(j),T(null),o(j.name),p([]),C([]);const W=j.portions.map(G=>G.name);S(W),W.length>0&&u(W[0])},q=Li({mutationFn:async({ingredient:j,measurement:W})=>{const G=await fetch("/api/calculate-calories",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({ingredient:j,measurement:W})});if(!G.ok)throw new Error("Failed to calculate calories");return G.json()},onSuccess:j=>{var W,G,Y;x(te=>[j,...te.slice(0,4)]),o(""),c(""),g(""),u(""),T(null),t&&t({name:`${j.ingredient} (${j.measurement})`,calories:j.estimatedCalories,protein:((W=j.nutritionPer100g)==null?void 0:W.protein)||0,carbs:((G=j.nutritionPer100g)==null?void 0:G.carbs)||0,fat:((Y=j.nutritionPer100g)==null?void 0:Y.fat)||0,fiber:0,sugar:0,sodium:0,ingredients:[j.ingredient]})}}),ce=j=>{if(j.preventDefault(),!!n.trim())if(N&&h&&d){const W=parseFloat(h)||1,G=Cu(N,d,W);if(G){const Y={ingredient:N.name,measurement:`${h} ${d}`,estimatedCalories:G.calories,equivalentMeasurement:`${G.totalGrams}g`,note:`USDA verified (${N.data_reliability} reliability)`,nutritionPer100g:{calories:N.calories_per_100g,protein:N.protein_per_100g,carbs:N.carbs_per_100g,fat:N.fat_per_100g}};x(te=>[Y,...te.slice(0,4)]),o(""),c(""),g(""),u(""),_(null),t&&t({name:`${Y.ingredient} (${Y.measurement})`,calories:Y.estimatedCalories,protein:G.protein,carbs:G.carbs,fat:G.fat,fiber:G.fiber,sugar:G.sugar,sodium:G.sodium,ingredients:[Y.ingredient]})}}else if(w&&h&&d){const W=`${h} ${d}`;q.mutate({ingredient:w.data.usdaQuery,measurement:W})}else l.trim()&&q.mutate({ingredient:n.trim(),measurement:l.trim()})},gs=j=>{r&&r(j)},_e=async j=>{var aa,ia,na;const W=new Date,G=W.getHours();let Y;G>=5&&G<11?Y="breakfast":G>=11&&G<16?Y="lunch":G>=16&&G<21?Y="dinner":Y="snack";const te={id:`calc-${Date.now()}`,name:`${j.ingredient} (${j.measurement})`,calories:j.estimatedCalories,protein:((aa=j.nutritionPer100g)==null?void 0:aa.protein)||0,carbs:((ia=j.nutritionPer100g)==null?void 0:ia.carbs)||0,fat:((na=j.nutritionPer100g)==null?void 0:na.fat)||0,fiber:0,sugar:0,sodium:0,date:W.toISOString().split("T")[0],time:W.toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit",hour12:!0}),mealType:Y,category:Y,timestamp:W.toISOString(),source:"calculator"},ra=JSON.parse(localStorage.getItem("weeklyMeals")||"[]");ra.push(te),localStorage.setItem("weeklyMeals",JSON.stringify(ra)),console.log(" Successfully logged to weekly tracker:",te),window.dispatchEvent(new CustomEvent("calories-logged",{detail:te})),window.dispatchEvent(new CustomEvent("meal-logged-success",{detail:te})),window.dispatchEvent(new CustomEvent("refresh-weekly-data")),window.dispatchEvent(new CustomEvent("show-toast",{detail:{message:` Logged ${j.ingredient} to ${Y}!`,type:"success"}})),a&&a({name:te.name,calories:te.calories,protein:te.protein,carbs:te.carbs,fat:te.fat,date:te.date,time:te.time,category:Y})};return i?s.jsxs(F,{className:"p-4 bg-white/90 backdrop-blur-sm border-0 shadow-lg",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[s.jsx(es,{className:"w-5 h-5 text-blue-600"}),s.jsx("h3",{className:"text-lg font-bold text-gray-900",children:"Quick Calorie Calculator"})]}),s.jsxs("form",{onSubmit:ce,className:"space-y-3",children:[s.jsxs("div",{className:"grid grid-cols-1 gap-2",children:[s.jsx(oe,{placeholder:"Ingredient (e.g., chicken breast, apple)",value:n,onChange:j=>o(j.target.value),className:"text-base"}),s.jsx(oe,{placeholder:"Measurement (e.g., 1 cup, 100g, 1 medium)",value:l,onChange:j=>c(j.target.value),className:"text-base"})]}),s.jsx(A,{type:"submit",disabled:q.isPending||!n.trim()||!l.trim(),className:"w-full bg-blue-600 hover:bg-blue-700",children:q.isPending?s.jsxs(s.Fragment,{children:[s.jsx(Va,{className:"w-4 h-4 mr-2 animate-spin"}),"Analyzing..."]}):s.jsxs(s.Fragment,{children:[s.jsx(es,{className:"w-4 h-4 mr-2"}),"Calculate"]})})]}),q.isError&&s.jsx("div",{className:"mt-3 p-3 bg-red-50 border border-red-200 rounded-lg",children:s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(Ir,{className:"w-4 h-4 text-red-600"}),s.jsx("span",{className:"text-sm text-red-700",children:"Could not analyze ingredient. Please check spelling or try a simpler description."})]})}),f.length>0&&s.jsxs("div",{className:"mt-4 space-y-2",children:[s.jsx("h4",{className:"text-sm font-medium text-gray-700",children:"Recent Analysis"}),f.slice(0,2).map((j,W)=>s.jsxs("div",{className:"p-3 bg-gray-50 rounded-lg",children:[s.jsxs("div",{className:"flex justify-between items-start",children:[s.jsxs("div",{className:"flex-1",children:[s.jsx("p",{className:"font-medium text-gray-900",children:j.ingredient}),s.jsx("p",{className:"text-sm text-gray-600",children:j.measurement})]}),s.jsxs(U,{variant:"secondary",className:"bg-orange-100 text-orange-800",children:[s.jsx(ue,{className:"w-3 h-3 mr-1"}),j.estimatedCalories," cal"]})]}),s.jsxs("div",{className:"mt-2 space-y-2",children:[r&&s.jsx(A,{size:"sm",variant:"outline",onClick:()=>gs(j),className:"w-full",children:"Add to Meal"}),s.jsxs(A,{size:"sm",onClick:()=>{_e(j)},className:"w-full bg-blue-600 hover:bg-blue-700 text-white",children:[s.jsx(qt,{className:"w-3 h-3 mr-1"}),"Log to Weekly Tracker"]})]})]},W))]})]}):s.jsxs("div",{className:"space-y-6",children:[s.jsxs(F,{className:"p-6 bg-white/90 backdrop-blur-sm border-0 shadow-lg",children:[s.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[s.jsx("div",{className:"p-2 bg-blue-100 rounded-lg",children:s.jsx(es,{className:"w-6 h-6 text-blue-600"})}),s.jsxs("div",{children:[s.jsx("h2",{className:"text-xl font-bold text-gray-900",children:"USDA Calorie Calculator"}),s.jsx("p",{className:"text-sm text-gray-600",children:"Get precise nutrition data with measurement conversions"})]})]}),s.jsxs("form",{onSubmit:ce,className:"space-y-4",children:[s.jsxs("div",{className:"grid grid-cols-1 gap-4",children:[s.jsxs("div",{className:"relative",children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Ingredient Name"}),s.jsx(oe,{placeholder:"e.g., chicken breast, Greek yogurt, banana",value:n,onChange:j=>o(j.target.value),className:"text-base"}),(y.length>0||v.length>0)&&s.jsxs("div",{className:"absolute z-10 w-full mt-1 bg-white border border-gray-300 rounded-lg shadow-lg max-h-64 overflow-y-auto",children:[v.length>0&&s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"px-4 py-2 bg-green-50 border-b border-green-200",children:s.jsx("p",{className:"text-xs font-semibold text-green-800 uppercase tracking-wide",children:" USDA Verified Foods"})}),v.map((j,W)=>s.jsx("button",{type:"button",onClick:()=>P(j),className:"w-full px-4 py-3 text-left hover:bg-green-50 border-b border-gray-100",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"flex-1",children:[s.jsx("p",{className:"font-medium text-gray-900",children:j.name}),s.jsx("p",{className:"text-xs text-gray-500",children:j.category}),s.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[s.jsxs(U,{variant:"outline",className:"text-xs bg-green-50 text-green-700 border-green-200",children:["USDA ",j.data_reliability]}),j.usda_fdc_id&&s.jsxs(U,{variant:"outline",className:"text-xs",children:["FDC #",j.usda_fdc_id]})]})]}),s.jsxs("div",{className:"text-right text-xs text-gray-500",children:[s.jsxs("p",{children:[j.calories_per_100g," cal/100g"]}),s.jsxs("p",{children:[j.portions.length," portions"]})]})]})},`usda-${j.id}`))]}),y.length>0&&s.jsxs(s.Fragment,{children:[v.length>0&&s.jsx("div",{className:"px-4 py-2 bg-blue-50 border-b border-blue-200",children:s.jsx("p",{className:"text-xs font-semibold text-blue-800 uppercase tracking-wide",children:"Custom Database"})}),y.map((j,W)=>s.jsx("button",{type:"button",onClick:()=>L(j),className:"w-full px-4 py-2 text-left hover:bg-blue-50 border-b border-gray-100 last:border-b-0",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("p",{className:"font-medium text-gray-900",children:j.data.displayName}),s.jsx("p",{className:"text-xs text-gray-500",children:j.category})]}),s.jsx(U,{variant:"outline",style:{backgroundColor:j.data.tags.categoryColor+"40",color:"#374151"},className:"text-xs",children:j.data.tags.dietType[0]||"food"})]})},`${j.category}-${j.key}`))]})]}),s.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:["Enhanced with USDA verified foods + ",Object.keys(er.getCategories()).length," custom categories"]})]}),w||N?s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Amount"}),s.jsx(oe,{type:"number",step:"0.25",placeholder:"1",value:h,onChange:j=>g(j.target.value),className:"text-base"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Unit"}),s.jsxs(ju,{value:d,onValueChange:u,children:[s.jsx(Tn,{className:"text-base",children:s.jsx(_u,{placeholder:"Select unit"})}),s.jsx(An,{children:k.map(j=>s.jsx(On,{value:j,children:j.replace("_"," ")},j))})]})]})]}):s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Measurement"}),s.jsx(oe,{placeholder:"e.g., 1 cup, 100g, 1 medium, 2 tablespoons",value:l,onChange:j=>c(j.target.value),className:"text-base"}),s.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Supports cups, grams, ounces, pieces, and more"})]})]}),s.jsx(A,{type:"submit",disabled:q.isPending||!n.trim()||!l.trim()&&!((w||N)&&h&&d),className:"w-full bg-blue-600 hover:bg-blue-700 text-lg py-6",children:q.isPending?s.jsxs(s.Fragment,{children:[s.jsx(Va,{className:"w-5 h-5 mr-2 animate-spin"}),"Analyzing with USDA Database..."]}):s.jsxs(s.Fragment,{children:[s.jsx(es,{className:"w-5 h-5 mr-2"}),"Calculate Calories"]})})]}),q.isError&&s.jsx("div",{className:"mt-4 p-4 bg-red-50 border border-red-200 rounded-lg",children:s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx(Ir,{className:"w-5 h-5 text-red-600"}),s.jsxs("div",{children:[s.jsx("p",{className:"font-medium text-red-700",children:"Analysis Failed"}),s.jsx("p",{className:"text-sm text-red-600",children:"Could not find nutrition data for this ingredient. Try using a more common name or check spelling."})]})]})})]}),f.length>0&&s.jsxs(F,{className:"p-6 bg-white/90 backdrop-blur-sm border-0 shadow-lg",children:[s.jsx("h3",{className:"text-lg font-bold text-gray-900 mb-4",children:"Recent Analyses"}),s.jsx("div",{className:"space-y-4",children:f.map((j,W)=>s.jsxs("div",{className:"p-4 border border-gray-200 rounded-lg",children:[s.jsxs("div",{className:"flex justify-between items-start mb-3",children:[s.jsxs("div",{children:[s.jsx("h4",{className:"font-bold text-gray-900 text-lg",children:j.ingredient}),s.jsx("p",{className:"text-gray-600",children:j.measurement})]}),s.jsxs(U,{variant:"default",className:"bg-orange-500 text-white text-lg px-3 py-1",children:[s.jsx(ue,{className:"w-4 h-4 mr-1"}),j.estimatedCalories," kcal"]})]}),j.equivalentMeasurement&&s.jsx("div",{className:"mb-3",children:s.jsxs("p",{className:"text-sm text-blue-600 font-medium",children:[s.jsx(bn,{className:"w-4 h-4 inline mr-1"}),j.equivalentMeasurement]})}),j.nutritionPer100g&&s.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-3 mb-3",children:[s.jsxs("div",{className:"text-center p-2 bg-gray-50 rounded",children:[s.jsx(ue,{className:"w-4 h-4 mx-auto text-orange-500 mb-1"}),s.jsx("p",{className:"text-xs text-gray-600",children:"Calories"}),s.jsx("p",{className:"font-bold text-gray-900",children:Math.round(j.nutritionPer100g.calories)})]}),s.jsxs("div",{className:"text-center p-2 bg-gray-50 rounded",children:[s.jsx(Tr,{className:"w-4 h-4 mx-auto text-red-500 mb-1"}),s.jsx("p",{className:"text-xs text-gray-600",children:"Protein"}),s.jsxs("p",{className:"font-bold text-gray-900",children:[Math.round(j.nutritionPer100g.protein),"g"]})]}),s.jsxs("div",{className:"text-center p-2 bg-gray-50 rounded",children:[s.jsx(Ed,{className:"w-4 h-4 mx-auto text-yellow-500 mb-1"}),s.jsx("p",{className:"text-xs text-gray-600",children:"Carbs"}),s.jsxs("p",{className:"font-bold text-gray-900",children:[Math.round(j.nutritionPer100g.carbs),"g"]})]}),s.jsxs("div",{className:"text-center p-2 bg-gray-50 rounded",children:[s.jsx(Or,{className:"w-4 h-4 mx-auto text-blue-500 mb-1"}),s.jsx("p",{className:"text-xs text-gray-600",children:"Fat"}),s.jsxs("p",{className:"font-bold text-gray-900",children:[Math.round(j.nutritionPer100g.fat),"g"]})]})]}),j.note&&s.jsx("div",{className:"mb-3 p-3 bg-blue-50 border border-blue-200 rounded",children:s.jsxs("div",{className:"flex items-start gap-2",children:[s.jsx(Hr,{className:"w-4 h-4 text-blue-600 mt-0.5"}),s.jsx("p",{className:"text-sm text-blue-700",children:j.note})]})}),s.jsxs("div",{className:"space-y-2",children:[r&&s.jsxs(A,{onClick:()=>gs(j),className:"w-full bg-green-600 hover:bg-green-700 text-white shadow-lg hover:shadow-xl transition-all duration-200",children:[s.jsx(je,{className:"w-4 h-4 mr-2"}),"Add to Current Meal"]}),s.jsxs(A,{onClick:()=>_e(j),className:"w-full bg-gradient-to-r from-purple-600 to-blue-600 hover:from-purple-700 hover:to-blue-700 text-white shadow-lg hover:shadow-xl transition-all duration-300 transform hover:scale-[1.02]",children:[s.jsx(Te,{className:"w-5 h-5 mr-2"}),"Log to Weekly Tracker"]})]})]},W))})]}),s.jsxs(F,{className:"p-6 bg-white/90 backdrop-blur-sm border-0 shadow-lg",children:[s.jsx("h3",{className:"text-lg font-bold text-gray-900 mb-4",children:"Example Calculations"}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[s.jsxs("div",{className:"space-y-3",children:[s.jsx("h4",{className:"font-medium text-gray-700",children:"Common Ingredients"}),s.jsxs("div",{className:"space-y-2 text-sm",children:[s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{className:"text-gray-600",children:"1 large egg"}),s.jsx("span",{className:"font-medium",children:"~70 kcal"})]}),s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{className:"text-gray-600",children:"1 cup cooked rice"}),s.jsx("span",{className:"font-medium",children:"~205 kcal"})]}),s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{className:"text-gray-600",children:"1 medium banana"}),s.jsx("span",{className:"font-medium",children:"~105 kcal"})]}),s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{className:"text-gray-600",children:"1 tablespoon olive oil"}),s.jsx("span",{className:"font-medium",children:"~120 kcal"})]})]})]}),s.jsxs("div",{className:"space-y-3",children:[s.jsx("h4",{className:"font-medium text-gray-700",children:"Measurement Examples"}),s.jsxs("div",{className:"space-y-2 text-sm text-gray-600",children:[s.jsx("p",{children:" Weight: 100g, 2 oz, 1 lb"}),s.jsx("p",{children:" Volume: 1 cup, 2 tbsp, 1 tsp"}),s.jsx("p",{children:" Pieces: 1 medium, 1 slice, 1 whole"}),s.jsx("p",{children:" Portions: 1 serving, handful, bunch"})]})]})]})]})]})}function Tu({onNavigate:r}){const{getDailyStats:e,addCalculatedCalories:t}=Xr(),a=e(),i=[{label:"Today Calculated",value:a.calories.toLocaleString(),icon:es,color:"text-blue-600",bgColor:"bg-blue-50"},{label:"Items Tracked",value:a.count.toString(),icon:he,color:"text-green-600",bgColor:"bg-green-50"},{label:"Protein (g)",value:Math.round(a.protein).toString(),icon:Jr,color:"text-orange-600",bgColor:"bg-orange-50"}];return s.jsxs("div",{className:"min-h-screen bg-gradient-to-b from-[#a8dadc]/10 to-[#fef7cd]/10",children:[s.jsx(Bs,{title:"Calorie Calculator",subtitle:"Calculate nutrition using USDA database",component:"calculator",stats:i,showProgress:!1,className:"pb-6"}),s.jsx("div",{className:"max-w-md mx-auto w-full px-3",children:s.jsx(Eu,{onNavigate:r,onCaloriesCalculated:t,onLogToWeekly:n=>{t({name:n.name,calories:n.calories,protein:n.protein,carbs:n.carbs,fat:n.fat,fiber:0,sugar:0,sodium:0,ingredients:[n.name]});const o=new CustomEvent("calories-logged",{detail:{...n,timestamp:new Date().toISOString(),source:"calculator",mealType:n.category}});window.dispatchEvent(o),console.log(`Successfully logged to weekly ${n.category}:`,n);const l=new CustomEvent("show-toast",{detail:{message:`Logged ${n.name} to ${n.category}!`,type:"success"}});window.dispatchEvent(l)}})})]})}function Pu({className:r,...e}){return s.jsx(Zn,{"data-slot":"tabs",className:H("flex flex-col gap-2",r),...e})}function Iu({className:r,...e}){return s.jsx(Xn,{"data-slot":"tabs-list",className:H("bg-muted text-muted-foreground inline-flex h-9 w-fit items-center justify-center rounded-xl p-[3px] flex",r),...e})}function tr({className:r,...e}){return s.jsx(eo,{"data-slot":"tabs-trigger",className:H("data-[state=active]:bg-card dark:data-[state=active]:text-foreground focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:outline-ring dark:data-[state=active]:border-input dark:data-[state=active]:bg-input/30 text-foreground dark:text-muted-foreground inline-flex h-[calc(100%-1px)] flex-1 items-center justify-center gap-1.5 rounded-xl border border-transparent px-2 py-1 text-sm font-medium whitespace-nowrap transition-[color,box-shadow] focus-visible:ring-[3px] disabled:pointer-events-none disabled:opacity-50 data-[state=active]:shadow-xs dark:data-[state=active]:shadow-none",r),...e})}function sr({className:r,...e}){return s.jsx(to,{"data-slot":"tabs-content",className:H("flex-1 outline-none",r),...e})}var ea="Progress",ta=100,[Au,jh]=vi(ea),[Ou,Ru]=Au(ea),Rn=b.forwardRef((r,e)=>{const{__scopeProgress:t,value:a=null,max:i,getValueLabel:n=Mu,...o}=r;(i||i===0)&&!Xa(i)&&console.error($u(`${i}`,"Progress"));const l=Xa(i)?i:ta;a!==null&&!ei(a,l)&&console.error(Lu(`${a}`,"Progress"));const c=ei(a,l)?a:null,d=Is(c)?n(c,l):void 0;return s.jsx(Ou,{scope:t,value:c,max:l,children:s.jsx(Kt.div,{"aria-valuemax":l,"aria-valuemin":0,"aria-valuenow":Is(c)?c:void 0,"aria-valuetext":d,role:"progressbar","data-state":Ln(c,l),"data-value":c??void 0,"data-max":l,...o,ref:e})})});Rn.displayName=ea;var Mn="ProgressIndicator",$n=b.forwardRef((r,e)=>{const{__scopeProgress:t,...a}=r,i=Ru(Mn,t);return s.jsx(Kt.div,{"data-state":Ln(i.value,i.max),"data-value":i.value??void 0,"data-max":i.max,...a,ref:e})});$n.displayName=Mn;function Mu(r,e){return`${Math.round(r/e*100)}%`}function Ln(r,e){return r==null?"indeterminate":r===e?"complete":"loading"}function Is(r){return typeof r=="number"}function Xa(r){return Is(r)&&!isNaN(r)&&r>0}function ei(r,e){return Is(r)&&!isNaN(r)&&r<=e&&r>=0}function $u(r,e){return`Invalid prop \`max\` of value \`${r}\` supplied to \`${e}\`. Only numbers greater than 0 are valid max values. Defaulting to \`${ta}\`.`}function Lu(r,e){return`Invalid prop \`value\` of value \`${r}\` supplied to \`${e}\`. The \`value\` prop must be:
  - a positive number
  - less than the value passed to \`max\` (or ${ta} if no \`max\` prop is set)
  - \`null\` or \`undefined\` if the progress is indeterminate.

Defaulting to \`null\`.`}var Dn=Rn,Du=$n;const Gt=b.forwardRef(({className:r,value:e,...t},a)=>s.jsx(Dn,{ref:a,className:H("relative h-4 w-full overflow-hidden rounded-full bg-secondary",r),...t,children:s.jsx(Du,{className:"h-full w-full flex-1 bg-primary transition-all",style:{transform:`translateX(-${100-(e||0)}%)`}})}));Gt.displayName=Dn.displayName;function Uu({progress:r,size:e="md",showAchievement:t=!0,color:a="blue",animated:i=!0,className:n=""}){const o={sm:{ring:"w-20 h-20",text:"text-lg",badge:"w-6 h-6"},md:{ring:"w-32 h-32",text:"text-2xl",badge:"w-8 h-8"},lg:{ring:"w-40 h-40",text:"text-3xl",badge:"w-10 h-10"}},l={blue:{stroke:"#3b82f6",bg:"bg-blue-500",shadow:"rgba(59, 130, 246, 0.4)"},green:{stroke:"#10b981",bg:"bg-green-500",shadow:"rgba(16, 185, 129, 0.4)"},orange:{stroke:"#f59e0b",bg:"bg-orange-500",shadow:"rgba(245, 158, 11, 0.4)"},purple:{stroke:"#8b5cf6",bg:"bg-purple-500",shadow:"rgba(139, 92, 246, 0.4)"}},c=o[e],d=l[a],u=r>=100;return s.jsxs("div",{className:`relative ${n}`,children:[s.jsx("div",{className:"flex items-center justify-center",children:s.jsxs("div",{className:`relative ${c.ring}`,children:[s.jsxs("svg",{className:`${c.ring} transform -rotate-90`,viewBox:"0 0 36 36",children:[s.jsx("path",{d:"M18 2.0845 a 15.9155 15.9155 0 0 1 0 31.831 a 15.9155 15.9155 0 0 1 0 -31.831",fill:"none",stroke:"#f1f5f9",strokeWidth:"3"}),s.jsx("path",{d:"M18 2.0845 a 15.9155 15.9155 0 0 1 0 31.831 a 15.9155 15.9155 0 0 1 0 -31.831",fill:"none",stroke:d.stroke,strokeWidth:"3.5",strokeDasharray:`${Math.min(r,100)}, 100`,strokeLinecap:"round",className:i?"transition-all duration-1500 ease-out":"",style:{filter:`drop-shadow(0 0 8px ${d.shadow})`}})]}),s.jsxs("div",{className:"absolute inset-0 flex flex-col items-center justify-center",children:[s.jsxs("div",{className:`${c.text} font-bold text-gray-900 transition-all duration-500`,children:[Math.round(r),"%"]}),s.jsx("div",{className:"text-xs text-gray-600 font-medium",children:"Complete"})]})]})}),t&&u&&s.jsx("div",{className:"absolute -top-2 -right-2 animate-bounce",children:s.jsx("div",{className:`${c.badge} ${d.bg} rounded-full flex items-center justify-center shadow-lg`,children:s.jsx(Qr,{className:"w-3 h-3 text-white"})})})]})}function Fu({weekStart:r,weeklyTotals:e,calculatedCaloriesTotal:t,dailyCalorieGoal:a,onNavigateWeek:i}){const n=e.calories+t,o=a*7,l=Math.min(n/o*100,100),c=Math.round(n/7),d=l>=100,u=l>=70;return s.jsxs(F,{className:"p-6 bg-gradient-to-br from-white via-blue-50/20 to-purple-50/30 border-0 shadow-xl backdrop-blur-sm",children:[s.jsxs("div",{className:"flex items-center justify-between mb-6",children:[s.jsxs("div",{children:[s.jsx("h3",{className:"text-xl font-bold text-gray-900 mb-1",children:"Week Progress"}),s.jsxs("p",{className:"text-sm text-gray-600",children:[we(r,"MMM d")," - ",we(ji(r,6),"MMM d, yyyy")]})]}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(A,{variant:"ghost",size:"sm",onClick:()=>i("prev"),className:"h-9 w-9 p-0 hover:bg-blue-100 transition-colors",children:s.jsx(vd,{className:"w-4 h-4"})}),s.jsx(A,{variant:"ghost",size:"sm",onClick:()=>i("next"),className:"h-9 w-9 p-0 hover:bg-blue-100 transition-colors",children:s.jsx(fn,{className:"w-4 h-4"})})]})]}),s.jsx("div",{className:"flex justify-center mb-8",children:s.jsx(Uu,{progress:l,size:"lg",color:d?"green":u?"blue":"orange",showAchievement:!0,animated:!0})}),s.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-6",children:[s.jsxs("div",{className:"bg-gradient-to-br from-orange-50 to-red-50 p-4 rounded-xl border border-orange-100",children:[s.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[s.jsx("div",{className:"w-8 h-8 bg-orange-500 rounded-lg flex items-center justify-center",children:s.jsx(ue,{className:"w-4 h-4 text-white"})}),s.jsxs("div",{children:[s.jsx("p",{className:"text-sm font-medium text-gray-700",children:"Total Calories"}),s.jsxs("p",{className:"text-xs text-gray-500",children:[n.toLocaleString()," / ",o.toLocaleString()]})]})]}),s.jsx(Gt,{value:l,className:"h-2 bg-orange-100"})]}),s.jsxs("div",{className:"bg-gradient-to-br from-blue-50 to-indigo-50 p-4 rounded-xl border border-blue-100",children:[s.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[s.jsx("div",{className:"w-8 h-8 bg-blue-500 rounded-lg flex items-center justify-center",children:s.jsx(os,{className:"w-4 h-4 text-white"})}),s.jsxs("div",{children:[s.jsx("p",{className:"text-sm font-medium text-gray-700",children:"Daily Average"}),s.jsxs("p",{className:"text-xs text-gray-500",children:[c," / ",a," cal"]})]})]}),s.jsx(Gt,{value:c/a*100,className:"h-2 bg-blue-100"})]}),s.jsxs("div",{className:"bg-gradient-to-br from-green-50 to-emerald-50 p-4 rounded-xl border border-green-100",children:[s.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[s.jsx("div",{className:"w-8 h-8 bg-green-500 rounded-lg flex items-center justify-center",children:s.jsx(he,{className:"w-4 h-4 text-white"})}),s.jsxs("div",{children:[s.jsx("p",{className:"text-sm font-medium text-gray-700",children:"Meals Logged"}),s.jsxs("p",{className:"text-xs text-gray-500",children:[e.meals," this week"]})]})]}),s.jsx("div",{className:"flex items-center gap-1",children:Array.from({length:7},(h,g)=>s.jsx("div",{className:`flex-1 h-2 rounded-full ${g<Math.ceil(e.meals/21*7)?"bg-green-400":"bg-green-100"}`},g))})]}),s.jsxs("div",{className:"bg-gradient-to-br from-purple-50 to-violet-50 p-4 rounded-xl border border-purple-100",children:[s.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[s.jsx("div",{className:"w-8 h-8 bg-purple-500 rounded-lg flex items-center justify-center",children:s.jsx(ft,{className:"w-4 h-4 text-white"})}),s.jsxs("div",{children:[s.jsx("p",{className:"text-sm font-medium text-gray-700",children:"Progress"}),s.jsx("p",{className:"text-xs text-gray-500",children:d?"Goal Reached!":u?"On Track":"Keep Going"})]})]}),s.jsxs("div",{className:"flex items-center gap-1",children:[s.jsx("div",{className:`w-2 h-2 rounded-full ${d?"bg-green-400":"bg-gray-200"}`}),s.jsx("div",{className:`w-2 h-2 rounded-full ${u?"bg-blue-400":"bg-gray-200"}`}),s.jsx("div",{className:`w-2 h-2 rounded-full ${l>30?"bg-yellow-400":"bg-gray-200"}`}),s.jsx("div",{className:`w-2 h-2 rounded-full ${l>0?"bg-purple-400":"bg-gray-200"}`})]})]})]}),s.jsx("div",{className:"flex justify-center",children:s.jsxs(U,{variant:d?"default":u?"secondary":"outline",className:`
            px-4 py-2 text-sm font-medium transition-all duration-300 transform hover:scale-105
            ${d?"bg-gradient-to-r from-green-100 to-emerald-100 text-green-800 border-green-200 shadow-lg":""}
            ${u&&!d?"bg-gradient-to-r from-blue-100 to-indigo-100 text-blue-800 border-blue-200 shadow-md":""}
            ${u?"":"bg-gradient-to-r from-orange-100 to-yellow-100 text-orange-800 border-orange-200"}
          `,children:[s.jsx(Pr,{className:"w-3 h-3 mr-2"}),d?"Weekly Goal Achieved!":u?"Great Progress This Week":"Building Momentum"]})})]})}function zu({weekDays:r,getDayTotals:e,selectedDay:t,dailyCalorieGoal:a,onSelectDay:i}){const n=d=>rr(d)?"Today":ar(d)?"Yesterday":la(d)?"Future":we(d,"MMM d"),o=(d,u)=>la(d)?"future":u>=a?"complete":u>=a*.7?"good":u>0?"started":"empty",l=d=>{switch(d){case"complete":return je;case"good":return he;case"started":return Wa;case"future":return Us;default:return Wa}},c=d=>{switch(d){case"complete":return"text-green-600 bg-green-50 border-green-200";case"good":return"text-blue-600 bg-blue-50 border-blue-200";case"started":return"text-yellow-600 bg-yellow-50 border-yellow-200";case"future":return"text-gray-400 bg-gray-50 border-gray-200";default:return"text-gray-600 bg-gray-50 border-gray-200"}};return s.jsxs(F,{className:"p-6 bg-gradient-to-br from-white via-green-50/20 to-blue-50/30 border-0 shadow-xl backdrop-blur-sm",children:[s.jsxs("div",{className:"flex items-center justify-between mb-6",children:[s.jsxs("div",{children:[s.jsx("h3",{className:"text-xl font-bold text-gray-900 mb-1",children:"Daily Progress"}),s.jsx("p",{className:"text-sm text-gray-600",children:"Track your nutrition goals day by day"})]}),s.jsxs(U,{variant:"outline",className:"text-purple-600 border-purple-200 bg-purple-50",children:[s.jsx(Te,{className:"w-3 h-3 mr-1"}),"7 Days"]})]}),s.jsx("div",{className:"space-y-3",children:r.map((d,u)=>{const h=e(d),g=Math.min(h.calories/a*100,100),f=n(d),x=o(d,h.calories),y=l(x),p=we(d,"yyyy-MM-dd")===we(t,"yyyy-MM-dd"),w=rr(d);return s.jsxs("div",{className:`
                relative p-5 rounded-2xl border-2 transition-all duration-300 cursor-pointer transform hover:scale-[1.02] hover:shadow-lg
                ${p?"border-blue-300 bg-gradient-to-r from-blue-50 via-indigo-50 to-purple-50 shadow-xl ring-2 ring-blue-300":"border-gray-200 bg-gradient-to-br from-white to-gray-50/50 hover:border-gray-300 hover:shadow-md"}
                ${w&&!p?"ring-2 ring-green-300 border-green-300 bg-gradient-to-r from-green-50 to-emerald-50":""}
                ${x==="future"?"opacity-60":""}
              `,onClick:()=>i(d),children:[s.jsx("div",{className:"absolute top-3 right-3",children:s.jsx("div",{className:`p-1.5 rounded-full ${c(x)}`,children:s.jsx(y,{className:"w-3 h-3"})})}),(w||ar(d))&&s.jsx("div",{className:"absolute top-3 left-3",children:s.jsx(U,{variant:"secondary",className:`text-xs px-2 py-1 ${w?"bg-green-100 text-green-800 border-green-200":"bg-blue-100 text-blue-800 border-blue-200"}`,children:f})}),s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsxs("div",{className:"text-center min-w-[60px]",children:[s.jsx("div",{className:"text-xs font-medium text-gray-600 uppercase tracking-wide",children:we(d,"EEE")}),s.jsx("div",{className:"text-2xl font-bold text-gray-900 leading-none mt-1",children:we(d,"d")}),x==="complete"&&s.jsx("div",{className:"mt-1",children:s.jsx(at,{className:"w-4 h-4 text-yellow-500 mx-auto"})})]}),s.jsxs("div",{className:"flex-1",children:[s.jsxs("div",{className:"flex items-center justify-between mb-2",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(ue,{className:"w-4 h-4 text-orange-500"}),s.jsxs("span",{className:"text-sm font-medium text-gray-700",children:[h.calories.toLocaleString()," / ",a.toLocaleString()]})]}),s.jsxs("span",{className:"text-xs font-bold text-gray-600",children:[Math.round(g),"%"]})]}),s.jsx(Gt,{value:g,className:`h-3 mb-3 transition-all duration-700 ${x==="complete"?"[&>div]:bg-gradient-to-r [&>div]:from-green-500 [&>div]:to-emerald-600":x==="good"?"[&>div]:bg-gradient-to-r [&>div]:from-blue-500 [&>div]:to-indigo-600":x==="started"?"[&>div]:bg-gradient-to-r [&>div]:from-yellow-500 [&>div]:to-orange-500":"[&>div]:bg-gray-300"}`}),s.jsxs("div",{className:"flex items-center justify-between text-xs text-gray-600",children:[s.jsx("div",{className:"flex items-center gap-3",children:h.meals>0?s.jsxs("div",{className:"flex items-center gap-1",children:[s.jsx(Pe,{className:"w-3 h-3"}),s.jsxs("span",{children:[h.meals," meal",h.meals!==1?"s":""]})]}):s.jsx("span",{className:"text-gray-400",children:"No meals logged"})}),h.calories>0&&s.jsx("div",{className:"text-right",children:s.jsxs("div",{children:["P: ",h.protein,"g  C: ",h.carbs,"g  F: ",h.fat,"g"]})})]})]})]}),g>0&&s.jsx("div",{className:"absolute bottom-2 right-2",children:s.jsxs("div",{className:`flex items-center gap-1 px-2 py-1 rounded-full text-xs font-medium ${x==="complete"?"bg-green-100 text-green-700":x==="good"?"bg-blue-100 text-blue-700":x==="started"?"bg-yellow-100 text-yellow-700":"bg-gray-100 text-gray-700"}`,children:[s.jsx(Jr,{className:"w-3 h-3"}),x==="complete"?"Goal!":x==="good"?"Good":x==="started"?"Started":"Empty"]})})]},u)})}),s.jsx("div",{className:"mt-6 p-4 bg-gradient-to-r from-gray-50 to-slate-50 rounded-xl border border-gray-200",children:s.jsxs("div",{className:"flex items-center justify-between text-sm",children:[s.jsx("span",{className:"text-gray-600",children:"Week Summary"}),s.jsxs("div",{className:"flex items-center gap-4 text-gray-700",children:[s.jsxs("div",{className:"flex items-center gap-1",children:[s.jsx(je,{className:"w-4 h-4 text-green-600"}),s.jsxs("span",{children:[r.filter(d=>e(d).calories>=a).length," goal days"]})]}),s.jsxs("div",{className:"flex items-center gap-1",children:[s.jsx(ft,{className:"w-4 h-4 text-blue-600"}),s.jsxs("span",{children:[r.filter(d=>e(d).calories>0).length," active days"]})]})]})]})})]})}function Bu({selectedDay:r,getMealsByType:e,dailyCalorieGoal:t,onNavigate:a}){const i=h=>rr(h)?"Today":ar(h)?"Yesterday":we(h,"EEEE, MMM d"),n=h=>{switch(h){case"breakfast":return Cd;case"lunch":return vn;case"dinner":return yn;case"snack":return wd;default:return Pe}},o=h=>{switch(h){case"breakfast":return{bg:"bg-gradient-to-br from-orange-50 to-amber-50",border:"border-orange-200",text:"text-orange-700",accent:"bg-orange-500"};case"lunch":return{bg:"bg-gradient-to-br from-yellow-50 to-orange-50",border:"border-yellow-200",text:"text-yellow-700",accent:"bg-yellow-500"};case"dinner":return{bg:"bg-gradient-to-br from-indigo-50 to-blue-50",border:"border-indigo-200",text:"text-indigo-700",accent:"bg-indigo-500"};case"snack":return{bg:"bg-gradient-to-br from-purple-50 to-pink-50",border:"border-purple-200",text:"text-purple-700",accent:"bg-purple-500"};default:return{bg:"bg-gray-50",border:"border-gray-200",text:"text-gray-700",accent:"bg-gray-500"}}},l=["breakfast","lunch","dinner","snack"],c=e(r),d=Object.values(c).flat().reduce((h,g)=>({calories:h.calories+g.calories,protein:h.protein+g.protein,carbs:h.carbs+g.carbs,fat:h.fat+g.fat,meals:h.meals+1}),{calories:0,protein:0,carbs:0,fat:0,meals:0}),u=Math.min(d.calories/t*100,100);return s.jsxs(F,{className:"p-6 bg-gradient-to-br from-white via-orange-50/20 to-yellow-50/30 border-0 shadow-xl backdrop-blur-sm",children:[s.jsxs("div",{className:"mb-6",children:[s.jsxs("div",{className:"flex items-center justify-between mb-4",children:[s.jsxs("div",{children:[s.jsx("h3",{className:"text-xl font-bold text-gray-900",children:i(r)}),s.jsx("p",{className:"text-sm text-gray-600",children:we(r,"EEEE, MMM d, yyyy")})]}),s.jsxs(A,{onClick:()=>a("calculator"),className:"bg-gradient-to-r from-blue-600 to-blue-700 hover:from-blue-700 hover:to-blue-800 text-white shadow-lg transition-all duration-200 transform hover:scale-105",children:[s.jsx(qt,{className:"w-4 h-4 mr-2"}),"Add Meal"]})]}),s.jsxs("div",{className:"p-4 bg-gradient-to-r from-blue-50 via-indigo-50 to-purple-50 rounded-xl border border-blue-200 shadow-lg",children:[s.jsxs("div",{className:"flex items-center justify-between mb-3",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"w-10 h-10 bg-gradient-to-r from-blue-500 to-indigo-600 rounded-xl flex items-center justify-center shadow-md",children:s.jsx(he,{className:"w-5 h-5 text-white"})}),s.jsxs("div",{children:[s.jsx("p",{className:"font-semibold text-blue-900",children:"Daily Progress"}),s.jsxs("p",{className:"text-sm text-blue-700",children:[d.calories.toLocaleString()," / ",t.toLocaleString()," calories"]})]})]}),s.jsxs("div",{className:"text-right",children:[s.jsxs("p",{className:"text-2xl font-bold bg-gradient-to-r from-blue-900 to-indigo-900 bg-clip-text text-transparent",children:[Math.round(u),"%"]}),s.jsxs("p",{className:"text-xs text-blue-700",children:[d.meals," meals"]})]})]}),s.jsx(Gt,{value:u,className:"h-3 bg-blue-100 [&>div]:bg-gradient-to-r [&>div]:from-blue-500 [&>div]:to-indigo-600"})]})]}),s.jsx("div",{className:"space-y-4",children:l.map(h=>{const g=c[h],f=n(h),x=o(h),y=g.reduce((w,T)=>w+T.calories,0),p=Math.min(y/(t*.25)*100,100);return s.jsxs("div",{className:`
                relative p-5 rounded-2xl border-2 transition-all duration-300
                ${x.bg} ${x.border}
              `,children:[s.jsxs("div",{className:"flex items-center justify-between mb-4",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:`w-12 h-12 ${x.accent} rounded-xl flex items-center justify-center shadow-lg`,children:s.jsx(f,{className:"w-6 h-6 text-white"})}),s.jsxs("div",{children:[s.jsx("h4",{className:`text-lg font-bold capitalize ${x.text}`,children:h}),s.jsxs("p",{className:`text-sm ${x.text} opacity-75`,children:[g.length," ",g.length===1?"item":"items"]})]})]}),s.jsxs("div",{className:"text-right",children:[s.jsxs("p",{className:`text-xl font-bold ${x.text}`,children:[y.toLocaleString()," cal"]}),s.jsxs("p",{className:`text-xs ${x.text} opacity-75`,children:[Math.round(y/t*100),"% of daily goal"]})]})]}),s.jsx("div",{className:"mb-4",children:s.jsx(Gt,{value:p,className:`h-2 bg-white/50 [&>div]:${x.accent.replace("bg-","bg-")}`})}),g.length===0?s.jsxs("div",{className:"text-center py-8",children:[s.jsx("div",{className:`w-16 h-16 ${x.accent} rounded-full mx-auto mb-3 flex items-center justify-center opacity-30`,children:s.jsx(Pe,{className:"w-8 h-8 text-white"})}),s.jsxs("p",{className:`text-sm ${x.text} opacity-60 mb-3`,children:["No ",h," logged yet"]}),s.jsxs(A,{variant:"ghost",size:"sm",onClick:()=>a("calculator"),className:`${x.text} hover:bg-white/50`,children:[s.jsx(qt,{className:"w-4 h-4 mr-2"}),"Add ",h]})]}):s.jsx("div",{className:"space-y-3",children:g.map((w,T)=>s.jsx("div",{className:"bg-white/70 backdrop-blur-sm p-4 rounded-xl border border-white/50 transition-all duration-300 hover:bg-white/90 hover:shadow-lg hover:scale-[1.02] transform",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"flex-1",children:[s.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[s.jsx("h5",{className:"font-semibold text-gray-900",children:w.name}),s.jsxs(U,{variant:"outline",className:"text-xs",children:[s.jsx(Us,{className:"w-3 h-3 mr-1"}),w.time]})]}),s.jsxs("div",{className:"grid grid-cols-4 gap-3 text-xs text-gray-600",children:[s.jsxs("div",{className:"flex items-center gap-1",children:[s.jsx(os,{className:"w-3 h-3 text-green-600"}),s.jsxs("span",{children:["P: ",w.protein,"g"]})]}),s.jsxs("div",{className:"flex items-center gap-1",children:[s.jsx(ft,{className:"w-3 h-3 text-blue-600"}),s.jsxs("span",{children:["C: ",w.carbs,"g"]})]}),s.jsxs("div",{className:"flex items-center gap-1",children:[s.jsx(ue,{className:"w-3 h-3 text-yellow-600"}),s.jsxs("span",{children:["F: ",w.fat,"g"]})]}),s.jsxs("div",{className:"flex items-center gap-1",children:[s.jsx(he,{className:"w-3 h-3 text-purple-600"}),s.jsxs("span",{children:["Fiber: ",w.fiber,"g"]})]})]})]}),s.jsxs("div",{className:"text-right ml-4",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("div",{className:"text-xl font-bold text-orange-600",children:w.calories.toLocaleString()}),s.jsx(fn,{className:"w-4 h-4 text-gray-400"})]}),s.jsx("p",{className:"text-xs text-gray-500",children:"calories"})]})]})},w.id))})]},h)})}),d.meals>0&&s.jsx("div",{className:"mt-6 p-4 bg-gradient-to-r from-gray-50 to-slate-50 rounded-xl border border-gray-200",children:s.jsxs("div",{className:"flex items-center justify-between text-sm",children:[s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(ue,{className:"w-4 h-4 text-orange-500"}),s.jsxs("span",{className:"font-medium text-gray-700",children:[d.calories.toLocaleString()," calories"]})]}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(os,{className:"w-4 h-4 text-green-500"}),s.jsxs("span",{className:"text-gray-600",children:["P: ",d.protein,"g  C: ",d.carbs,"g  F: ",d.fat,"g"]})]})]}),s.jsx(U,{variant:u>=100?"default":"secondary",className:`
                ${u>=100?"bg-green-100 text-green-800 border-green-200":u>=70?"bg-blue-100 text-blue-800 border-blue-200":"bg-yellow-100 text-yellow-800 border-yellow-200"}
              `,children:u>=100?"Goal Reached!":u>=70?"On Track":"Keep Going"})]})})]})}function qu({onNavigate:r}){const[e,t]=b.useState(new Date),[a,i]=b.useState(new Date),n=pt(),{getTodaysCalories:o,getDailyStats:l,calculatedCalories:c}=Xr(),d=2e3,h=o().reduce((_,k)=>_+k.calories,0),g=c.length,f=_=>{t(_==="prev"?ho(e,1):mo(e,1))};b.useEffect(()=>{const _=()=>{console.log(" Refreshing weekly logger data..."),n.invalidateQueries({queryKey:["/api/meals/logged"]}),n.refetchQueries({queryKey:["/api/meals/logged"]})},k=L=>{console.log(" WeeklyLogger received calories:",L.detail),n.invalidateQueries({queryKey:["/api/meals/logged"]}),n.refetchQueries({queryKey:["/api/meals/logged"]}),setTimeout(()=>{n.invalidateQueries({queryKey:["/api/meals/logged"]}),n.refetchQueries({queryKey:["/api/meals/logged"]})},1e3)},S=()=>{n.invalidateQueries({queryKey:["/api/meals/logged"]})};return window.addEventListener("refresh-weekly-data",_),window.addEventListener("calories-logged",k),window.addEventListener("focus",S),()=>{window.removeEventListener("refresh-weekly-data",_),window.removeEventListener("calories-logged",k),window.removeEventListener("focus",S)}},[n]);const x=uo(e,{weekStartsOn:1}),y=Array.from({length:7},(_,k)=>ji(x,k)),[p,w]=b.useState([]);b.useEffect(()=>{const _=()=>{const S=JSON.parse(localStorage.getItem("weeklyMeals")||"[]");w(S)};_();const k=()=>{_()};return window.addEventListener("calories-logged",k),window.addEventListener("storage",k),()=>{window.removeEventListener("calories-logged",k),window.removeEventListener("storage",k)}},[]),b.useEffect(()=>{const _=()=>{console.log(" Forcing meal data refresh...");const k=JSON.parse(localStorage.getItem("weeklyMeals")||"[]");w(k)};return window.addEventListener("meal-logged-success",_),()=>{window.removeEventListener("meal-logged-success",_)}},[]);const T=_=>p.filter(S=>S.date===we(_,"yyyy-MM-dd")).reduce((S,L)=>({calories:S.calories+L.calories,protein:S.protein+L.protein,carbs:S.carbs+L.carbs,fat:S.fat+L.fat,meals:S.meals+1}),{calories:0,protein:0,carbs:0,fat:0,meals:0}),v=y.reduce((_,k)=>{const S=T(k);return{calories:_.calories+S.calories,protein:_.protein+S.protein,carbs:_.carbs+S.carbs,fat:_.fat+S.fat,meals:_.meals+S.meals}},{calories:0,protein:0,carbs:0,fat:0,meals:0}),C=[{icon:ue,label:"Weekly Cal",value:(v.calories+h).toLocaleString(),color:"text-orange-600",bgColor:"bg-orange-50"},{icon:Pe,label:"Meals Logged",value:v.meals.toString(),color:"text-green-600",bgColor:"bg-green-50"},{icon:ft,label:"Daily Avg",value:Math.round((v.calories+h)/7).toString(),color:"text-blue-600",bgColor:"bg-blue-50"}],N=_=>{const k=p.filter(S=>S.date===we(_,"yyyy-MM-dd"));return{breakfast:k.filter(S=>S.mealType==="breakfast"),lunch:k.filter(S=>S.mealType==="lunch"),dinner:k.filter(S=>S.mealType==="dinner"),snack:k.filter(S=>S.mealType==="snack")}};return s.jsxs("div",{className:"min-h-screen bg-gradient-to-b from-[#a8dadc]/10 to-[#fef7cd]/10",children:[s.jsx(Bs,{title:"Weekly Logger",subtitle:"Advanced nutrition tracking and insights",component:"logger",stats:C,showProgress:!1,className:"pb-6"}),s.jsx("div",{className:"max-w-md mx-auto w-full px-3 space-y-6",children:s.jsxs(Pu,{defaultValue:"overview",className:"w-full",children:[s.jsxs(Iu,{className:"grid w-full grid-cols-3 bg-white/80 backdrop-blur-sm h-12",children:[s.jsxs(tr,{value:"overview",className:"flex items-center justify-center gap-2 h-10 px-3 py-2 text-sm font-medium",children:[s.jsx(Pr,{size:16}),"Overview"]}),s.jsxs(tr,{value:"timeline",className:"flex items-center justify-center gap-2 h-10 px-3 py-2 text-sm font-medium",children:[s.jsx(Us,{size:16}),"Timeline"]}),s.jsxs(tr,{value:"insights",className:"flex items-center justify-center gap-2 h-10 px-3 py-2 text-sm font-medium",children:[s.jsx(ht,{size:16}),"Insights"]})]}),s.jsxs(sr,{value:"overview",className:"space-y-6 mt-6",children:[s.jsx(Fu,{weekStart:x,weeklyTotals:v,calculatedCaloriesTotal:h,dailyCalorieGoal:d,onNavigateWeek:f}),s.jsx(zu,{weekDays:y,getDayTotals:T,selectedDay:a,dailyCalorieGoal:d,onSelectDay:i})]}),s.jsx(sr,{value:"timeline",className:"space-y-6 mt-6",children:s.jsx(Bu,{selectedDay:a,getMealsByType:N,dailyCalorieGoal:d,onNavigate:r})}),s.jsxs(sr,{value:"insights",className:"space-y-6 mt-6",children:[s.jsxs(F,{className:"p-6 bg-white/80 backdrop-blur-sm border-0 shadow-lg",children:[s.jsxs("div",{className:"flex items-center justify-between mb-4",children:[s.jsxs("div",{children:[s.jsx("h3",{className:"text-lg font-bold text-gray-900",children:"Calculator Integration"}),s.jsx("p",{className:"text-sm text-gray-600",children:"Real-time connection to calorie calculator"})]}),s.jsxs(U,{variant:"outline",className:"text-green-600 border-green-600",children:[s.jsx(os,{className:"w-3 h-3 mr-1"}),"Active"]})]}),s.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[s.jsxs("div",{className:"text-center p-4 bg-blue-50 rounded-lg",children:[s.jsx("div",{className:"w-8 h-8 bg-blue-600 rounded-full mx-auto mb-2 flex items-center justify-center",children:s.jsx(Jr,{className:"w-4 h-4 text-white"})}),s.jsx("p",{className:"text-xl font-bold text-blue-600",children:g}),s.jsx("p",{className:"text-xs text-gray-600",children:"Items Calculated"})]}),s.jsxs("div",{className:"text-center p-4 bg-green-50 rounded-lg",children:[s.jsx("div",{className:"w-8 h-8 bg-green-600 rounded-full mx-auto mb-2 flex items-center justify-center",children:s.jsx(Pe,{className:"w-4 h-4 text-white"})}),s.jsx("p",{className:"text-xl font-bold text-green-600",children:v.meals}),s.jsx("p",{className:"text-xs text-gray-600",children:"Meals Logged"})]}),s.jsxs("div",{className:"text-center p-4 bg-orange-50 rounded-lg",children:[s.jsx("div",{className:"w-8 h-8 bg-orange-600 rounded-full mx-auto mb-2 flex items-center justify-center",children:s.jsx(ue,{className:"w-4 h-4 text-white"})}),s.jsx("p",{className:"text-xl font-bold text-orange-600",children:h}),s.jsx("p",{className:"text-xs text-gray-600",children:"Total Calories"})]})]})]}),s.jsxs(F,{className:"p-6 bg-white/80 backdrop-blur-sm border-0 shadow-lg",children:[s.jsxs("div",{className:"flex items-center justify-between mb-4",children:[s.jsxs("div",{children:[s.jsx("h3",{className:"text-lg font-bold text-gray-900",children:"Weekly Insights"}),s.jsx("p",{className:"text-sm text-gray-600",children:"Smart analysis of your nutrition patterns"})]}),s.jsxs(U,{variant:"outline",className:"text-purple-600 border-purple-600",children:[s.jsx(ht,{className:"w-3 h-3 mr-1"}),"AI Powered"]})]}),s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"p-4 bg-gradient-to-r from-blue-50 to-indigo-50 rounded-lg border border-blue-200",children:[s.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[s.jsx(ft,{className:"w-5 h-5 text-blue-600"}),s.jsx("span",{className:"font-semibold text-blue-900",children:"Progress Trend"})]}),s.jsxs("p",{className:"text-sm text-blue-800",children:["You're averaging ",Math.round((v.calories+h)/7)," calories per day this week.",Math.round((v.calories+h)/7)<d?" Consider adding more nutritious meals to reach your daily goal.":" Great job staying consistent with your nutrition goals!"]})]}),s.jsxs("div",{className:"p-4 bg-gradient-to-r from-green-50 to-emerald-50 rounded-lg border border-green-200",children:[s.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[s.jsx(he,{className:"w-5 h-5 text-green-600"}),s.jsx("span",{className:"font-semibold text-green-900",children:"Goal Achievement"})]}),s.jsxs("p",{className:"text-sm text-green-800",children:["You've logged ",v.meals+g," meals this week across ",y.filter(_=>T(_).meals>0).length," days. Keep up the consistent tracking!"]})]}),s.jsxs("div",{className:"p-4 bg-gradient-to-r from-amber-50 to-yellow-50 rounded-lg border border-amber-200",children:[s.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[s.jsx(rs,{className:"w-5 h-5 text-amber-600"}),s.jsx("span",{className:"font-semibold text-amber-900",children:"Recommendation"})]}),s.jsx("p",{className:"text-sm text-amber-800",children:"Use the calorie calculator to plan tomorrow's meals and maintain your nutrition momentum."})]})]})]}),s.jsxs(F,{className:"p-6 bg-white/80 backdrop-blur-sm border-0 shadow-lg",children:[s.jsx("h4",{className:"font-semibold text-gray-900 mb-4",children:"Quick Actions"}),s.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[s.jsxs(A,{variant:"outline",onClick:()=>r("calculator"),className:"flex items-center gap-2 p-4 h-auto",children:[s.jsx("div",{className:"p-2 bg-blue-100 rounded-lg",children:s.jsx(qt,{className:"w-4 h-4 text-blue-600"})}),s.jsxs("div",{className:"text-left",children:[s.jsx("p",{className:"font-medium",children:"Calculate Meal"}),s.jsx("p",{className:"text-xs text-gray-600",children:"Add new nutrition"})]})]}),s.jsxs(A,{variant:"outline",onClick:()=>r("dashboard"),className:"flex items-center gap-2 p-4 h-auto",children:[s.jsx("div",{className:"p-2 bg-green-100 rounded-lg",children:s.jsx(Pr,{className:"w-4 h-4 text-green-600"})}),s.jsxs("div",{className:"text-left",children:[s.jsx("p",{className:"font-medium",children:"View Progress"}),s.jsx("p",{className:"text-xs text-gray-600",children:"See dashboard"})]})]})]})]})]})]})})]})}var sa="Switch",[Wu,_h]=vi(sa),[Gu,Ku]=Wu(sa),Un=b.forwardRef((r,e)=>{const{__scopeSwitch:t,name:a,checked:i,defaultChecked:n,required:o,disabled:l,value:c="on",onCheckedChange:d,form:u,...h}=r,[g,f]=b.useState(null),x=so(e,v=>f(v)),y=b.useRef(!1),p=g?u||!!g.closest("form"):!0,[w=!1,T]=ro({prop:i,defaultProp:n,onChange:d});return s.jsxs(Gu,{scope:t,checked:w,disabled:l,children:[s.jsx(Kt.button,{type:"button",role:"switch","aria-checked":w,"aria-required":o,"data-state":Bn(w),"data-disabled":l?"":void 0,disabled:l,value:c,...h,ref:x,onClick:ao(r.onClick,v=>{T(C=>!C),p&&(y.current=v.isPropagationStopped(),y.current||v.stopPropagation())})}),p&&s.jsx(Vu,{control:g,bubbles:!y.current,name:a,value:c,checked:w,required:o,disabled:l,form:u,style:{transform:"translateX(-100%)"}})]})});Un.displayName=sa;var Fn="SwitchThumb",zn=b.forwardRef((r,e)=>{const{__scopeSwitch:t,...a}=r,i=Ku(Fn,t);return s.jsx(Kt.span,{"data-state":Bn(i.checked),"data-disabled":i.disabled?"":void 0,...a,ref:e})});zn.displayName=Fn;var Vu=r=>{const{control:e,checked:t,bubbles:a=!0,...i}=r,n=b.useRef(null),o=io(t),l=no(e);return b.useEffect(()=>{const c=n.current,d=window.HTMLInputElement.prototype,h=Object.getOwnPropertyDescriptor(d,"checked").set;if(o!==t&&h){const g=new Event("click",{bubbles:a});h.call(c,t),c.dispatchEvent(g)}},[o,t,a]),s.jsx("input",{type:"checkbox","aria-hidden":!0,defaultChecked:t,...i,tabIndex:-1,ref:n,style:{...r.style,...l,position:"absolute",pointerEvents:"none",opacity:0,margin:0}})};function Bn(r){return r?"checked":"unchecked"}var qn=Un,Hu=zn;const me=b.forwardRef(({className:r,...e},t)=>s.jsx(qn,{className:H("peer inline-flex h-5 w-9 shrink-0 cursor-pointer items-center rounded-full border-2 border-transparent transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 focus-visible:ring-offset-background disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=unchecked]:bg-input",r),...e,ref:t,children:s.jsx(Hu,{className:H("pointer-events-none block h-4 w-4 rounded-full bg-background ring-0 transition-transform data-[state=checked]:translate-x-4 data-[state=unchecked]:translate-x-0")})}));me.displayName=qn.displayName;function Qu({isOpen:r,onClose:e,achievement:t}){const[a,i]=b.useState(!1);return b.useEffect(()=>{if(r){i(!0);const n=setTimeout(()=>{e()},4e3);return()=>clearTimeout(n)}},[r,e]),b.useEffect(()=>{if(a){const n=setTimeout(()=>{i(!1)},2e3);return()=>clearTimeout(n)}},[a]),!r||!t?null:s.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/50 backdrop-blur-sm",children:[a&&s.jsx("div",{className:"absolute inset-0 pointer-events-none overflow-hidden",children:Array.from({length:50}).map((n,o)=>s.jsx("div",{className:"absolute animate-pulse",style:{left:`${Math.random()*100}%`,top:`${Math.random()*100}%`,animationDelay:`${Math.random()*2}s`,animationDuration:`${1+Math.random()*2}s`},children:s.jsx(at,{className:`w-3 h-3 ${Math.random()>.5?"text-yellow-400":Math.random()>.5?"text-orange-400":"text-green-400"}`,style:{transform:`rotate(${Math.random()*360}deg)`}})},o))}),s.jsxs(F,{className:"relative max-w-sm mx-4 p-6 bg-white shadow-2xl animate-bounce",children:[s.jsx(A,{variant:"ghost",size:"sm",className:"absolute top-2 right-2 h-8 w-8 p-0",onClick:e,children:s.jsx(Wt,{size:16})}),s.jsxs("div",{className:"text-center mb-4",children:[s.jsx("div",{className:"inline-flex items-center justify-center w-20 h-20 bg-gradient-to-br from-yellow-400 to-orange-500 rounded-full mb-4 animate-pulse",children:s.jsx(Qr,{className:"w-10 h-10 text-white"})}),s.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Achievement Unlocked!"})]}),s.jsxs("div",{className:"text-center",children:[s.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-2",children:t.title}),s.jsx("p",{className:"text-gray-600 text-sm mb-4",children:t.description}),s.jsx(A,{onClick:e,className:"bg-gradient-to-r from-green-500 to-green-600 hover:from-green-600 hover:to-green-700 text-white",children:"Awesome!"})]})]})]})}function Ju(){const[r,e]=b.useState(!1),[t,a]=b.useState(!1),i=async()=>{e(!0);try{const{generateProgressReportPDF:l}=await Ht(async()=>{const{generateProgressReportPDF:d}=await import("./pdfExport-BqIJ0Be_.js");return{generateProgressReportPDF:d}},[],import.meta.url);if(await l()){const d=new CustomEvent("show-toast",{detail:{message:"Progress report downloaded successfully!",type:"success"}});window.dispatchEvent(d)}else throw new Error("PDF generation failed")}catch(l){console.error("Export failed:",l);const c=new CustomEvent("show-toast",{detail:{message:"Export failed. Please try again.",type:"error"}});window.dispatchEvent(c)}finally{e(!1)}},n=async()=>{a(!0);try{await new Promise(l=>setTimeout(l,2e3)),console.log("Data synchronized")}finally{a(!1)}},o=()=>{confirm("Are you sure you want to delete all your data? This action cannot be undone.")&&console.log("Data deletion confirmed")};return s.jsxs(F,{className:"p-6 bg-white/80 backdrop-blur-sm border-0 shadow-lg",children:[s.jsx("h3",{className:"text-lg font-bold text-gray-900 mb-4",children:"Data Management"}),s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{children:[s.jsxs("div",{className:"flex items-center justify-between mb-3",children:[s.jsxs("div",{children:[s.jsx("h4",{className:"font-medium text-gray-900",children:"Export Your Data"}),s.jsx("p",{className:"text-sm text-gray-600",children:"Download comprehensive nutrition reports"})]}),s.jsxs(U,{variant:"outline",className:"text-green-600 border-green-600",children:[s.jsx(as,{className:"w-3 h-3 mr-1"}),"PDF Ready"]})]}),s.jsx("div",{className:"grid grid-cols-1 gap-3",children:s.jsx(A,{onClick:i,disabled:r,className:"bg-blue-600 hover:bg-blue-700 text-white",children:r?s.jsxs(s.Fragment,{children:[s.jsx(Be,{className:"w-4 h-4 mr-2 animate-spin"}),"Generating PDF..."]}):s.jsxs(s.Fragment,{children:[s.jsx(Fs,{className:"w-4 h-4 mr-2"}),"Export to PDF"]})})})]}),s.jsx(ee,{}),s.jsxs("div",{children:[s.jsxs("div",{className:"flex items-center justify-between mb-3",children:[s.jsxs("div",{children:[s.jsx("h4",{className:"font-medium text-gray-900",children:"Sync & Backup"}),s.jsx("p",{className:"text-sm text-gray-600",children:"Keep your data safe and synchronized"})]}),s.jsxs(U,{variant:"outline",className:"text-blue-600 border-blue-600",children:[s.jsx(je,{className:"w-3 h-3 mr-1"}),"Auto-sync On"]})]}),s.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3",children:[s.jsx(A,{onClick:n,disabled:t,variant:"outline",className:"border-blue-600 text-blue-600 hover:bg-blue-50",children:t?s.jsxs(s.Fragment,{children:[s.jsx(Be,{className:"w-4 h-4 mr-2 animate-spin"}),"Syncing..."]}):s.jsxs(s.Fragment,{children:[s.jsx(Be,{className:"w-4 h-4 mr-2"}),"Sync Now"]})}),s.jsxs(A,{variant:"outline",className:"border-emerald-600 text-emerald-600 hover:bg-emerald-50",children:[s.jsx(Me,{className:"w-4 h-4 mr-2"}),"Backup Settings"]})]})]}),s.jsx(ee,{}),s.jsxs("div",{children:[s.jsx("h4",{className:"font-medium text-gray-900 mb-3",children:"Your Data Summary"}),s.jsxs("div",{className:"grid grid-cols-2 sm:grid-cols-4 gap-3",children:[s.jsxs("div",{className:"text-center p-3 bg-gray-50 rounded-lg",children:[s.jsx(Te,{className:"w-5 h-5 mx-auto text-blue-600 mb-1"}),s.jsx("p",{className:"text-xs text-gray-600",children:"Days Tracked"}),s.jsx("p",{className:"font-bold text-gray-900",children:"47"})]}),s.jsxs("div",{className:"text-center p-3 bg-gray-50 rounded-lg",children:[s.jsx(Ar,{className:"w-5 h-5 mx-auto text-green-600 mb-1"}),s.jsx("p",{className:"text-xs text-gray-600",children:"Meals Logged"}),s.jsx("p",{className:"font-bold text-gray-900",children:"156"})]}),s.jsxs("div",{className:"text-center p-3 bg-gray-50 rounded-lg",children:[s.jsx(as,{className:"w-5 h-5 mx-auto text-purple-600 mb-1"}),s.jsx("p",{className:"text-xs text-gray-600",children:"Recipes Created"}),s.jsx("p",{className:"font-bold text-gray-900",children:"12"})]}),s.jsxs("div",{className:"text-center p-3 bg-gray-50 rounded-lg",children:[s.jsx(Me,{className:"w-5 h-5 mx-auto text-orange-600 mb-1"}),s.jsx("p",{className:"text-xs text-gray-600",children:"Data Size"}),s.jsx("p",{className:"font-bold text-gray-900",children:"2.4 MB"})]})]})]}),s.jsx(ee,{}),s.jsx("div",{children:s.jsxs("div",{className:"p-4 bg-red-50 border border-red-200 rounded-lg",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[s.jsx(Ir,{className:"w-5 h-5 text-red-600"}),s.jsx("h4",{className:"font-medium text-red-700",children:"Danger Zone"})]}),s.jsx("p",{className:"text-sm text-red-600 mb-3",children:"Permanently delete all your nutrition data"}),s.jsxs(A,{variant:"destructive",className:"w-full justify-center hover:bg-red-600 transition-all duration-200",onClick:o,children:[s.jsx(wn,{className:"w-4 h-4 mr-2"}),"Delete All Data"]})]})})]})]})}function ti({user:r}){var d,u,h,g,f,x,y;const[e,t]=b.useState(!1),[a,i]=b.useState(!1),[n,o]=b.useState({firstName:(r==null?void 0:r.firstName)||"",lastName:(r==null?void 0:r.lastName)||"",email:(r==null?void 0:r.email)||"",age:((d=r==null?void 0:r.personalInfo)==null?void 0:d.age)||"",heightFeet:(u=r==null?void 0:r.personalInfo)!=null&&u.height?Math.floor(r.personalInfo.height/12):"",heightInches:(h=r==null?void 0:r.personalInfo)!=null&&h.height?r.personalInfo.height%12:"",weight:((g=r==null?void 0:r.personalInfo)==null?void 0:g.weight)||"",activityLevel:((f=r==null?void 0:r.personalInfo)==null?void 0:f.activityLevel)||"moderate",gender:((x=r==null?void 0:r.personalInfo)==null?void 0:x.gender)||""}),l=()=>{console.log("Saving profile data:",n),i(!1)},c=()=>{var p,w,T,v,C,N;o({firstName:(r==null?void 0:r.firstName)||"",lastName:(r==null?void 0:r.lastName)||"",email:(r==null?void 0:r.email)||"",age:((p=r==null?void 0:r.personalInfo)==null?void 0:p.age)||"",heightFeet:(w=r==null?void 0:r.personalInfo)!=null&&w.height?Math.floor(r.personalInfo.height/12):"",heightInches:(T=r==null?void 0:r.personalInfo)!=null&&T.height?r.personalInfo.height%12:"",weight:((v=r==null?void 0:r.personalInfo)==null?void 0:v.weight)||"",activityLevel:((C=r==null?void 0:r.personalInfo)==null?void 0:C.activityLevel)||"moderate",gender:((N=r==null?void 0:r.personalInfo)==null?void 0:N.gender)||""}),i(!1)};return s.jsxs(F,{className:"p-6 bg-white/80 backdrop-blur-sm border-0 shadow-lg",children:[s.jsx("div",{className:"mb-4",children:s.jsxs("div",{className:"flex items-center gap-4 mb-4",children:[s.jsx("div",{className:"w-16 h-16 bg-gradient-to-br from-blue-100 to-blue-200 rounded-full flex items-center justify-center",children:s.jsx(Ps,{className:"w-8 h-8 text-blue-600"})}),s.jsxs("div",{children:[s.jsxs("h3",{className:"text-xl font-bold text-gray-900",children:[r==null?void 0:r.firstName," ",r==null?void 0:r.lastName]}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(Es,{className:"w-4 h-4 text-gray-500"}),s.jsx("span",{className:"text-gray-600",children:r==null?void 0:r.email}),(r==null?void 0:r.emailVerified)&&s.jsx(je,{className:"w-4 h-4 text-green-500"})]})]})]})}),s.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-3 mb-4",children:[s.jsxs("div",{className:"text-center p-3 bg-blue-50 rounded-lg",children:[s.jsx(he,{className:"w-5 h-5 mx-auto text-blue-600 mb-1"}),s.jsx("p",{className:"text-xs text-gray-600",children:"Age"}),s.jsx("p",{className:"font-bold text-gray-900",children:n.age||"Not set"})]}),s.jsxs("div",{className:"text-center p-3 bg-green-50 rounded-lg",children:[s.jsx(bn,{className:"w-5 h-5 mx-auto text-green-600 mb-1"}),s.jsx("p",{className:"text-xs text-gray-600",children:"Weight"}),s.jsx("p",{className:"font-bold text-gray-900",children:n.weight?`${n.weight} lbs`:"Not set"})]}),s.jsxs("div",{className:"text-center p-3 bg-purple-50 rounded-lg",children:[s.jsx(ft,{className:"w-5 h-5 mx-auto text-purple-600 mb-1"}),s.jsx("p",{className:"text-xs text-gray-600",children:"Height"}),s.jsx("p",{className:"font-bold text-gray-900",children:n.heightFeet&&n.heightInches?`${n.heightFeet}'${n.heightInches}"`:"Not set"})]}),s.jsxs("div",{className:"text-center p-3 bg-orange-50 rounded-lg",children:[s.jsx(os,{className:"w-5 h-5 mx-auto text-orange-600 mb-1"}),s.jsx("p",{className:"text-xs text-gray-600",children:"Activity"}),s.jsx("p",{className:"font-bold text-gray-900 capitalize",children:n.activityLevel})]})]}),e&&s.jsxs(s.Fragment,{children:[s.jsx(ee,{className:"my-4"}),a?s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{children:[s.jsx("h4",{className:"font-medium text-gray-900 mb-3",children:"Basic Information"}),s.jsxs("div",{className:"grid grid-cols-1 gap-4",children:[s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"First Name"}),s.jsx(oe,{value:n.firstName,onChange:p=>o({...n,firstName:p.target.value}),placeholder:"Enter first name"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Last Name"}),s.jsx(oe,{value:n.lastName,onChange:p=>o({...n,lastName:p.target.value}),placeholder:"Enter last name"})]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Email Address"}),s.jsx(oe,{type:"email",value:n.email,onChange:p=>o({...n,email:p.target.value}),placeholder:"Enter email address"})]})]})]}),s.jsxs("div",{children:[s.jsx("h4",{className:"font-medium text-gray-900 mb-3",children:"Physical Details"}),s.jsxs("div",{className:"grid grid-cols-1 gap-4",children:[s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Age"}),s.jsx(oe,{type:"number",value:n.age,onChange:p=>o({...n,age:p.target.value}),placeholder:"Enter age"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Weight (lbs)"}),s.jsx(oe,{type:"number",value:n.weight,onChange:p=>o({...n,weight:p.target.value}),placeholder:"Enter weight in pounds"})]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Height"}),s.jsxs("div",{className:"flex gap-2",children:[s.jsx(oe,{type:"number",value:n.heightFeet,onChange:p=>o({...n,heightFeet:p.target.value}),placeholder:"Feet",className:"flex-1"}),s.jsx(oe,{type:"number",value:n.heightInches,onChange:p=>o({...n,heightInches:p.target.value}),placeholder:"Inches",className:"flex-1"})]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Gender"}),s.jsxs("select",{value:n.gender,onChange:p=>o({...n,gender:p.target.value}),className:"w-full p-2 border border-gray-300 rounded-md",children:[s.jsx("option",{value:"",children:"Select gender"}),s.jsx("option",{value:"male",children:"Male"}),s.jsx("option",{value:"female",children:"Female"}),s.jsx("option",{value:"other",children:"Other"}),s.jsx("option",{value:"prefer-not-to-say",children:"Prefer not to say"})]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Activity Level"}),s.jsxs("select",{value:n.activityLevel,onChange:p=>o({...n,activityLevel:p.target.value}),className:"w-full p-2 border border-gray-300 rounded-md",children:[s.jsx("option",{value:"sedentary",children:"Sedentary (little/no exercise)"}),s.jsx("option",{value:"light",children:"Light (light exercise 1-3 days/week)"}),s.jsx("option",{value:"moderate",children:"Moderate (moderate exercise 3-5 days/week)"}),s.jsx("option",{value:"active",children:"Active (hard exercise 6-7 days/week)"}),s.jsx("option",{value:"very-active",children:"Very Active (very hard exercise/physical job)"})]})]})]})]})]}):s.jsx("div",{className:"space-y-4",children:s.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[s.jsxs("div",{children:[s.jsx("span",{className:"text-gray-600",children:"Account ID:"}),s.jsxs("span",{className:"ml-2 font-medium",children:[(y=r==null?void 0:r.id)==null?void 0:y.slice(0,8),"..."]})]}),s.jsxs("div",{children:[s.jsx("span",{className:"text-gray-600",children:"Member since:"}),s.jsx("span",{className:"ml-2 font-medium",children:r!=null&&r.createdAt?new Date(r.createdAt).toLocaleDateString():"Recent"})]}),s.jsxs("div",{children:[s.jsx("span",{className:"text-gray-600",children:"Profile status:"}),s.jsx(U,{variant:"outline",className:"ml-2 text-green-600 border-green-600",children:"Active"})]}),s.jsxs("div",{children:[s.jsx("span",{className:"text-gray-600",children:"Email verified:"}),s.jsx("span",{className:"ml-2",children:r!=null&&r.emailVerified?s.jsxs(U,{variant:"outline",className:"text-green-600 border-green-600",children:[s.jsx(je,{className:"w-3 h-3 mr-1"}),"Verified"]}):s.jsx(U,{variant:"outline",className:"text-orange-600 border-orange-600",children:"Pending"})})]})]})})]}),s.jsxs("div",{className:"flex items-center justify-center gap-2 mt-6 pt-4 border-t border-gray-100",children:[s.jsx(A,{variant:"outline",size:"sm",onClick:()=>t(!e),className:"flex items-center gap-2 flex-1",children:e?s.jsxs(s.Fragment,{children:[s.jsx(pn,{className:"w-4 h-4"}),"Less Info"]}):s.jsxs(s.Fragment,{children:[s.jsx(Vr,{className:"w-4 h-4"}),"More Info"]})}),a?s.jsxs("div",{className:"flex gap-2 flex-1",children:[s.jsxs(A,{size:"sm",onClick:l,className:"bg-green-600 hover:bg-green-700 flex-1",children:[s.jsx(kd,{className:"w-4 h-4 mr-2"}),"Save"]}),s.jsxs(A,{size:"sm",variant:"outline",onClick:c,className:"flex-1",children:[s.jsx(Wt,{className:"w-4 h-4 mr-2"}),"Cancel"]})]}):s.jsxs(A,{size:"sm",onClick:()=>i(!0),className:"bg-blue-600 hover:bg-blue-700 flex-1",children:[s.jsx(Sd,{className:"w-4 h-4 mr-2"}),"Edit"]})]})]})}const Yu="2.1.1",Zu="2025-01-30",Xu=()=>({version:Yu,buildDate:Zu,changelog:["Enhanced calorie calculator and logger communication","Improved header spacing and icon sizes","Added food background images to hero components","Fixed Privacy & Security button interactions","Imperial system integration complete","Achievement celebration system with confetti","Enhanced mobile PWA optimizations"],required:!1}),si=r=>`v${r}`,eh=r=>new Date(r).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"});function th({onNavigate:r}){const[e,t]=b.useState("profile"),[a,i]=b.useState($r());b.useEffect(()=>{const P=q=>{const{section:ce}=q.detail;ce==="notifications"||ce==="settings"?t("notifications"):ce==="history"&&t("data")};return window.addEventListener("navigate-to-profile-section",P),()=>{window.removeEventListener("navigate-to-profile-section",P)}},[]);const[n,o]=b.useState(!1),[l,c]=b.useState(null);b.useState(null),b.useState(!1);const[d,u]=b.useState(!1);pt();const{user:h}=un(),g=Xu(),{data:f,isLoading:x}=Et({queryKey:["/api/auth/user"],staleTime:5*60*1e3}),y=f||h;Et({queryKey:["/api/achievements"],staleTime:10*60*1e3});const p={totalMealsLogged:0,currentStreak:0,caloriesTracked:0,favoriteFood:"Not set",joinedDate:new Date().toLocaleDateString("en-US",{month:"long",year:"numeric"})},w=[{id:"profile",label:"Personal Info",icon:Ps},{id:"achievements",label:"Achievements",icon:ht},{id:"privacy",label:"Privacy & Security",icon:Me},{id:"notifications",label:"Notifications",icon:Ze},{id:"display",label:"Display Settings",icon:vs},{id:"data",label:"Data Management",icon:Ar},{id:"about",label:"About Bytewise",icon:Hr}],T=[{id:1,title:"First Steps",description:"Logged your first meal and started your nutrition journey",icon:he,colorClass:"bg-green-100 text-green-600",trophyType:"Bronze",earnedAt:"2025-01-15",points:50,category:"Getting Started"},{id:2,title:"Week Warrior",description:"Maintained consistent logging for 7 consecutive days",icon:Te,colorClass:"bg-blue-100 text-blue-600",trophyType:"Silver",earnedAt:"2025-01-22",points:100,category:"Consistency"},{id:3,title:"Calorie Master",description:"Successfully tracked 10,000 total calories",icon:ue,colorClass:"bg-orange-100 text-orange-600",trophyType:"Gold",earnedAt:"2025-01-28",points:200,category:"Tracking"}],v=()=>s.jsx("div",{className:"space-y-6",children:s.jsxs(F,{className:"p-6 bg-white/80 backdrop-blur-sm border-0 shadow-lg",children:[s.jsxs("div",{className:"flex items-center justify-between mb-4",children:[s.jsx("h3",{className:"text-lg font-bold text-gray-900",children:"Achievement Gallery"}),s.jsxs(U,{variant:"secondary",className:"bg-yellow-100 text-yellow-800",children:[s.jsx(at,{className:"w-3 h-3 mr-1"}),T.reduce((P,q)=>P+q.points,0)," Points"]})]}),s.jsx("div",{className:"grid grid-cols-1 gap-4",children:T.map(P=>{const q=P.icon;return s.jsx("div",{className:"p-4 border border-gray-200 rounded-lg bg-gradient-to-r from-gray-50 to-gray-100 hover:shadow-md transition-shadow cursor-pointer",onClick:()=>{console.log("Viewing achievement:",P.title)},children:s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsx("div",{className:`p-3 rounded-lg ${P.colorClass}`,children:s.jsx(q,{className:"w-6 h-6"})}),s.jsxs("div",{className:"flex-1",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[s.jsx("h4",{className:"font-bold text-gray-900",children:P.title}),s.jsx(U,{variant:"outline",className:"text-xs",children:P.trophyType})]}),s.jsx("p",{className:"text-sm text-gray-600 mb-2",children:P.description}),s.jsxs("div",{className:"flex items-center justify-between text-xs text-gray-500",children:[s.jsxs("span",{children:["Category: ",P.category]}),s.jsxs("span",{children:[P.points," points"]}),s.jsxs("span",{children:["Earned ",new Date(P.earnedAt).toLocaleDateString()]})]})]}),s.jsx(Qr,{className:"w-5 h-5 text-yellow-500"})]})},P.id)})}),s.jsx(ee,{className:"my-4"})]})}),C=()=>s.jsx("div",{className:"space-y-6",children:s.jsxs(F,{className:"p-6 bg-white/80 backdrop-blur-sm border-0 shadow-lg",children:[s.jsx("h3",{className:"text-lg font-bold text-gray-900 mb-4",children:"Privacy & Security"}),s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{children:[s.jsxs("div",{className:"flex items-center justify-between mb-3",children:[s.jsxs("div",{children:[s.jsx("h4",{className:"font-medium text-gray-900",children:"Privacy Controls"}),s.jsx("p",{className:"text-sm text-gray-600",children:"Manage your data visibility and sharing preferences"})]}),s.jsxs(U,{variant:"outline",className:"text-blue-600 border-blue-600",children:[s.jsx(rs,{className:"w-3 h-3 mr-1"}),"Private"]})]}),s.jsxs("div",{className:"grid grid-cols-1 gap-3",children:[s.jsxs("div",{className:"flex items-center justify-between p-3 rounded-lg bg-purple-50 hover:bg-purple-100 transition-colors",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(rs,{className:"w-4 h-4 text-purple-600"}),s.jsx("span",{className:"text-sm",children:"Profile visibility to others"})]}),s.jsx(me,{defaultChecked:!1,onCheckedChange:P=>{console.log("Profile visibility:",P)}})]}),s.jsxs("div",{className:"flex items-center justify-between p-3 rounded-lg bg-blue-50 hover:bg-blue-100 transition-colors",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(Qa,{className:"w-4 h-4 text-blue-600"}),s.jsx("span",{className:"text-sm",children:"Share analytics for improvement"})]}),s.jsx(me,{defaultChecked:!0,onCheckedChange:P=>{console.log("Data sharing:",P)}})]})]})]}),s.jsx(ee,{}),s.jsxs("div",{children:[s.jsxs("div",{className:"flex items-center justify-between mb-3",children:[s.jsxs("div",{children:[s.jsx("h4",{className:"font-medium text-gray-900",children:"Account Security"}),s.jsx("p",{className:"text-sm text-gray-600",children:"Enhance your account protection"})]}),s.jsxs(U,{variant:"outline",className:"text-green-600 border-green-600",children:[s.jsx(Me,{className:"w-3 h-3 mr-1"}),"Secure"]})]}),s.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3",children:[s.jsxs(A,{variant:"outline",className:"slide-button border-blue-600 text-blue-600 hover:bg-blue-50 transform transition-all duration-300 hover:scale-105 hover:shadow-lg",children:[s.jsx(Rr,{className:"w-4 h-4 mr-2"}),"Change Password"]}),s.jsxs(A,{variant:"outline",className:"slide-button border-blue-600 text-blue-600 hover:bg-blue-50 transform transition-all duration-300 hover:scale-105 hover:shadow-lg",children:[s.jsx(Me,{className:"w-4 h-4 mr-2"}),"Security Settings"]}),s.jsxs("div",{className:"flex items-center justify-between p-3 rounded-lg bg-emerald-50 hover:bg-emerald-100 transition-colors",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(Me,{className:"w-4 h-4 text-emerald-600"}),s.jsx("span",{className:"text-sm",children:"Enable 2FA"})]}),s.jsx(me,{defaultChecked:!1,onCheckedChange:P=>{console.log("Two-factor authentication:",P)}})]})]})]}),s.jsx(ee,{}),s.jsxs("div",{children:[s.jsx("h4",{className:"font-medium text-gray-900 mb-3",children:"Security Status"}),s.jsxs("div",{className:"grid grid-cols-1 gap-3",children:[s.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[s.jsxs("div",{className:"text-center p-3 bg-white/80 backdrop-blur-sm border-0 shadow-lg rounded-lg",children:[s.jsx(Me,{className:"w-5 h-5 mx-auto text-green-600 mb-1"}),s.jsx("p",{className:"text-xs text-gray-600",children:"Account Status"}),s.jsx("p",{className:"font-bold text-gray-900",children:"Secure"})]}),s.jsxs("div",{className:"text-center p-3 bg-white/80 backdrop-blur-sm border-0 shadow-lg rounded-lg",children:[s.jsx(Rr,{className:"w-5 h-5 mx-auto text-blue-600 mb-1"}),s.jsx("p",{className:"text-xs text-gray-600",children:"Last Login"}),s.jsx("p",{className:"font-bold text-gray-900",children:"Today"})]})]}),s.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[s.jsxs("div",{className:"text-center p-3 bg-white/80 backdrop-blur-sm border-0 shadow-lg rounded-lg",children:[s.jsx(Qa,{className:"w-5 h-5 mx-auto text-purple-600 mb-1"}),s.jsx("p",{className:"text-xs text-gray-600",children:"Data Privacy"}),s.jsx("p",{className:"font-bold text-gray-900",children:"Protected"})]}),s.jsxs("div",{className:"text-center p-3 bg-white/80 backdrop-blur-sm border-0 shadow-lg rounded-lg",children:[s.jsx(rs,{className:"w-5 h-5 mx-auto text-orange-600 mb-1"}),s.jsx("p",{className:"text-xs text-gray-600",children:"Visibility"}),s.jsx("p",{className:"font-bold text-gray-900",children:"Private"})]})]})]})]})]})]})}),N=()=>s.jsx("div",{className:"space-y-6",children:s.jsxs(F,{className:"p-6 bg-white/80 backdrop-blur-sm border-0 shadow-lg",children:[s.jsx("h3",{className:"text-lg font-bold text-gray-900 mb-4",children:"Notification Preferences"}),s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{children:[s.jsxs("div",{className:"flex items-center justify-between mb-3",children:[s.jsxs("div",{children:[s.jsx("h4",{className:"font-medium text-gray-900",children:"Meal & Health Notifications"}),s.jsx("p",{className:"text-sm text-gray-600",children:"Stay on track with your nutrition goals"})]}),s.jsxs(U,{variant:"outline",className:"text-green-600 border-green-600",children:[s.jsx(Ze,{className:"w-3 h-3 mr-1"}),"Active"]})]}),s.jsxs("div",{className:"grid grid-cols-1 gap-3",children:[s.jsxs("div",{className:"flex items-center justify-between p-3 rounded-lg bg-amber-50 hover:bg-amber-100 transition-colors",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(Pe,{className:"w-4 h-4 text-amber-600"}),s.jsx("span",{className:"text-sm",children:"Meal reminders"})]}),s.jsx(me,{defaultChecked:!0,onCheckedChange:P=>{console.log("Meal reminders:",P)}})]}),s.jsxs("div",{className:"flex items-center justify-between p-3 rounded-lg bg-emerald-50 hover:bg-emerald-100 transition-colors",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(as,{className:"w-4 h-4 text-emerald-600"}),s.jsx("span",{className:"text-sm",children:"Weekly nutrition reports"})]}),s.jsx(me,{defaultChecked:!1,onCheckedChange:P=>{console.log("Weekly reports:",P)}})]})]})]}),s.jsx(ee,{}),s.jsxs("div",{children:[s.jsxs("div",{className:"flex items-center justify-between mb-3",children:[s.jsxs("div",{children:[s.jsx("h4",{className:"font-medium text-gray-900",children:"App Notifications"}),s.jsx("p",{className:"text-sm text-gray-600",children:"Updates and achievement alerts"})]}),s.jsxs(U,{variant:"outline",className:"text-purple-600 border-purple-600",children:[s.jsx(at,{className:"w-3 h-3 mr-1"}),"Enabled"]})]}),s.jsxs("div",{className:"grid grid-cols-1 gap-3",children:[s.jsxs("div",{className:"flex items-center justify-between p-3 rounded-lg bg-purple-50 hover:bg-purple-100 transition-colors",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(ht,{className:"w-4 h-4 text-purple-600"}),s.jsx("span",{className:"text-sm",children:"Achievement alerts"})]}),s.jsx(me,{defaultChecked:!0,onCheckedChange:P=>{console.log("Achievement alerts:",P)}})]}),s.jsxs("div",{className:"flex items-center justify-between p-3 rounded-lg bg-blue-50 hover:bg-blue-100 transition-colors",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(Be,{className:"w-4 h-4 text-blue-600"}),s.jsx("span",{className:"text-sm",children:"App update notifications"})]}),s.jsx(me,{defaultChecked:!0,onCheckedChange:P=>{console.log("App updates:",P)}})]})]})]}),s.jsx(ee,{}),s.jsxs("div",{children:[s.jsx("h4",{className:"font-medium text-gray-900 mb-3",children:"Notification Summary"}),s.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[s.jsxs("div",{className:"text-center p-3 bg-white/80 backdrop-blur-sm border-0 shadow-lg rounded-lg",children:[s.jsx(Ze,{className:"w-5 h-5 mx-auto text-green-600 mb-1"}),s.jsx("p",{className:"text-xs text-gray-600",children:"Total Enabled"}),s.jsx("p",{className:"font-bold text-gray-900",children:"3/4"})]}),s.jsxs("div",{className:"text-center p-3 bg-white/80 backdrop-blur-sm border-0 shadow-lg rounded-lg",children:[s.jsx(Pe,{className:"w-5 h-5 mx-auto text-amber-600 mb-1"}),s.jsx("p",{className:"text-xs text-gray-600",children:"Meal Alerts"}),s.jsx("p",{className:"font-bold text-gray-900",children:"On"})]}),s.jsxs("div",{className:"text-center p-3 bg-white/80 backdrop-blur-sm border-0 shadow-lg rounded-lg",children:[s.jsx(ht,{className:"w-5 h-5 mx-auto text-purple-600 mb-1"}),s.jsx("p",{className:"text-xs text-gray-600",children:"Achievements"}),s.jsx("p",{className:"font-bold text-gray-900",children:"On"})]}),s.jsxs("div",{className:"text-center p-3 bg-white/80 backdrop-blur-sm border-0 shadow-lg rounded-lg",children:[s.jsx(Be,{className:"w-5 h-5 mx-auto text-blue-600 mb-1"}),s.jsx("p",{className:"text-xs text-gray-600",children:"App Updates"}),s.jsx("p",{className:"font-bold text-gray-900",children:"On"})]})]})]})]})]})}),_=()=>s.jsx("div",{className:"space-y-6",children:s.jsxs(F,{className:"p-6 bg-white/80 backdrop-blur-sm border-0 shadow-lg",children:[s.jsx("h3",{className:"text-lg font-bold text-gray-900 mb-4",children:"Display Preferences"}),s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{children:[s.jsxs("div",{className:"flex items-center justify-between mb-3",children:[s.jsxs("div",{children:[s.jsx("h4",{className:"font-medium text-gray-900",children:"Theme Preferences"}),s.jsx("p",{className:"text-sm text-gray-600",children:"Customize your app appearance"})]}),s.jsxs(U,{variant:"outline",className:"text-blue-600 border-blue-600",children:[s.jsx(vs,{className:"w-3 h-3 mr-1"}),"Light Mode"]})]}),s.jsxs("div",{className:"grid grid-cols-1 gap-3",children:[s.jsxs("div",{className:"flex items-center justify-between p-3 rounded-lg bg-blue-50 hover:bg-blue-100 transition-colors",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(Mr,{className:"w-4 h-4 text-blue-600"}),s.jsx("span",{className:"text-sm",children:"Auto theme"})]}),s.jsx(me,{defaultChecked:!0,onCheckedChange:P=>{console.log("Auto theme:",P)}})]}),s.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3",children:[s.jsxs(A,{variant:"outline",className:"border-blue-600 text-blue-600 hover:bg-blue-50",children:[s.jsx(vn,{className:"w-4 h-4 mr-2"}),"Light Mode"]}),s.jsxs(A,{variant:"outline",className:"border-blue-600 text-blue-600 hover:bg-blue-50",children:[s.jsx(yn,{className:"w-4 h-4 mr-2"}),"Dark Mode"]})]})]})]}),s.jsx(ee,{}),s.jsxs("div",{children:[s.jsxs("div",{className:"flex items-center justify-between mb-3",children:[s.jsxs("div",{children:[s.jsx("h4",{className:"font-medium text-gray-900",children:"Display Options"}),s.jsx("p",{className:"text-sm text-gray-600",children:"Adjust text size and layout preferences"})]}),s.jsxs(U,{variant:"outline",className:"text-green-600 border-green-600",children:[s.jsx(Xs,{className:"w-3 h-3 mr-1"}),"Optimized"]})]}),s.jsxs("div",{className:"grid grid-cols-1 gap-3",children:[s.jsxs("div",{className:"flex items-center justify-between p-3 rounded-lg bg-purple-50 hover:bg-purple-100 transition-colors",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(Xs,{className:"w-4 h-4 text-purple-600"}),s.jsx("span",{className:"text-sm",children:"Large text size"})]}),s.jsx(me,{defaultChecked:!1,onCheckedChange:P=>{console.log("Large text:",P)}})]}),s.jsxs("div",{className:"flex items-center justify-between p-3 rounded-lg bg-green-50 hover:bg-green-100 transition-colors",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(Ga,{className:"w-4 h-4 text-green-600"}),s.jsx("span",{className:"text-sm",children:"Imperial units (lb, ft)"})]}),s.jsx(me,{defaultChecked:!0,onCheckedChange:P=>{console.log("Imperial units:",P)}})]}),s.jsxs("div",{className:"flex items-center justify-between p-3 rounded-lg bg-blue-50 hover:bg-blue-100 transition-colors",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(Be,{className:"w-4 h-4 text-blue-600"}),s.jsx("span",{className:"text-sm",children:"Rotate background images"})]}),s.jsx(me,{checked:a,onCheckedChange:P=>{yu(P),i(P),P&&St(),console.log("Image rotation:",P)}})]})]})]}),s.jsx(ee,{}),s.jsxs("div",{children:[s.jsx("h4",{className:"font-medium text-gray-900 mb-3",children:"Display Summary"}),s.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[s.jsxs("div",{className:"text-center p-3 bg-white/80 backdrop-blur-sm border-0 shadow-lg rounded-lg",children:[s.jsx(vs,{className:"w-5 h-5 mx-auto text-blue-600 mb-1"}),s.jsx("p",{className:"text-xs text-gray-600",children:"Theme"}),s.jsx("p",{className:"font-bold text-gray-900",children:"Light"})]}),s.jsxs("div",{className:"text-center p-3 bg-white/80 backdrop-blur-sm border-0 shadow-lg rounded-lg",children:[s.jsx(Xs,{className:"w-5 h-5 mx-auto text-purple-600 mb-1"}),s.jsx("p",{className:"text-xs text-gray-600",children:"Text Size"}),s.jsx("p",{className:"font-bold text-gray-900",children:"Normal"})]}),s.jsxs("div",{className:"text-center p-3 bg-white/80 backdrop-blur-sm border-0 shadow-lg rounded-lg",children:[s.jsx(Ga,{className:"w-5 h-5 mx-auto text-green-600 mb-1"}),s.jsx("p",{className:"text-xs text-gray-600",children:"Units"}),s.jsx("p",{className:"font-bold text-gray-900",children:"Imperial"})]}),s.jsxs("div",{className:"text-center p-3 bg-white/80 backdrop-blur-sm border-0 shadow-lg rounded-lg",children:[s.jsx(Mr,{className:"w-5 h-5 mx-auto text-blue-600 mb-1"}),s.jsx("p",{className:"text-xs text-gray-600",children:"Mode"}),s.jsx("p",{className:"font-bold text-gray-900",children:"Auto"})]}),s.jsxs("div",{className:"text-center p-3 bg-white/80 backdrop-blur-sm border-0 shadow-lg rounded-lg",children:[s.jsx(Be,{className:"w-5 h-5 mx-auto text-blue-600 mb-1"}),s.jsx("p",{className:"text-xs text-gray-600",children:"Food Images"}),s.jsxs("p",{className:"font-bold text-gray-900",children:[bu()," Total"]})]}),s.jsxs("div",{className:"text-center p-3 bg-white/80 backdrop-blur-sm border-0 shadow-lg rounded-lg",children:[s.jsx(vs,{className:"w-5 h-5 mx-auto text-purple-600 mb-1"}),s.jsx("p",{className:"text-xs text-gray-600",children:"Rotation"}),s.jsx("p",{className:"font-bold text-gray-900",children:a?"On":"Off"})]})]})]})]})]})}),k=()=>s.jsx("div",{className:"space-y-6",children:s.jsxs(F,{className:"p-6 bg-white/80 backdrop-blur-sm border-0 shadow-lg",children:[s.jsx("h3",{className:"text-lg font-bold text-gray-900 mb-4",children:"About Bytewise Nutritionist"}),s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{children:[s.jsxs("div",{className:"flex items-center justify-between mb-3",children:[s.jsxs("div",{children:[s.jsx("h4",{className:"font-medium text-gray-900",children:"App Information"}),s.jsx("p",{className:"text-sm text-gray-600",children:"Version details and system status"})]}),s.jsxs(U,{variant:"outline",className:"text-green-600 border-green-600",children:[s.jsx(at,{className:"w-3 h-3 mr-1"}),"v",si(g.version)]})]}),s.jsxs("div",{className:"text-center py-4 mb-4 bg-gradient-to-r from-blue-50 to-purple-50 rounded-lg",children:[s.jsx("div",{className:"w-16 h-16 bg-blue-100 rounded-full flex items-center justify-center mx-auto mb-3",children:s.jsx(at,{className:"w-8 h-8 text-blue-600"})}),s.jsx("h4",{className:"text-xl font-bold text-gray-900",children:" Bytewise"}),s.jsx("p",{className:"text-gray-600",children:"Your Personal Nutrition Companion"})]}),s.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3",children:[s.jsxs(A,{variant:"outline",className:"border-blue-600 text-blue-600 hover:bg-blue-50",children:[s.jsx(Fs,{className:"w-4 h-4 mr-2"}),"Check Updates"]}),s.jsxs(A,{variant:"outline",className:"border-blue-600 text-blue-600 hover:bg-blue-50",children:[s.jsx(as,{className:"w-4 h-4 mr-2"}),"Release Notes"]})]})]}),s.jsx(ee,{}),s.jsxs("div",{children:[s.jsxs("div",{className:"flex items-center justify-between mb-3",children:[s.jsxs("div",{children:[s.jsx("h4",{className:"font-medium text-gray-900",children:"Technical Details"}),s.jsx("p",{className:"text-sm text-gray-600",children:"System information and build details"})]}),s.jsxs(U,{variant:"outline",className:"text-purple-600 border-purple-600",children:[s.jsx(Ts,{className:"w-3 h-3 mr-1"}),"Stable"]})]}),s.jsxs("div",{className:"space-y-3 text-sm text-gray-600",children:[s.jsxs("div",{className:"flex justify-between p-3 bg-gray-50 rounded-lg",children:[s.jsx("span",{children:"App Version"}),s.jsx("span",{className:"font-medium text-gray-900",children:si(g.version)})]}),s.jsxs("div",{className:"flex justify-between p-3 bg-gray-50 rounded-lg",children:[s.jsx("span",{children:"Build Date"}),s.jsx("span",{className:"font-medium text-gray-900",children:eh(g.buildDate)})]}),s.jsxs("div",{className:"flex justify-between p-3 bg-gray-50 rounded-lg",children:[s.jsx("span",{children:"Database"}),s.jsx("span",{className:"font-medium text-gray-900",children:"USDA FoodData Central"})]}),s.jsxs("div",{className:"flex justify-between p-3 bg-gray-50 rounded-lg",children:[s.jsx("span",{children:"Platform"}),s.jsx("span",{className:"font-medium text-gray-900",children:"Progressive Web App"})]})]})]}),s.jsx(ee,{}),s.jsxs("div",{children:[s.jsx("h4",{className:"font-medium text-gray-900 mb-3",children:"App Status"}),s.jsxs("div",{className:"grid grid-cols-1 gap-3",children:[s.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[s.jsxs("div",{className:"text-center p-3 bg-gray-50 rounded-lg",children:[s.jsx(at,{className:"w-5 h-5 mx-auto text-green-600 mb-1"}),s.jsx("p",{className:"text-xs text-gray-600",children:"Version"}),s.jsx("p",{className:"font-bold text-gray-900",children:"Latest"})]}),s.jsxs("div",{className:"text-center p-3 bg-gray-50 rounded-lg",children:[s.jsx(Ar,{className:"w-5 h-5 mx-auto text-blue-600 mb-1"}),s.jsx("p",{className:"text-xs text-gray-600",children:"Database"}),s.jsx("p",{className:"font-bold text-gray-900",children:"USDA"})]})]}),s.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[s.jsxs("div",{className:"text-center p-3 bg-gray-50 rounded-lg",children:[s.jsx(Me,{className:"w-5 h-5 mx-auto text-purple-600 mb-1"}),s.jsx("p",{className:"text-xs text-gray-600",children:"Security"}),s.jsx("p",{className:"font-bold text-gray-900",children:"Secure"})]}),s.jsxs("div",{className:"text-center p-3 bg-gray-50 rounded-lg",children:[s.jsx(Ts,{className:"w-5 h-5 mx-auto text-orange-600 mb-1"}),s.jsx("p",{className:"text-xs text-gray-600",children:"Status"}),s.jsx("p",{className:"font-bold text-gray-900",children:"Stable"})]})]})]})]})]})]})}),S=()=>s.jsx("div",{className:"space-y-6",children:s.jsxs(F,{className:"p-6 bg-white/80 backdrop-blur-sm border-0 shadow-lg",children:[s.jsx("h3",{className:"text-lg font-bold text-gray-900 mb-4",children:"Legal Information"}),s.jsxs("div",{className:"flex gap-2",children:[s.jsx(A,{variant:"outline",className:"flex-1 hover:bg-blue-50 hover:border-blue-300 transition-all duration-200 shadow-sm",onClick:()=>{c({title:"Privacy Policy",description:"We respect your privacy and protect your personal data. Your nutrition information is stored securely and never shared without your consent.",icon:Me}),o(!0)},children:"Privacy Policy"}),s.jsx(A,{variant:"outline",className:"flex-1 hover:bg-blue-50 hover:border-blue-300 transition-all duration-200 shadow-sm",onClick:()=>{c({title:"Terms of Service",description:"By using Bytewise, you agree to our terms of service. We're committed to providing you with the best nutrition tracking experience.",icon:as}),o(!0)},children:"Terms of Service"})]})]})}),L=()=>{switch(e){case"profile":return s.jsx("div",{className:"space-y-6",children:s.jsx(ti,{user:y})});case"achievements":return v();case"privacy":return C();case"notifications":return N();case"display":return _();case"data":return s.jsx("div",{className:"space-y-6",children:s.jsx(Ju,{})});case"about":return s.jsxs(s.Fragment,{children:[k(),S()]});default:return s.jsx("div",{className:"space-y-6",children:s.jsx(ti,{user:y})})}};return b.useEffect(()=>{const P=()=>{u(!0)};return window.addEventListener("show-notifications",P),()=>{window.removeEventListener("show-notifications",P)}},[]),x?s.jsx("div",{className:"flex items-center justify-center min-h-screen",children:s.jsxs("div",{className:"text-center",children:[s.jsx(Be,{className:"w-8 h-8 animate-spin mx-auto text-blue-600 mb-2"}),s.jsx("p",{className:"text-gray-600",children:"Loading profile..."})]})}):s.jsxs("div",{className:"flex flex-col min-h-screen bg-gradient-to-br from-purple-50 to-indigo-100",children:[s.jsx(Yr,{isOpen:d,onClose:()=>u(!1),notifications:[],onMarkAsRead:()=>{},onMarkAllAsRead:()=>{},onDeleteNotification:()=>{}}),s.jsx(Bs,{title:`Welcome, ${(y==null?void 0:y.firstName)||"User"}!`,subtitle:"Manage your profile and app preferences",component:"profile",caloriesConsumed:p.caloriesTracked,caloriesGoal:p.totalMealsLogged,currentStreak:p.currentStreak}),s.jsx("div",{className:"max-w-md mx-auto w-full px-3 py-4",children:s.jsx("div",{className:"bg-white/80 backdrop-blur-sm rounded-lg p-2 shadow-lg",children:s.jsx("div",{className:"grid grid-cols-3 md:grid-cols-7 gap-1",children:w.map(P=>{const q=P.icon;return s.jsxs(A,{variant:e===P.id?"default":"ghost",size:"sm",onClick:()=>t(P.id),className:`flex flex-col h-auto py-2 px-1 ${e===P.id?"bg-blue-600 text-white":"text-gray-600 hover:text-gray-900"}`,children:[s.jsx(q,{className:"w-4 h-4 mb-1"}),s.jsx("span",{className:"text-xs font-medium",children:P.label})]},P.id)})})})}),s.jsx("div",{className:"flex-1 max-w-md mx-auto w-full px-3 pb-20",children:L()}),s.jsx(Qu,{isOpen:n,onClose:()=>o(!1),achievement:l})]})}function sh({onNavigate:r}){const[e,t]=b.useState("loading"),[a,i]=b.useState("");b.useEffect(()=>{(async()=>{try{const u=new URLSearchParams(window.location.search),h=u.get("token"),g=u.get("type");if(!h||g!=="signup"){t("error"),i("Invalid confirmation link. Please check your email and try again.");return}const{data:f,error:x}=await V.auth.verifyOtp({token_hash:h,type:"signup"});if(x){x.message.includes("expired")?(t("expired"),i("Your confirmation link has expired. Please sign up again to receive a new confirmation email.")):(t("error"),i(x.message||"Email confirmation failed. Please try again."));return}f.user&&(t("success"),i("Your email has been confirmed successfully! You can now sign in to your Bytewise account."),setTimeout(()=>{r("login")},3e3))}catch(u){console.error("Email confirmation error:",u),t("error"),i("An unexpected error occurred. Please try again.")}})()},[r]);const n=async()=>{try{const d=localStorage.getItem("pending_confirmation_email");if(!d){i("No email found. Please sign up again.");return}const{error:u}=await V.auth.resend({type:"signup",email:d,options:{emailRedirectTo:`${window.location.origin}/auth/callback`}});i(u?u.message:"New confirmation email sent! Please check your inbox.")}catch{i("Failed to resend confirmation email. Please try again.")}},o=()=>{switch(e){case"success":return s.jsx(je,{className:"w-16 h-16 text-green-500"});case"error":case"expired":return s.jsx(xn,{className:"w-16 h-16 text-red-500"});case"loading":default:return s.jsx(Es,{className:"w-16 h-16 text-blue-500"})}},l=()=>{switch(e){case"success":return"text-green-600";case"error":case"expired":return"text-red-600";case"loading":default:return"text-blue-600"}},c=()=>{switch(e){case"success":return"Email Confirmed!";case"error":return"Confirmation Failed";case"expired":return"Link Expired";case"loading":default:return"Confirming Email..."}};return s.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100 flex items-center justify-center p-4",children:s.jsxs(F,{className:"w-full max-w-md p-8 text-center",children:[s.jsx("div",{className:"mb-6",children:s.jsx(zs,{size:"lg",className:"mb-4"})}),s.jsx("div",{className:"mb-6",children:o()}),s.jsx("h1",{className:`text-2xl font-bold mb-4 ${l()}`,children:c()}),s.jsx("p",{className:"text-gray-600 mb-6",children:a}),e==="loading"&&s.jsx("div",{className:"flex justify-center",children:s.jsx("div",{className:"w-6 h-6 border-2 border-blue-600 border-t-transparent rounded-full animate-spin"})}),e==="success"&&s.jsxs("div",{className:"space-y-3",children:[s.jsx("p",{className:"text-sm text-gray-500",children:"Redirecting to login in 3 seconds..."}),s.jsx(A,{onClick:()=>r("login"),className:"w-full",children:"Sign In Now"})]}),(e==="error"||e==="expired")&&s.jsxs("div",{className:"space-y-3",children:[e==="expired"&&s.jsxs(A,{onClick:n,variant:"outline",className:"w-full",children:[s.jsx(Es,{className:"w-4 h-4 mr-2"}),"Resend Confirmation Email"]}),s.jsxs(A,{onClick:()=>r("login"),variant:"outline",className:"w-full",children:[s.jsx(xd,{className:"w-4 h-4 mr-2"}),"Back to Sign In"]})]})]})})}function rh(){console.log(" Testing Calorie Calculator Integration with Redesigned Logger");const r=[{name:"Grilled Chicken Breast with Rice",calories:450,protein:35,carbs:40,fat:8,fiber:2,sugar:1,sodium:320,time:"08:30",mealType:"breakfast"},{name:"Caesar Salad with Croutons",calories:320,protein:12,carbs:25,fat:22,fiber:4,sugar:6,sodium:580,time:"12:45",mealType:"lunch"},{name:"Salmon with Vegetables",calories:520,protein:42,carbs:18,fat:28,fiber:6,sugar:10,sodium:420,time:"19:15",mealType:"dinner"},{name:"Greek Yogurt with Berries",calories:180,protein:15,carbs:20,fat:5,fiber:3,sugar:18,sodium:85,time:"15:30",mealType:"snack"}],e=t=>{const a=JSON.parse(localStorage.getItem("weeklyMeals")||"[]"),i={id:`test-${Date.now()}-${Math.random()}`,name:t.name,calories:t.calories,protein:t.protein,carbs:t.carbs,fat:t.fat,fiber:t.fiber,sugar:t.sugar,sodium:t.sodium,date:new Date().toISOString().split("T")[0],time:t.time,category:t.mealType,timestamp:new Date().toISOString(),source:"calculator",mealType:t.mealType};return a.push(i),localStorage.setItem("weeklyMeals",JSON.stringify(a)),console.log(` Logged ${t.mealType}:`,{name:t.name,calories:t.calories,time:t.time}),window.dispatchEvent(new CustomEvent("calories-logged",{detail:i})),i};return console.log(" Adding test meals to validate logger integration..."),r.forEach((t,a)=>{setTimeout(()=>{e(t),a===r.length-1&&setTimeout(()=>{window.dispatchEvent(new CustomEvent("refresh-weekly-data")),console.log(" Integration test complete! Check the logger components.");const i=r.reduce((l,c)=>l+c.calories,0),n=r.reduce((l,c)=>l+c.protein,0),o=r.length;console.log(" Test Results:",{totalCalories:i,totalProtein:Math.round(n),totalMeals:o,mealTypes:{breakfast:r.filter(l=>l.mealType==="breakfast").length,lunch:r.filter(l=>l.mealType==="lunch").length,dinner:r.filter(l=>l.mealType==="dinner").length,snack:r.filter(l=>l.mealType==="snack").length}})},500)},a*200)}),{testMeals:r,expectedTotals:{calories:r.reduce((t,a)=>t+a.calories,0),protein:r.reduce((t,a)=>t+a.protein,0),carbs:r.reduce((t,a)=>t+a.carbs,0),fat:r.reduce((t,a)=>t+a.fat,0),meals:r.length}}}function ah(){localStorage.removeItem("weeklyMeals"),localStorage.removeItem("calculatedCalories"),window.dispatchEvent(new CustomEvent("refresh-weekly-data")),console.log(" Test data cleared")}function ih(){const r=JSON.parse(localStorage.getItem("weeklyMeals")||"[]"),e=JSON.parse(localStorage.getItem("calculatedCalories")||"[]");return console.log(" Current Data:",{weeklyMeals:r.length,calculatedCalories:e.length,todaysMeals:r.filter(t=>t.date===new Date().toISOString().split("T")[0]).length}),{weeklyMeals:r,calculatedCalories:e}}typeof window<"u"&&(window.testCalorieIntegration=rh,window.clearTestData=ah,window.checkCurrentData=ih);function nh(){const[r,e]=b.useState("dashboard"),[t,a]=b.useState(!1),[i,n]=b.useState(0);wu();const o=h=>{e(h)},l=(h,g)=>{e(h),g&&h==="profile"&&setTimeout(()=>{window.dispatchEvent(new CustomEvent("navigate-to-profile-section",{detail:{section:g}}))},100)},c=()=>{window.location.href="/api/logout"};b.useEffect(()=>{const h=()=>{a(!0)},g=y=>{n(y.detail.count)},f=y=>{console.log("Toast:",y.detail.message)},x=y=>{console.log("Calories logged from calculator:",y.detail),r==="logger"&&window.dispatchEvent(new CustomEvent("refresh-weekly-data"))};return window.addEventListener("show-notifications",h),window.addEventListener("update-notification-count",g),window.addEventListener("show-toast",f),window.addEventListener("calories-logged",x),()=>{window.removeEventListener("show-notifications",h),window.removeEventListener("update-notification-count",g),window.removeEventListener("show-toast",f),window.removeEventListener("calories-logged",x)}},[]);const d=()=>new URLSearchParams(window.location.search).get("type")==="signup"||window.location.pathname.includes("confirm")?s.jsx(sh,{onNavigate:l}):null,u=()=>{const h=d();if(h)return h;switch(r){case"dashboard":return s.jsx(Ya,{onNavigate:l});case"calculator":return s.jsx(Tu,{onNavigate:l});case"logger":return s.jsx(qu,{onNavigate:l});case"profile":return s.jsx(th,{onNavigate:l});default:return s.jsx(Ya,{onNavigate:l})}};return s.jsx(Oo,{client:Vo,children:s.jsx(Id,{onNavigate:l,children:s.jsxs("div",{className:"min-h-screen bg-background",children:[s.jsx(Yr,{isOpen:t,onClose:()=>a(!1),notifications:[],onMarkAsRead:()=>{},onMarkAllAsRead:()=>{},onDeleteNotification:()=>{}}),s.jsx(Md,{currentPage:r,onNavigate:l,showNotifications:!0,notificationCount:i,onLogout:c}),s.jsx("main",{className:"pt-16 pb-20",children:u()}),s.jsx(Ld,{activeTab:r,onTabChange:o}),s.jsx(Dd,{}),s.jsx(Ud,{})]})})})}_i(document.getElementById("root")).render(s.jsx(nh,{}));
